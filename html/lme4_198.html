<div class="container">

<table style="width: 100%;"><tr>
<td>merMod-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "merMod" of Fitted Mixed-Effect Models</h2>

<h3>Description</h3>

<p>A mixed-effects model is represented as a
<code>merPredD</code> object and a response
module of a class that inherits from class
<code>lmResp</code>.  A model with a
<code>lmerResp</code> response has class <code>lmerMod</code>; a
<code>glmResp</code> response has class <code>glmerMod</code>; and a
<code>nlsResp</code> response has class <code>nlmerMod</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'merMod'
anova(object, ..., refit = TRUE, model.names=NULL)
## S3 method for class 'merMod'
as.function(x, ...)
## S3 method for class 'merMod'
coef(object, ...)
## S3 method for class 'merMod'
deviance(object, REML = NULL, ...)
REMLcrit(object)
## S3 method for class 'merMod'
extractAIC(fit, scale = 0, k = 2, ...)
## S3 method for class 'merMod'
family(object, ...)
## S3 method for class 'merMod'
formula(x, fixed.only = FALSE, random.only = FALSE, ...)
## S3 method for class 'merMod'
fitted(object, ...)
## S3 method for class 'merMod'
logLik(object, REML = NULL, ...)
## S3 method for class 'merMod'
nobs(object, ...)
## S3 method for class 'merMod'
ngrps(object, ...)
## S3 method for class 'merMod'
terms(x, fixed.only = TRUE, random.only = FALSE, ...)
## S3 method for class 'merMod'
vcov(object, correlation = TRUE, sigm = sigma(object),
     use.hessian = NULL, ...)
## S3 method for class 'merMod'
model.frame(formula, fixed.only = FALSE, ...)
## S3 method for class 'merMod'
model.matrix(object, type = c("fixed", "random", "randomListRaw"), ...)
## S3 method for class 'merMod'
print(x, digits = max(3, getOption("digits") - 3),
      correlation = NULL, symbolic.cor = FALSE,
      signif.stars = getOption("show.signif.stars"), 
      ranef.comp = "Std.Dev.",
      ranef.corr = any(ranef.comp == "Std.Dev."), ...)

## S3 method for class 'merMod'
summary(object, correlation = , use.hessian = NULL, ...)
## S3 method for class 'summary.merMod'
print(x, digits = max(3, getOption("digits") - 3),
      correlation = NULL, symbolic.cor = FALSE,
      signif.stars = getOption("show.signif.stars"),
      ranef.comp = c("Variance", "Std.Dev."),
      ranef.corr = any(ranef.comp == "Std.Dev."), show.resids = TRUE, ...)
## S3 method for class 'merMod'
update(object, formula., ..., evaluate = TRUE)
## S3 method for class 'merMod'
weights(object, type = c("prior", "working"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class <code>merMod</code>, i.e.,
as resulting from <code>lmer()</code>, or <code>glmer()</code>,
etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class <code>merMod</code> or <code>summary.merMod</code>,
respectively, the latter resulting from <code>summary(&lt;merMod&gt;)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class <code>merMod</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>in the case of <code>model.frame</code>, a
<code>merMod</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refit</code></td>
<td>
<p>logical indicating if objects of class <code>lmerMod</code> should be
refitted with ML before comparing models. The default is
<code>TRUE</code> to prevent the common mistake of inappropriately
comparing REML-fitted models with different fixed effects,
whose likelihoods are not directly comparable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.names</code></td>
<td>
<p>character vectors of model names to be used in the
anova table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Not currently used (see <code>extractAIC</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>see <code>extractAIC</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>Logical. If <code>TRUE</code>, return the restricted log-likelihood
rather than the log-likelihood.  If <code>NULL</code> (the default),
set <code>REML</code> to <code>isREML(object)</code> (see <code>isREML</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.only</code></td>
<td>
<p>logical indicating if only the fixed effects
components (terms or formula elements) are sought.  If false, all
components, including random ones, are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.only</code></td>
<td>
<p>complement of <code>fixed.only</code>; indicates
whether random components only are sought. (Trying to specify
<code>fixed.only</code> and <code>random.only</code> at the same time
will produce an error.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>(logical)
for <code>vcov</code>, indicates whether the correlation matrix as well as
the variance-covariance matrix is desired;
for <code>summary.merMod</code>, indicates whether the correlation matrix
should be computed and stored along with the covariance;
for <code>print.summary.merMod</code>, indicates whether the correlation
matrix of the fixed-effects parameters should be printed.  In the
latter case, when <code>NULL</code> (the default), the correlation matrix
is printed when it has been computed by <code>summary(.)</code>, and when
<code class="reqn">p &lt;= 12</code>, and the cutoff <code>12</code> may be modified by
<code>options(lme4.summary.cor.max = &lt;n&gt;)</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.hessian</code></td>
<td>
<p>(logical) indicates whether to use the
finite-difference Hessian of the deviance function to compute
standard errors of the fixed effects, rather estimating
based on internal information about the inverse of
the model matrix (see <code>getME(.,"RX")</code>).
The default is to use the Hessian whenever the
fixed effect parameters are arguments to the deviance
function (i.e. for GLMMs with <code>nAGQ&gt;0</code>), and to use
<code>getME(.,"RX")</code> whenever the fixed effect parameters are
profiled out (i.e. for GLMMs with <code>nAGQ==0</code> or LMMs).
</p>
<p><code>use.hessian=FALSE</code> is backward-compatible with older versions
of <code>lme4</code>, but may give less accurate SE estimates when the
estimates of the fixed-effect (see <code>getME(.,"beta")</code>)
and random-effect (see <code>getME(.,"theta")</code>) parameters
are correlated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigm</code></td>
<td>
<p>the residual standard error; by default <code>sigma(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of significant digits for printing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbolic.cor</code></td>
<td>
<p>should a symbolic encoding of the fixed-effects correlation
matrix be printed?  If so, the <code>symnum</code> function is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif.stars</code></td>
<td>
<p>(logical) should significance stars be used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranef.comp</code></td>
<td>
<p>character vector of length one or two, indicating
if random-effects parameters should be reported on the variance and/or
standard deviation scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.resids</code></td>
<td>
<p>should the quantiles of the scaled residuals be printed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.</code></td>
<td>
<p>see <code>update.formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evaluate</code></td>
<td>
<p>see <code>update</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>For </p>

<dl>
<dt>
<code>weights()</code>, </dt>
<dd>
<p>type of weights to be returned; either <code>"prior"</code> for
the initially supplied weights or <code>"working"</code> for the weights
at the final iteration of the penalized iteratively reweighted least
squares algorithm (PIRLS).</p>
</dd>
<dt>
<code>model.matrix()</code>, </dt>
<dd>
<p>type of model matrix to
return: one of <code>"fixed"</code> giving the fixed effects model matrix,
<code>"random"</code> giving the random effects model matrix, or
<code>"randomListRaw"</code> giving a list of the raw random effects model
matrices associated with each random effects term.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranef.corr</code></td>
<td>
<p>(logical) print correlations (rather than covariances) of
random effects?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potentially further arguments passed from other methods.</p>
</td>
</tr>
</table>
<h3>Objects from the Class</h3>

<p>Objects of class <code>merMod</code> are created by calls to
<code>lmer</code>, <code>glmer</code> or <code>nlmer</code>.
</p>


<h3>S3 methods</h3>

<p>The following S3 methods with arguments given above exist (this list is currently not complete):
</p>


<dl>
<dt>
<code>anova</code>:</dt>
<dd>
<p>returns the sequential decomposition of the contributions of
fixed-effects terms or, for multiple arguments, model comparison statistics.
For objects of class <code>lmerMod</code> the default behavior is to refit the models
with ML if fitted with <code>REML = TRUE</code>, this can be controlled via the
<code>refit</code> argument. See also <code>anova</code>.</p>
</dd>
<dt>
<code>as.function</code>:</dt>
<dd>
<p>returns the deviance function, the same as
<code>lmer(*, devFunOnly=TRUE)</code>, and <code>mkLmerDevfun()</code>
or <code>mkGlmerDevfun()</code>, respectively.</p>
</dd>
<dt>
<code>coef</code>:</dt>
<dd>
<p>Computes the sum of the random and fixed effects
coefficients for each explanatory variable for each level of each
grouping factor.</p>
</dd>
<dt>
<code>extractAIC</code>:</dt>
<dd>
<p>Computes the (generalized) Akaike An
Information Criterion. If <code>isREML(fit)</code>, then <code>fit</code> is
refitted using maximum likelihood.</p>
</dd>
<dt>
<code>family</code>:</dt>
<dd>
<p><code>family</code> of fitted
GLMM. (<em>Warning:</em> this accessor may not work properly with
customized families/link functions.)</p>
</dd>
<dt>
<code>fitted</code>:</dt>
<dd>
<p>Fitted values, given the conditional modes of
the random effects.  For more flexible access to fitted values, use
<code>predict.merMod</code>.</p>
</dd>
<dt>
<code>logLik</code>:</dt>
<dd>
<p>Log-likelihood at the fitted value of the
parameters.  Note that for GLMMs, the returned value is only
proportional to the log probability density (or distribution) of the
response variable.  See <code>logLik</code>. </p>
</dd>
<dt>
<code>model.frame</code>:</dt>
<dd>
<p>returns the <code>frame</code> slot of <code>merMod</code>.</p>
</dd>
<dt>
<code>model.matrix</code>:</dt>
<dd>
<p>returns the fixed effects model matrix.</p>
</dd>
<dt>
<code>nobs</code>, <code>ngrps</code>:</dt>
<dd>
<p>Number of observations and vector of
the numbers of levels in each grouping factor.  See <code>ngrps</code>.</p>
</dd>
<dt>
<code>summary</code>:</dt>
<dd>
<p>Computes and returns a list of summary statistics of the
fitted model, the amount of output can be controlled via the <code>print</code> method,
see also <code>summary</code>.</p>
</dd>
<dt>
<code>print.summary</code>:</dt>
<dd>
<p>Controls the output for the summary
method.</p>
</dd>
<dt>
<code>vcov</code>:</dt>
<dd>
<p>Calculate variance-covariance matrix of the <em>fixed</em>
effect terms, see also <code>vcov</code>.</p>
</dd>
<dt>
<code>update</code>:</dt>
<dd>
<p>See <code>update</code>.</p>
</dd>
</dl>
<h3>Deviance and log-likelihood of GLMMs</h3>

<p>One must be careful when defining the deviance of a GLM.  For example,
should the deviance be defined as minus twice the log-likelihood or
does it involve subtracting the deviance for a saturated model?  To
distinguish these two possibilities we refer to absolute deviance
(minus twice the log-likelihood) and relative deviance (relative to a
saturated model, e.g. Section 2.3.1 in McCullagh and Nelder 1989).
</p>
<p>With GLMMs however, there is an additional complication involving the
distinction between the likelihood and the conditional likelihood.
The latter is the likelihood obtained by conditioning on the estimates
of the conditional modes of the spherical random effects coefficients,
whereas the likelihood itself (i.e. the unconditional likelihood)
involves integrating out these coefficients.  The following table
summarizes how to extract the various types of deviance for a
<code>glmerMod</code> object:
</p>

<table>
<tr>
<td style="text-align: left;">
             </td>
<td style="text-align: right;"> conditional              </td>
<td style="text-align: right;"> unconditional </td>
</tr>
<tr>
<td style="text-align: left;">
    relative </td>
<td style="text-align: right;"> <code>deviance(object)</code>  </td>
<td style="text-align: right;"> NA in <code>lme4</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    absolute </td>
<td style="text-align: right;"> <code>object@resp$aic()</code> </td>
<td style="text-align: right;"> <code>-2*logLik(object)</code>
  </td>
</tr>
</table>
<p>This table requires two caveats:
</p>

<ul>
<li>
<p> If the link function involves a scale parameter
(e.g. <code>Gamma</code>) then <code>object@resp$aic() - 2 * getME(object,
    "devcomp")$dims["useSc"]</code> is required for the absolute-conditional
case.
</p>
</li>
<li>
<p> If adaptive Gauss-Hermite quadrature is used, then
<code>logLik(object)</code> is currently only proportional to the
absolute-unconditional log-likelihood.
</p>
</li>
</ul>
<p>For more information about this topic see the <code>misc/logLikGLMM</code>
directory in the package source.
</p>
































<h3>Slots</h3>


<dl>
<dt>
<code>resp</code>:</dt>
<dd>
<p>A reference class object for an <span class="pkg">lme4</span>
response module (<code>lmResp-class</code>).</p>
</dd>
<dt>
<code>Gp</code>:</dt>
<dd>
<p>See <code>getME</code>.</p>
</dd>
<dt>
<code>call</code>:</dt>
<dd>
<p>The matched call.</p>
</dd>
<dt>
<code>frame</code>:</dt>
<dd>
<p>The model frame containing all of the variables
required to parse the model formula.</p>
</dd>
<dt>
<code>flist</code>:</dt>
<dd>
<p>See <code>getME</code>.</p>
</dd>
<dt>
<code>cnms</code>:</dt>
<dd>
<p>See <code>getME</code>.</p>
</dd>
<dt>
<code>lower</code>:</dt>
<dd>
<p>See <code>getME</code>.</p>
</dd>
<dt>
<code>theta</code>:</dt>
<dd>
<p>Covariance parameter vector.</p>
</dd>
<dt>
<code>beta</code>:</dt>
<dd>
<p>Fixed effects coefficients.</p>
</dd>
<dt>
<code>u</code>:</dt>
<dd>
<p>Conditional model of spherical random effects
coefficients.</p>
</dd>
<dt>
<code>devcomp</code>:</dt>
<dd>
<p>See <code>getME</code>.</p>
</dd>
<dt>
<code>pp</code>:</dt>
<dd>
<p>A reference class object for an <span class="pkg">lme4</span>
predictor module (<code>merPredD-class</code>).</p>
</dd>
<dt>
<code>optinfo</code>:</dt>
<dd>
<p>List containing information about the
nonlinear optimization.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>lmer</code>, <code>glmer</code>,
<code>nlmer</code>, <code>merPredD</code>,
<code>lmerResp</code>,
<code>glmResp</code>,
<code>nlsResp</code>
</p>
<p>Other methods for <code>merMod</code> objects documented elsewhere include:
<code>fortify.merMod</code>, <code>drop1.merMod</code>,
<code>isLMM.merMod</code>, <code>isGLMM.merMod</code>,
<code>isNLMM.merMod</code>, <code>isREML.merMod</code>,
<code>plot.merMod</code>, <code>predict.merMod</code>,
<code>profile.merMod</code>, <code>ranef.merMod</code>,
<code>refit.merMod</code>, <code>refitML.merMod</code>,
<code>residuals.merMod</code>, <code>sigma.merMod</code>,
<code>simulate.merMod</code>, <code>summary.merMod</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">showClass("merMod")
methods(class="merMod")## over 30  (S3) methods available

m1 &lt;- lmer(Reaction ~ Days + (Days | Subject), sleepstudy)
print(m1, ranef.corr = TRUE)   ## print correlations of REs
print(m1, ranef.corr = FALSE)  ## print covariances of REs

## -&gt; example(lmer)  for an example of vcov.merMod()
</code></pre>


</div>