<div class="container">

<table style="width: 100%;"><tr>
<td>meanExcessPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean excess plot</h2>

<h3>Description</h3>

<p>The Mean Excess plot is a graphical method for detecting the threshold (scale
parameter) of a Pareto distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">meanExcessPlot(
  x,
  w = NULL,
  probs = NULL,
  interactive = TRUE,
  pch = par("pch"),
  cex = par("cex"),
  col = par("col"),
  bg = "transparent",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>an optional numeric vector giving sample weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>an optional numeric vector of probabilities with values in
<code class="reqn">[0,1]</code>, defining the quantiles to be plotted.  This is useful for large
data sets, when it may not be desirable to plot every single point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactive</code></td>
<td>
<p>a logical indicating whether the threshold (scale
parameter) can be selected interactively by clicking on points.  Information
on the selected threshold is then printed on the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch, cex, col, bg</code></td>
<td>
<p>graphical parameters for the plot symbol of each data
point or quantile (see <code>points</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to
<code>plot.default</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The corresponding mean excesses are plotted against the values of <code>x</code>
(if supplied, only those specified by <code>probs</code>).  If the tail of the data
follows a Pareto distribution, these observations show a positive linear
trend. The leftmost point of a fitted line can thus be used as an estimate of
the threshold (scale parameter).
</p>
<p>The interactive selection of the threshold (scale parameter) is implemented
using <code>identify</code>.  For the usual <code>X11</code> device, the
selection process is thus terminated by pressing any mouse button other than
the first.  For the <code>quartz</code> device (on Mac OS X systems), the process
is terminated either by a secondary click (usually second mouse button or
<code>Ctrl</code>-click) or by pressing the <code>ESC</code> key.
</p>


<h3>Value</h3>

<p>If <code>interactive</code> is <code>TRUE</code>, the last selection for the
threshold is returned invisibly as an object of class <code>"paretoScale"</code>,
which consists of the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>the selected threshold (scale parameter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of observations in the tail (i.e., larger than the
threshold).</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The functionality to account for sample weights and to select the
threshold (scale parameter) interactively was introduced in version 0.2.
</p>


<h3>Author(s)</h3>

<p>Andreas Alfons and Josef Holzer
</p>


<h3>See Also</h3>

<p><code>paretoScale</code>, <code>paretoTail</code>,
<code>minAMSE</code>, <code>paretoQPlot</code>,
<code>identify</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(eusilc)
# equivalized disposable income is equal for each household
# member, therefore only one household member is taken
eusilc &lt;- eusilc[!duplicated(eusilc$db030),]

# with sample weights
meanExcessPlot(eusilc$eqIncome, w = eusilc$db090)

# without sample weights
meanExcessPlot(eusilc$eqIncome)

</code></pre>


</div>