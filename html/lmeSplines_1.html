<div class="container">

<table style="width: 100%;"><tr>
<td>approx.Z</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interpolating in smoothing spline Z-matrix columns</h2>

<h3>Description</h3>

<p>Function to interpolate the <code class="reqn">Z</code>-matrix for LME smoothing spline fits
from one set of values of the <code>time</code> covariate to another.
</p>


<h3>Usage</h3>

<pre><code class="language-R">approx.Z(Z, oldtimes, newtimes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p><code class="reqn">Z</code>-matrix with rows corresponding to the sorted unique
values of the <code>time</code> covariate </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldtimes</code></td>
<td>
<p>original (sorted) values for <code>time</code> covariate,
corresponding to the rows of <code class="reqn">Z</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newtimes</code></td>
<td>
<p>new (sorted) values for <code>time</code> covariate</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses linear interpolation of each column of the <code class="reqn">Z</code>-matrix, regarded as
a function of time, with the times given by <code>oldtimes</code>.
</p>


<h3>Value</h3>

<p>A matrix corresponding to an interpolated spline matrix. Can be used
with <code>smspline()</code> for fitting LME splines with random effects
corresponding to a different set of values of the <code>time</code> covariate 
than those represented in the data, or as part of the   ‘newdata’ argument 
prediction from an existing model, to obtain predictions at points
not represented in the data using <code>predict.lme()</code>.
</p>


<h3>Note</h3>

<p>Linear interpolation works well here because the spline basis
functions are approximately piecewise linear.</p>


<h3>Author(s)</h3>

<p>Rod Ball <a href="mailto:rod.ball@scionresearch.com">rod.ball@scionresearch.com</a> 
<a href="https://www.scionresearch.com/">https://www.scionresearch.com/</a></p>


<h3>See Also</h3>

<p><code>smspline</code> <code>nlme</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">times1 &lt;- 1:10
Zt1 &lt;- smspline(~ times1)
times2 &lt;- seq(1,10,by=0.1)
Zt2 &lt;- approx.Z(Zt1,oldtimes=times1,newtimes=times2)
</code></pre>


</div>