<div class="container">

<table style="width: 100%;"><tr>
<td>plotlmrdia</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot L-moment Ratio Diagram (Tau3 and Tau4)</h2>

<h3>Description</h3>

<p>Plot the Tau3-Tau4 L-moment ratio diagram of L-skew and L-kurtosis from a Tau3-Tau4 L-moment ratio diagram object returned by <code>lmrdia</code>. This diagram is useful for selecting a distribution to model the data. The application of L-moment diagrams is well documented in the literature. This function is intended to function as a demonstration of L-moment ratio diagram plotting with enough user settings for many practical applications.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotlmrdia(lmr=NULL, nopoints=FALSE, nolines=FALSE, nolimits=FALSE,
           noaep4=FALSE, nogev=FALSE, noglo=FALSE,  nogno=FALSE, nogov=FALSE,
           nogpa=FALSE,  nope3=FALSE, nopdq3=FALSE, nowei=TRUE,
           nocau=TRUE,   noexp=FALSE, nonor=FALSE,  nogum=FALSE,
           noray=FALSE, nosla=TRUE, nouni=FALSE,
           xlab="L-skew (Tau3), dimensionless",
           ylab="L-kurtosis (Tau4), dimensionless", add=FALSE, empty=FALSE,
           autolegend=FALSE, xleg=NULL, yleg=NULL, legendcex=0.9,
           ncol=1, text.width=NULL, lwd.cex=1, expand.names=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lmr</code></td>
<td>
<p>L-moment diagram object from <code>lmrdia</code>, if <code>NULL</code>, then <code>empty</code> is internally set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nopoints</code></td>
<td>
<p>If <code>TRUE</code> then point distributions are not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nolines</code></td>
<td>
<p>If <code>TRUE</code> then line distributions are not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nolimits</code></td>
<td>
<p>If <code>TRUE</code> then theoretical limits of L-moments are not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noaep4</code></td>
<td>
<p>If <code>TRUE</code> then the lower bounds line of Asymmetric Exponential Power distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nogev</code></td>
<td>
<p>If <code>TRUE</code> then line of Generalized Extreme Value distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noglo</code></td>
<td>
<p>If <code>TRUE</code> then line of Generalized Logistic distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nogno</code></td>
<td>
<p>If <code>TRUE</code> then line of Generalized Normal (Log-Normal3) distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nogov</code></td>
<td>
<p>If <code>TRUE</code> then line of Govindarajulu distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nogpa</code></td>
<td>
<p>If <code>TRUE</code> then line of Generalized Pareto distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nope3</code></td>
<td>
<p>If <code>TRUE</code> then line of Pearson Type III distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nopdq3</code></td>
<td>
<p>If <code>TRUE</code> then line of Polynomial Density-Quantile3 distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nowei</code></td>
<td>
<p>If <code>TRUE</code> then line of the Weibull distribution is not drawn. The Weibull is a reverse of the Generalized Extreme Value. Traditionally in the literature, the Tau3-Tau4 L-moment ratio diagram have usually included the Weibull distribution and therefore the default setting of this argument is to not plot the Weibull.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nocau</code></td>
<td>
<p>If <code>TRUE</code> then point (TL-moment [trim=1]) of the Cauchy distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noexp</code></td>
<td>
<p>If <code>TRUE</code> then point of Exponential distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonor</code></td>
<td>
<p>If <code>TRUE</code> then point of Normal distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nogum</code></td>
<td>
<p>If <code>TRUE</code> then point of Gumbel distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noray</code></td>
<td>
<p>If <code>TRUE</code> then point of Rayleigh distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nouni</code></td>
<td>
<p>If <code>TRUE</code> then point of Uniform distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nosla</code></td>
<td>
<p>If <code>TRUE</code> then point (TL-moment [trim=1]) of the Slash distribution is not drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Horizonal axis label passed to <code>xlab</code> of the <code>plot</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Vertical axis label passed to <code>ylab</code> of the <code>plot</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>A logical to toggle a call to <code>plot</code> to start a new plot, otherwise, just the trajectories are otherwise plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empty</code></td>
<td>
<p>A logical to return before any trajectories are plotted but after the condition of the <code>add</code> has been evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autolegend</code></td>
<td>
<p>Generate the legend by built-in algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xleg</code></td>
<td>
<p>X-coordinate of the legend. This argument is checked for being a character versus a numeric. If it is a character, then <code>yleg</code> is not needed and <code>xleg</code> and take on “location may also be specified by setting x to a single keyword” as per the functionality of <code>graphics::legend()</code> itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yleg</code></td>
<td>
<p>Y-coordinate of the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendcex</code></td>
<td>
<p>The <code>cex</code> to pass to <code>graphics::legend()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>The number of columns in which to set the legend items (default is 1, which differs from <code>legend()</code> default of 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.width</code></td>
<td>
<p>Argument of the same name for <code>legend</code>. Setting to 0.1 for <code>ncol</code> set to 2 seems to work pretty well when two columns are desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.cex</code></td>
<td>
<p>Expansion factor on the line widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expand.names</code></td>
<td>
<p>Expand the distribution names in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed into <code>plot()</code> and <code>legend()</code> functions..</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function provides hardwired calls to <code>lines</code> and <code>points</code> to produce the diagram. The plot symbology for the shown distributions is summarized here. The Asymmetric Exponential Power and Kappa (four parameter) and Wakeby (five parameter) distributions are not well represented on the diagram as each constitute an area (Kappa) or hyperplane (Wakeby) and not a line (3-parameter distributions) or a point (2-parameter distributions). However, the Kappa demarks the area bounded by the Generalized Logistic (<code>glo</code>) on the top and the
theoretical L-moment limits on the bottom. The Asymmetric Exponential Power demarks its own unique lower boundary and extends up in the <code class="reqn">\tau_4</code> direction to <code class="reqn">\tau_4 = 1</code>. However, parameter estimation with L-moments has lost considerable accuracy for <code class="reqn">\tau_4</code> that large (see Asquith, 2014).
</p>

<table>
<tr>
<td style="text-align: center;">
  <b>GRAPHIC TYPE</b> </td>
<td style="text-align: left;"> <b>GRAPHIC NATURE</b> </td>
</tr>
<tr>
<td style="text-align: center;">
  L-moment Limits </td>
<td style="text-align: left;"> line width 2 and color a medium-dark grey </td>
</tr>
<tr>
<td style="text-align: center;">
  Asymmetric Exponential Power (4-p) </td>
<td style="text-align: left;"> line width 1, line type 4 (dot), and color red </td>
</tr>
<tr>
<td style="text-align: center;">
  Generalized Extreme Value (GEV) </td>
<td style="text-align: left;"> line width 1, line type 1 (solid), and color darkred </td>
</tr>
<tr>
<td style="text-align: center;">
  Generalized Logistic </td>
<td style="text-align: left;"> line width 1 and color green </td>
</tr>
<tr>
<td style="text-align: center;">
  Generalized Normal </td>
<td style="text-align: left;"> line width 1, line type 2 (dash), and color blue </td>
</tr>
<tr>
<td style="text-align: center;">
  Govindarajulu </td>
<td style="text-align: left;"> line width 1, line type 2 (dash), and color 6 (magenta) </td>
</tr>
<tr>
<td style="text-align: center;">
  Generalized Pareto </td>
<td style="text-align: left;"> line width 1, line type 1 (solid), and color blue </td>
</tr>
<tr>
<td style="text-align: center;">
  Pearson Type III </td>
<td style="text-align: left;"> line width 1, line type 1 (solid), and color 6 (purple) </td>
</tr>
<tr>
<td style="text-align: center;">
  Polynomial Density-Quantile3 </td>
<td style="text-align: left;"> line width 1.3, line type 2 (dash), and color darkgreen </td>
</tr>
<tr>
<td style="text-align: center;">
  Weibull (reversed GEV) </td>
<td style="text-align: left;"> line width 1, line type 1 (solid), and color darkorange </td>
</tr>
<tr>
<td style="text-align: center;">
  Exponential </td>
<td style="text-align: left;"> symbol 16 (filled circle) and color red </td>
</tr>
<tr>
<td style="text-align: center;">
  Normal </td>
<td style="text-align: left;"> symbol 15 (filled square) and color red </td>
</tr>
<tr>
<td style="text-align: center;">
  Gumbel </td>
<td style="text-align: left;"> symbol 17 (filled triangle) and color red) </td>
</tr>
<tr>
<td style="text-align: center;">
  Rayleigh </td>
<td style="text-align: left;"> symbol 18 (filled diamond) and color red </td>
</tr>
<tr>
<td style="text-align: center;">
  Uniform </td>
<td style="text-align: left;"> symbol 12 (square and a plus sign) and color red </td>
</tr>
<tr>
<td style="text-align: center;">
  Cauchy </td>
<td style="text-align: left;"> symbol 13 (circle with over lapping <code class="reqn">\times</code>) and color turquoise4 </td>
</tr>
<tr>
<td style="text-align: center;">
  Slash  </td>
<td style="text-align: left;"> symbol 10 (cicle containing <code class="reqn">+</code>) and color turquoise4 </td>
</tr>
<tr>
<td style="text-align: center;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Asquith, W.H., 2011, Distributional analysis with L-moment statistics using the R environment for statistical computing: Createspace Independent Publishing Platform, ISBN 978–146350841–8.
</p>
<p>Asquith, W.H., 2014, Parameter estimation for the 4-parameter asymmetric exponential power distribution by the method of L-moments using R: Computational Statistics and Data Analysis, v. 71, pp. 955–970.
</p>
<p>Hosking, J.R.M., 1986, The theory of probability weighted moments: Research Report RC12210, IBM Research Division, Yorkton Heights, N.Y.
</p>
<p>Hosking, J.R.M., 1990, L-moments—Analysis and estimation of distributions using linear combinations of order statistics: Journal of the Royal Statistical Society, Series B, v. 52, pp. 105–124.
</p>
<p>Hosking, J.R.M., and Wallis, J.R., 1997, Regional frequency analysis–An approach based on L-moments: Cambridge University Press.
</p>
<p>Vogel, R.M., and Fennessey, N.M., 1993, L moment diagrams should replace product moment diagrams: Water Resources Research, v. 29, no. 6, pp. 1745–1752.
</p>


<h3>See Also</h3>

<p><code>lmrdia</code>, <code>plotlmrdia46</code>, <code>plotradarlmr</code></p>


<h3>Examples</h3>

<pre><code class="language-R">plotlmrdia(lmrdia()) # simplest of all uses

## Not run: 
# A more complex example follows: for a given mean, L-scale, L-skew, and L-kurtosis,
# use sample size of 30, use 500 simulations, set L-moments, fit the Kappa distribution
T3 &lt;- 0.34; T4 &lt;- 0.21; n &lt;- 30; nsim &lt;- 500
lmr &lt;- vec2lmom(c(10000, 7500, T3, T4)); kap &lt;- parkap(lmr)

# create vectors for storing simulated L-skew (t3) and L-kurtosis (t4)
t3 &lt;- t4 &lt;- vector(mode="numeric")

# perform nsim simulations by randomly drawing from the Kappa distribution
# and compute the L-moments in sim.lmr and store the t3 and t4 of each sample
for(i in 1:nsim) {
  sim.lmr &lt;- lmoms(rlmomco(n, kap))
  t3[i] &lt;- sim.lmr$ratios[3]; t4[i] &lt;- sim.lmr$ratios[4]
}

# plot the diagram and "zoom" by manually setting the axis limits
plotlmrdia(xlim=c(-0.1, 0.5), ylim=c(-0.1, 0.4), las=1, empty=TRUE)

# Follow up by plotting the {t3, t4} values and the mean of the values
points(t3, t4, pch=21, bg="white", lwd=0.8) # plot each simulation

# plot crossing dashed lines at true values of L-skew and L-kurtosis
abline(v=T3, col="salmon4", lty=2, lwd=3) # Theoretical values for the
abline(h=T4, col="salmon4", lty=2, lwd=3) # distribution as fit

points(mean(t3), mean(t4), pch=16, cex=3) # mean of simulations and
# should plot reasonably close to the salmon4-colored crossing lines

# plot the trajectories of the distributions
plotlmrdia(lmrdia(), add=TRUE, nopoints=TRUE, inset=0.01,
           autolegend=TRUE, xleg="topleft", lwd.cex=1.5) # 
## End(Not run)
</code></pre>


</div>