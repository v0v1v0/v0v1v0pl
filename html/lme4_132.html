<div class="container">

<table style="width: 100%;"><tr>
<td>NelderMead</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nelder-Mead Optimization of Parameters, Possibly (Box) Constrained</h2>

<h3>Description</h3>

<p>Nelder-Mead optimization of parameters, allowing
optimization subject to box constraints (contrary to the default,
<code>method = "Nelder-Mead"</code>, in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s <code>optim()</code>), and
using reverse communications.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Nelder_Mead(fn, par, lower = rep.int(-Inf, n), upper = rep.int(Inf, n),
            control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>a <code>function</code> of a single numeric vector argument
returning a numeric scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>numeric vector of starting values for the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>numeric vector of lower bounds (elements may be <code>-Inf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>numeric vector of upper bounds (elements may be <code>Inf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a named list of control settings. Possible settings are
</p>

<dl>
<dt>iprint</dt>
<dd>
<p>numeric scalar - frequency of printing evaluation information.
Defaults to 0 indicating no printing.</p>
</dd>
<dt>maxfun</dt>
<dd>
<p>numeric scalar - maximum number of function
evaluations allowed (default:10000).</p>
</dd>
<dt>FtolAbs</dt>
<dd>
<p>numeric scalar - absolute tolerance on
change in function values (default: 1e-5)</p>
</dd>
<dt>FtolRel</dt>
<dd>
<p>numeric scalar - relative tolerance on
change in function values (default:1e-15)</p>
</dd>
<dt>XtolRel</dt>
<dd>
<p>numeric scalar - relative tolerance on
change in parameter values (default: 1e-7)</p>
</dd>
<dt>MinfMax</dt>
<dd>
<p>numeric scalar - maximum value of the
minimum (default: .Machine$double.xmin)</p>
</dd>
<dt>xst</dt>
<dd>
<p>numeric vector of initial step sizes to
establish the simplex - all elements must be non-zero
(default: rep(0.02,length(par)))</p>
</dd>
<dt>xt</dt>
<dd>
<p>numeric vector of tolerances on the parameters (default: xst*5e-4)</p>
</dd>
<dt>verbose</dt>
<dd>
<p>numeric value: 0=no printing,
1=print every 20 evaluations, 2=print every 10
evalutions, 3=print every evaluation.  Sets
‘iprint’, if specified, but does not override it.</p>
</dd>
<dt>warnOnly</dt>
<dd>
<p>a logical indicating if non-convergence (codes
-1,-2,-3) should not <code>stop(.)</code>, but rather only call
<code>warning</code> and return a result which might inspected.
Defaults to <code>FALSE</code>, i.e., stop on non-convergence.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>list</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fval</code></td>
<td>
<p>numeric scalar - the minimum function value achieved</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>numeric vector - the value of <code>x</code> providing the minimum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>integer valued scalar, if not <code>0</code>, an error code:
</p>

<dl>
<dt>-4</dt>
<dd>
<p><code>nm_evals</code>: maximum evaluations reached</p>
</dd>
<dt>-3</dt>
<dd>
<p><code>nm_forced</code>: ?</p>
</dd>
<dt>-2</dt>
<dd>
<p><code>nm_nofeasible</code>: cannot generate a feasible simplex</p>
</dd>
<dt>-1</dt>
<dd>
<p><code>nm_x0notfeasible</code>: initial x is not feasible (?)</p>
</dd>
<dt>0</dt>
<dd>
<p>successful convergence</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>a string specifying the kind of convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>the <code>list</code> of control settings after
substituting for defaults.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feval</code></td>
<td>
<p>the number of function evaluations.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>The <code>NelderMead</code> class definition and generator
function.
</p>


<h3>Examples</h3>

<pre><code class="language-R">fr &lt;- function(x) {   ## Rosenbrock Banana function
    x1 &lt;- x[1]
    x2 &lt;- x[2]
    100 * (x2 - x1 * x1)^2 + (1 - x1)^2
}
p0 &lt;- c(-1.2, 1)

oo  &lt;- optim(p0, fr) ## also uses Nelder-Mead by default
o.  &lt;- Nelder_Mead(fr, p0)
o.1 &lt;- Nelder_Mead(fr, p0, control=list(verbose=1))# -&gt; some iteration output
stopifnot(identical(o.[1:4], o.1[1:4]),
          all.equal(o.$par, oo$par, tolerance=1e-3))# diff: 0.0003865


o.2 &lt;- Nelder_Mead(fr, p0, control=list(verbose=3, XtolRel=1e-15, FtolAbs= 1e-14))
all.equal(o.2[-5],o.1[-5], tolerance=1e-15)# TRUE, unexpectedly
</code></pre>


</div>