<div class="container">

<table style="width: 100%;"><tr>
<td>localgauss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>local Gaussian parameters</h2>

<h3>Description</h3>

<p>Routine for estimating local Gaussian parameters based on a sample
from the bivariate distribution under consideration. The routine can either
estimate local parameters on a grid covering the data controlled by the <code>gsize</code> and <code>hthresh</code>
parameters. Otherwise, local Gaussian parameters can be estimated at coordinates
specified by the user in <code>xy.mat</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">localgauss(x,y,b1=1,b2=1,gsize=15,hthresh=0.001,xy.mat=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,y</code></td>
<td>
<p>The two data vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b1,b2</code></td>
<td>
<p>The bandwidth in the <code>x</code>-direction and <code>y</code>-direction, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gsize</code></td>
<td>
<p>The gridsize (only used if <code>xy.mat</code> is not specified). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hthresh</code></td>
<td>
<p>Gridpoints where a non-parametric density estimate is lower than hthresh are omitted (only used if <code>xy.mat</code> is not specified). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy.mat</code></td>
<td>
<p>A M times 2 matrix of points where the local parameters are to be estimated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The objective function is maximized using a modified Newton
method. The user should check whether the field eflag in the
returned object is zero for all estimates. If not,
the optimizer has not converged and the estimates should not be trusted.
For more details, see [Reference to article].
</p>


<h3>Value</h3>

<p>S3 object of type <code>localgauss</code> containing the fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>par.est</code></td>
<td>
<p>M times 5 matrix of parameter estimates, with columns
mu1,mu2,sigma1,sigma2,rho.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eflag</code></td>
<td>
<p>M-vector of exitflags from the optimizer. Estimations
with exit flags other than 0 should not be trusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>The negative Hessian of the objective function.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Geir Drage Berentsen, Tore Selland Kleppe, Dag Tjostheim,
Introducing localgauss, an R Package for Estimating and Visualizing Local Gaussian Correlation, Journal of Statistical Software, 56(12), 1-18, 2014, doi: <a href="https://doi.org/10.18637/jss.v056.i12">10.18637/jss.v056.i12</a>
See also Tjoestheim, D. and Hufthammer K. O.,
Local Gaussian correlation: A new measure of dependence, Journal of Econometrics,
172(1),pages 33-48,2013, for a detailed description of local Gaussian correlation.</p>


<h3>See Also</h3>

<p><code>localgauss.indtest</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">    x=rnorm(n=1000)
    y=x^2 + rnorm(n=1000)
    lgobj = localgauss(x,y)

</code></pre>


</div>