<div class="container">

<table style="width: 100%;"><tr>
<td>heatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>heatmap()</h2>

<h3>Description</h3>

<p>A function to plot a heatmap based on abundance of lipids. A series
of custom functions can be realized such as dividing groups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">heatmap(
  data,
  group,
  cluster_row = TRUE,
  cluster_col = TRUE,
  sel.group = "default",
  constract = 8.5,
  type = "lipid",
  sel.type = "default",
  sel.row = c("default"),
  annotation_legend = TRUE,
  cellwidth = 20,
  cellheight = 15,
  gaps_row = c(0),
  gaps_col = c(0),
  subtype = FALSE,
  labels_row = c("default"),
  labels_col = c("default"),
  title = "",
  show_rownames = TRUE,
  show_colnames = TRUE,
  cellcolor = c("blue", "black", "yellow"),
  legend = TRUE,
  border_color = NA,
  border = FALSE,
  cutree_rows = 1,
  cutree_cols = 1,
  rtitle = "group",
  ctitle = " ",
  fontsize_row = 12,
  fontsize_col = 12,
  fontsize = 8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe storing absolute concentration or PL
to get normalized data.
The column name should be the sample name and the row name should be the lipid type.
The class of column name and row name should be "character". The class of values should be
"numeric". The row names are recommended to be in a form like "PL(14:0/20:1)" or "LPL(16:1)".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A vector defining which group the replicates belong to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_row</code></td>
<td>
<p>A boolean variable controlling whether to perfrom clustering to
row variables (lipid abundance) or not. The default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_col</code></td>
<td>
<p>A boolean variable controlling whether to perfrom clustering to
column variables (lipid abundance) or not. The default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.group</code></td>
<td>
<p>A vector containing the group you want to show in the heatmap.
The input can be like c("WT","KO"). Default value is "default".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constract</code></td>
<td>
<p>The constract of heatmap, default is 8.5, value range from 0 to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Can accept 3 values: "lipid", "CB", or "sat". Default value is "lipid".
</p>
<p>If type="lipid“, the heatmap will divide rownames based on lipid types.
</p>
<p>If pattern="CB“, the heatmap will divide rownames based on carbon number.
</p>
<p>If pattern="sat“, the heatmap will divide rownames based on the number of double bonds of a lipid type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.type</code></td>
<td>
<p>A vector controlling which types to show. If you only want to check data of "PA", "PC“, and "PE".
You can set type="lipid", sel.type=c("PA","PC","PE")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.row</code></td>
<td>
<p>A vector controlling which types to show. If you set it as c("LPC(16:0)","PC(14:0/16:1)",
"PC(18:1/18:1)","PE(18:0/20:1)"), only their abundance will be shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation_legend</code></td>
<td>
<p>A boolean controlling whether to show the figure legend. The default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellwidth</code></td>
<td>
<p>The width of a cell in the heatmap. Default value is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellheight</code></td>
<td>
<p>The height of a cell in the heatmap. Default value is 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gaps_row</code></td>
<td>
<p>To customize positions of row gaps. Default value is c(0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gaps_col</code></td>
<td>
<p>To customize positions of column gaps. Default value is c(0).
</p>
<p>Notice: gaps_row and gaps_col are only useful when cluster=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtype</code></td>
<td>
<p>A logic value to determine for a lipid like "PC(O-14:0/16:1)", "lipid_type" should be
"PC" (subtype=FALSE) or "PC(O)" (subtype=TRUE). Default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels_row</code></td>
<td>
<p>A vector contains the labels of each row of the heatmap.
Default value is row names of dataframe input. It can be input like ("PE(20:1/20:1)","PS(16:0/18:1)","","","","LPA(18:0)")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels_col</code></td>
<td>
<p>A vector contains the labels of each column of the heatmap.
Default value is column names of dataframe input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>The title of heatmap. Default value is "".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_rownames</code></td>
<td>
<p>Whether to show row names or not. Default value is T.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_colnames</code></td>
<td>
<p>Whether to show column names or not. Default value is T.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellcolor</code></td>
<td>
<p>The color range of cells in the heatmap. It should be input in a vector with
three color values, such as c("blue","black","yellow").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Whether to show legends or not. Default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border_color</code></td>
<td>
<p>Useful when border=T. Default value is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>Whether to show borders or not. Default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutree_rows</code></td>
<td>
<p>Useful when cluster=T. If cutree_rows=T, the rows of heatmap will be divided according to
clustering results. Default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutree_cols</code></td>
<td>
<p>Useful when cluster=T. If cutree_cols=T, the rows of heatmap will be divided according to
clustering results. Default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtitle</code></td>
<td>
<p>Row title of the heatmap. Default value is "group".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctitle</code></td>
<td>
<p>Column title of the heatmap. Default value is " ".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize_row</code></td>
<td>
<p>Fontsize of row labels. Default value is 12.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize_col</code></td>
<td>
<p>Fontsize of column labels. Default value is 12.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize</code></td>
<td>
<p>Fontsize of all labels. Default value is 8.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A heatmap that is color-coded by abundance of lipids.
</p>


<h3>Examples</h3>

<pre><code class="language-R">WT_1=rnorm(n=10,mean=0.4,sd=0.1)
WT_2=rnorm(n=10,mean=0.4,sd=0.1)
WT_3=rnorm(n=10,mean=0.4,sd=0.1)
WT_4=rnorm(n=10,mean=0.4,sd=0.1)
KO_1=rnorm(n=10,mean=0.8,sd=0.1)
KO_2=rnorm(n=10,mean=0.8,sd=0.1)
KO_3=rnorm(n=10,mean=0.8,sd=0.1)
KO_4=rnorm(n=10,mean=0.8,sd=0.1)
WT_treat_1=rnorm(n=10,mean=0.1,sd=0.1)
WT_treat_2=rnorm(n=10,mean=0.1,sd=0.1)
WT_treat_3=rnorm(n=10,mean=0.1,sd=0.1)
WT_treat_4=rnorm(n=10,mean=0.1,sd=0.1)
KO_treat_1=rnorm(n=10,mean=0.6,sd=0.1)
KO_treat_2=rnorm(n=10,mean=0.6,sd=0.1)
KO_treat_3=rnorm(n=10,mean=0.6,sd=0.1)
KO_treat_4=rnorm(n=10,mean=0.6,sd=0.1)
data=data.frame(WT_1,WT_2,WT_3,WT_4,KO_1,KO_2,KO_3,KO_4,
               WT_treat_1,WT_treat_2,WT_treat_3,WT_treat_4,
               KO_treat_1,KO_treat_2,KO_treat_3,KO_treat_4)
rownames(data)=c("LPC(16:0)","PC(14:0/16:1)","PC(18:1/18:1)","PE(18:0/20:1)",
                "PS(20:1/20:1)","PI(16:0/16:1)","PC(18:0/18:1)","PA(16:0/16:1)",
                "LPE(18:0)","PE(O-18:1/18:0)")
group=rep(c("WT","KO","WT_treat","KO_treat"),each=4)
heatmap(data,group)
</code></pre>


</div>