<div class="container">

<table style="width: 100%;"><tr>
<td>power.chisq.test.simulate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate power of Chi-squared tests with conditioning</h2>

<h3>Description</h3>

<p><code>power.chisq.test.simulate</code> simulates power for tests for 2-way contingency tables based on the Pearson Chi-squared test statistics by simulation under 4 different conditioning scenarios.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.chisq.test.simulate(
  x,
  conditioning = "total",
  x0 = NULL,
  sig.level = 0.05,
  B = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix specifying the alternative distribution of the contingency table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conditioning</code></td>
<td>
<p>character string specifying the simulation scenario. Defaults to <code>"total"</code>. Other possible scenarios are <code>"row"</code>, <code>"col"</code>, and <code>"both"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>matrix specifying the null distribution. Defaults to <code>NULL</code>, in which case the null is estimated from the alternative <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>significance level used in test. Defaults to 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>integer specifying the number of replicates used in the Monte Carlo test. Defaults to 10000.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using <code>conditioning="both"</code> corresponds to selecting <code>simulate.p.value=TRUE</code> in <code>chisq.test</code>. However, conditioning on both row and column marginals appears to be rarely justified in real data. Instead <code>conditioning="total"</code> is the correct choice for testing independence. Similarly, <code>conditioning="row"</code> is recommended when the row marginals e.g. are fixed by experimental design.
Both the alternative and the null are simulated under the parametric scenario estimated from the data matrix <code>x</code>. This possibly induces a discrepancy with <code>chisq.test.simulate</code>, where the null also is simulated from the specific data instance. Thus, the problem is that the null distribution depends on the model parameters.
</p>


<h3>Value</h3>

<p>An object of class <code>"power.htest"</code>.
</p>


<h3>Note</h3>

<p>The code has not been optimized for speed, and might be slow.
</p>


<h3>Author(s)</h3>

<p>Bo Markussen
</p>


<h3>See Also</h3>

<p><code>chisq.test.simulate</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The Avadex dataset
Xobs &lt;- matrix(c(2,3,6,40),2,2)
rownames(Xobs) &lt;- c("Avadex +","Avadex -")
colnames(Xobs) &lt;- c("Tumor +","Tumor -")

# In this example only the rows appear to be fixed by experimental design.
power.chisq.test.simulate(Xobs,"row")
power.chisq.test.simulate(Xobs,"total")

</code></pre>


</div>