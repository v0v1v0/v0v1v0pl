<div class="container">

<table style="width: 100%;"><tr>
<td>calcDistMax</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjust the p.values Using the Quantiles of the Max Statistic</h2>

<h3>Description</h3>

<p>Adjust the p.values using the quantiles of the max statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcDistMaxIntegral(
  statistic,
  iid,
  df,
  iid.previous = NULL,
  quantile.previous = NULL,
  quantile.compute = lava.options()$search.calc.quantile.int,
  alpha,
  cpus = 1,
  cl = NULL,
  trace
)

calcDistMaxBootstrap(
  statistic,
  iid,
  iid.previous = NULL,
  quantile.previous = NULL,
  method,
  alpha,
  cpus = 1,
  cl = NULL,
  n.sim,
  trace,
  n.repmax = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>[numeric vector] the observed Wald statistic.
Each statistic correspond to a null hypothesis (i.e. a coefficient) that one wish to test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iid</code></td>
<td>
<p>[matrix] zero-mean iid decomposition of the coefficient used to compute the statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>[numeric] the degree of freedom defining the multivariate Student's t distribution.
If <code>NULL</code> the multivariate Gaussian distribution will be used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iid.previous</code></td>
<td>
<p>[matrix, EXPERIMENTAL] zero-mean iid decomposition of previously tested coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile.previous</code></td>
<td>
<p>[numeric, EXPERIMENTAL] rejection quantiles of the previously tested hypotheses. If not <code>NULL</code> the values should correspond the variable in to the first column(s) of the argument <code>iid.previous</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile.compute</code></td>
<td>
<p>[logical] should the rejection quantile be computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>[numeric 0-1] the significance cutoff for the p-values.
When the p-value is below, the corresponding link will be retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpus</code></td>
<td>
<p>[integer &gt;0] the number of processors to use.
If greater than 1, the computation of the p-value relative to each test is performed in parallel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>[cluster] a parallel socket cluster generated by <code>parallel::makeCluster</code>
that has been registered using <code>registerDoParallel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>[logical] should the execution of the function be traced?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>[character] the method used to compute the p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>[integer &gt;0] the number of bootstrap simulations used to compute each p-values.
Disregarded when the p-values are computed using numerical integration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.repmax</code></td>
<td>
<p>[integer &gt;0] the maximum number of rejection for each bootstrap sample before switching to a new bootstrap sample.
Only relevant when conditioning on a previous test.
Disregarded when the p-values are computed using numerical integration.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li>
<p> p.adjust: the adjusted p-values.
</p>
</li>
<li>
<p> z: the rejection threshold.
</p>
</li>
<li>
<p> Sigma: the correlation matrix between the test statistic.
</p>
</li>
<li>
<p> correctedLevel: the alpha level corrected for conditioning on previous tests.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(mvtnorm)

set.seed(10)
n &lt;- 100
p &lt;- 4
link &lt;- letters[1:p]
n.sim &lt;- 1e3 # number of bootstrap simulations 

#### test - not conditional ####
X.iid &lt;- rmvnorm(n, mean = rep(0,p), sigma = diag(1,p))
colnames(X.iid) &lt;- link
statistic &lt;- setNames(1:p,link)


r1 &lt;- calcDistMaxIntegral(statistic = statistic, iid = X.iid, 
            trace = FALSE, alpha = 0.05, df = 1e6) 

r3 &lt;- calcDistMaxBootstrap(statistic = statistic, iid = X.iid,
            method = "residual",
            trace = FALSE, alpha = 0.05, n.sim = n.sim)

r4 &lt;- calcDistMaxBootstrap(statistic = statistic, iid = X.iid,
            method = "wild",
            trace = FALSE, alpha = 0.05, n.sim = n.sim)

rbind(integration = c(r1$p.adjust, quantile = r1$z),
      bootResidual = c(r3$p.adjust, quantile = r3$z),
      bootWild    = c(r4$p.adjust, quantile = r4$z))

#### test - conditional ####
## Not run: 
Z.iid &lt;- rmvnorm(n, mean = rep(0,p+1), sigma = diag(1,p+1))
seqQuantile &lt;- qmvnorm(p = 0.95, delta = rep(0,p+1), sigma = diag(1,p+1), 
                    tail = "both.tails")$quantile

r1c &lt;- calcDistMaxIntegral(statistic = statistic, iid = X.iid,
            iid.previous = Z.iid, quantile.previous =  seqQuantile, 
            trace = FALSE, alpha = 0.05, df = NULL)

r3c &lt;- calcDistMaxBootstrap(statistic = statistic, iid = X.iid,
            iid.previous = Z.iid, quantile.previous =  seqQuantile, method = "residual",
            trace = FALSE, alpha = 0.05, n.sim = n.sim)

r4c &lt;- calcDistMaxBootstrap(statistic = statistic, iid = X.iid,
            iid.previous = Z.iid, quantile.previous =  seqQuantile, method = "wild",
            trace = FALSE, alpha = 0.05, n.sim = n.sim)

rbind(integration = c(r1c$p.adjust, quantile = r1c$z),
      bootResidual = c(r3c$p.adjust, quantile = r3c$z),
      bootWild    = c(r4c$p.adjust, quantile = r4c$z))

## End(Not run)
</code></pre>


</div>