<div class="container">

<table style="width: 100%;"><tr>
<td>model.matrix.lmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Design Matrix for Linear Mixed Model</h2>

<h3>Description</h3>

<p>Extract or construct design matrices for Linear Mixed Model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lmm'
model.matrix(
  object,
  newdata = NULL,
  effects = "mean",
  simplify = TRUE,
  drop.X = NULL,
  na.rm = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an lmm object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>[data.frame] dataset relative to which the design matrix should be constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>[character] design matrix relative to the mean model (<code>"mean"</code>), variance model (<code>"variance"</code>), correlation model (<code>"correlation"</code>),
or all the previous (<code>"all"</code>).
Can also be <code>"index"</code> to only output the normalize data and the cluster, time, strata indexes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>[logical] simplify the data format of the output (matrix instead of a list of matrix) when possible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.X</code></td>
<td>
<p>[logical] when the design matrix does not have full rank, should columns be dropped?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>[logical] Should row containing missing values for the variables used in the linear mixed model be removed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used. For compatibility with the generic method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>When <code>simplify</code> is <code>FALSE</code>, a list with the followin elements: </p>

<ul>
<li> <p><code>mean</code>: design matrix for the mean model
</p>
</li>
<li> <p><code>Y</code>: vector of outcome values
</p>
</li>
<li> <p><code>vcov</code>: list of elements for the variance and correlation models.
</p>
</li>
<li> <p><code>index.cluster</code>: list containing, for each cluster, the location of the corresponding observations in the processed dataset.
</p>
</li>
<li> <p><code>index.clusterTime</code>: list containing, for each cluster, the repetition index corresponding observations.
</p>
</li>
<li> <p><code>index.clusterStrata</code>: list containing, for each cluster, the strata index corresponding observations.
</p>
</li>
<li> <p><code>param</code>: data.frame describing the modle parameters.
</p>
</li>
<li> <p><code>drop.X</code>: logical value indicating whether columns in the design matrix should be dropped if it has not full rank.
</p>
</li>
<li> <p><code>precompute.XX</code>, <code>precompute.XY</code>: moments of X and Y 
</p>
</li>
</ul>
<p>When <code>simplify</code> is <code>TRUE</code>, this list will be simplified into a list with three elements: </p>

<ul>
<li> <p><code>mean</code>: design matrix for the mean model
</p>
</li>
<li> <p><code>variance</code>: design matrix for the variance model
</p>
</li>
<li> <p><code>correlation</code>: design matrix for the correlation model
</p>
</li>
</ul>
<p>or a single design matrixx.
</p>


</div>