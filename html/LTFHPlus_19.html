<div class="container">

<table style="width: 100%;"><tr>
<td>graph_based_covariance_construction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constructing covariance matrix from local family graph</h2>

<h3>Description</h3>

<p>Function that constructs the genetic covariance matrix given a graph around a proband
and extracts the threshold information from the graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">graph_based_covariance_construction(
  pid,
  cur_proband_id,
  cur_family_graph,
  h2,
  add_ind = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pid</code></td>
<td>
<p>Name of column of personal ID</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cur_proband_id</code></td>
<td>
<p>id of proband</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cur_family_graph</code></td>
<td>
<p>local graph of current proband</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2</code></td>
<td>
<p>liability scale heritability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_ind</code></td>
<td>
<p>whether to add genetic liability of the proband or not. Defaults to true.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with two elements. The first element is temp_tbl, which contains the id of
the current proband, the family ID and the lower and upper thresholds. The second element,
cov, is the covariance matrix of the local graph centered on the current proband.
</p>


<h3>Examples</h3>

<pre><code class="language-R">fam &lt;- data.frame(
  id = c("pid", "mom", "dad", "pgf"),
  dadcol = c("dad", 0, "pgf", 0),
  momcol = c("mom", 0, 0, 0))

thresholds &lt;- data.frame(
  id = c("pid", "mom", "dad", "pgf"),
  lower = c(-Inf, -Inf, 0.8, 0.7),
  upper = c(0.8, 0.8, 0.8, 0.7))

graph &lt;- prepare_graph(fam, icol = "id", fcol = "dadcol", mcol = "momcol", thresholds = thresholds)

graph_based_covariance_construction(pid = "id",
                                    cur_proband_id = "pid",
                                    cur_family_graph = graph,
                                    h2 = 0.5)

</code></pre>


</div>