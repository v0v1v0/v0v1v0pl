<div class="container">

<table style="width: 100%;"><tr>
<td>Linp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Solves a linear inverse model using linear programming.
</h2>

<h3>Description</h3>

<p>Solves a linear inverse model using linear programming
</p>
<p>Input presented either as:
</p>

<ul>
<li>
<p> matrices E, F, A, B, G, H (Linp.double) or
</p>
</li>
<li>
<p> as a list (Linp.lim) or
</p>
</li>
<li>
<p> as a lim input file (Linp.limfile)
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">Linp(...)
## S3 method for class 'lim'
Linp(lim, cost = NULL, ispos = lim$ispos, ...)
## S3 method for class 'limfile'
Linp(file, verbose = TRUE,...)
## S3 method for class 'character'
Linp(...)
## S3 method for class 'double'
Linp(...) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lim </code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file </code></td>
<td>
<p>name of the inverse input file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose </code></td>
<td>
<p>if <code>TRUE</code>: when reading the file,
prints warnings and messages to the screen.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost </code></td>
<td>
<p>if not <code>NULL</code>, a vector with the coefficients of the
cost function (to be minimised).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ispos </code></td>
<td>
<p>if <code>TRUE</code>: all x-values have to be positive.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>
<p>other arguments passed to function linp
from package<code>limSolve</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Solves the following inverse problem:
</p>
<p style="text-align: center;"><code class="reqn">\min(\sum {Cost_i*x_i})</code>
</p>
<p> or
</p>
<p style="text-align: center;"><code class="reqn">\max(\sum {Profit_i*x_i})</code>
</p>
<p> subject to
</p>
<p style="text-align: center;"><code class="reqn">x_i&gt;=0</code>
</p>

<p style="text-align: center;"><code class="reqn">Ax=B</code>
</p>

<p style="text-align: center;"><code class="reqn">Gx&gt;=H</code>
</p>

<p>and where <code class="reqn">Cost_i</code> or <code class="reqn">Profit_i</code> are weighting coefficients
</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X </code></td>
<td>
<p>vector containing the solution of the linear programming problem.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconstrained.solution </code></td>
<td>
<p>vector containing the unconstrained
solution of the linear programming problem.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residualNorm </code></td>
<td>
<p>scalar, the sum of residuals of equalities
and violated inequalities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solutionNorm </code></td>
<td>
<p>scalar, the value of the quadratic function
at the solution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IsError </code></td>
<td>
<p>logical, <code>TRUE</code> if an error occurred.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Error </code></td>
<td>
<p>linp error text.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>linp.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Michel Berkelaar and others (2005). lpSolve: Interface to Lpsolve v. 5
to solve linear/integer programs. R package version 1.1.9.
</p>


<h3>See Also</h3>

<p><code>linp</code>, the more general function from package <code>lpSolve</code>
</p>
<p><code>Ldei</code>, to solve the linear inverse problem by least
distance programming
</p>
<p><code>Lsei</code>, to solve the linear inverse problem by lsei
(least squares with equality and inequality constraints)
</p>
<p>function <code>linp</code> from package<code>limSolve</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # the Blending example
  Linp(LIMBlending)

  # the E coli example: two functions to maximimise
  Linp(LIMEcoli)
 
  # E coli example, but only first function optimised..
  Linp(LIMEcoli, cost = -LIMEcoli$Profit[1,])

  # a foodweb example: need to specify the cost function
  # here just sum of absolute values of flows...
  Linp(LIMRigaAutumn, cost = (rep(1, LIMRigaAutumn$NUnknowns)))
</code></pre>


</div>