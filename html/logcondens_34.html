<div class="container">

<table style="width: 100%;"><tr>
<td>logConDens</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute log-concave density estimator and related quantities</h2>

<h3>Description</h3>

<p>Compute the log-concave and smoothed log-concave density estimator.</p>


<h3>Usage</h3>

<pre><code class="language-R">logConDens(x, xgrid = NULL, smoothed = TRUE, print = FALSE, 
    gam = NULL, xs = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of independent and identically distributed numbers, not necessarily unique.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgrid</code></td>
<td>
<p>Governs the generation of weights for observations. See <code>preProcess</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothed</code></td>
<td>
<p>If <code>TRUE</code>, the smoothed version of the log-concave density estimator is also computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p><code>print = TRUE</code> outputs the log-likelihood in every loop, <code>print = FALSE</code> does not. Make sure to tell <code>R</code> to output (press CTRL+W).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>
<p>Only necessary if <code>smoothed = TRUE</code>. The standard deviation of the normal kernel. If equal to <code>NULL</code>, <code>gam</code> is chosen
such that the variances of the original sample <code class="reqn">x_1, \ldots, x_n</code> and <code class="reqn">\widehat f_n^*</code> coincide.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xs</code></td>
<td>
<p>Only necessary if <code>smoothed = TRUE</code>. Either provide a vector of support points where the smoothed estimator should be computed at, or
leave as <code>NULL</code>. Then, a sufficiently width equidistant grid of points will be used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>activeSetLogCon</code> for details on the computations.</p>


<h3>Value</h3>

<p><code>logConDens</code> returns an object of class <code>"dlc"</code>, a list containing the 
following components:
<code>xn</code>, <code>x</code>, <code>w</code>, <code>phi</code>, <code>IsKnot</code>, <code>L</code>, <code>Fhat</code>, <code>H</code>,
<code>n</code>, <code>m</code>, <code>knots</code>, <code>mode</code>, and <code>sig</code> as generated
by <code>activeSetLogCon</code>. If <code>smoothed = TRUE</code>, then the returned object additionally contains
<code>f.smoothed</code>, <code>F.smoothed</code>, <code>gam</code>, and <code>xs</code> as generated by <code>evaluateLogConDens</code>. Finally, the 
entry <code>smoothed</code> of type <code>"logical"</code> returnes the value of <code>smoothed</code>.
</p>
<p>The methods <code>summary.dlc</code> and <code>plot.dlc</code> are used to obtain a summary and generate plots of the estimated
density.
</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Lutz Duembgen, <a href="mailto:duembgen@stat.unibe.ch">duembgen@stat.unibe.ch</a>, <br><a href="https://www.imsv.unibe.ch/about_us/staff/prof_dr_duembgen_lutz/index_eng.html">https://www.imsv.unibe.ch/about_us/staff/prof_dr_duembgen_lutz/index_eng.html</a>
</p>


<h3>References</h3>

<p>Duembgen, L, Huesler, A. and Rufibach, K. (2010).
Active set and EM algorithms for log-concave densities based on complete and censored data. 
Technical report 61, IMSV, Univ. of Bern, available at <a href="https://arxiv.org/abs/0707.4643">https://arxiv.org/abs/0707.4643</a>.
</p>
<p>Duembgen, L. and Rufibach, K. (2009).
Maximum likelihood estimation of a log–concave density and its distribution function: basic properties and uniform consistency. 
<em>Bernoulli</em>, <b>15(1)</b>, 40–68.  
</p>
<p>Duembgen, L. and Rufibach, K. (2011).
logcondens: Computations Related to Univariate Log-Concave Density Estimation. 
<em>Journal of Statistical Software</em>, <b>39(6)</b>, 1–28. <a href="https://doi.org/10.18637/jss.v039.i06">doi:10.18637/jss.v039.i06</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## ===================================================
## Illustrate on simulated data
## ===================================================

## Set parameters
n &lt;- 50
x &lt;- rnorm(n)

res &lt;- logConDens(x, smoothed = TRUE, print = FALSE, gam = NULL, 
    xs = NULL)
summary(res)
plot(res, which = "density", legend.pos = "topright")
plot(res, which = "log-density")
plot(res, which = "CDF")

## Compute slopes and intercepts of the linear functions that 
## compose phi
slopes &lt;- diff(res$phi) / diff(res$x)
intercepts &lt;- -slopes * res$x[-n] + res$phi[-n]


## ===================================================
## Illustrate method on reliability data
## Reproduce Fig. 2 in Duembgen &amp; Rufibach (2009)
## ===================================================

## Set parameters
data(reliability)
x &lt;- reliability
n &lt;- length(x)
res &lt;- logConDens(x, smooth = TRUE, print = TRUE)
phi &lt;- res$phi
f &lt;- exp(phi)

## smoothed log-concave PDF
f.smoothed &lt;- res$f.smoothed
xs &lt;- res$xs

## compute kernel density
sig &lt;- sd(x)
h &lt;- sig / sqrt(n)
f.kernel &lt;- rep(NA, length(xs))
for (i in 1:length(xs)){
    xi &lt;- xs[i]
    f.kernel[i] &lt;- mean(dnorm(xi, mean = x, sd = h))
}

## compute normal density
mu &lt;- mean(x)
f.normal &lt;- dnorm(xs, mean = mu, sd = sig)

## ===================================================
## Plot resulting densities, i.e. reproduce Fig. 2
## in Duembgen and Rufibach (2009)
## ===================================================
plot(0, 0, type = 'n', xlim = range(xs), ylim = c(0, 6.5 * 10^-3))
rug(res$x)
lines(res$x, f, col = 2)
lines(xs, f.normal, col = 3)
lines(xs, f.kernel, col = 4)
lines(xs, f.smoothed, lwd = 3, col = 5)
legend("topleft", c("log-concave", "normal", "kernel", 
    "log-concave smoothed"), lty = 1, col = 2:5, bty = "n")


## ===================================================
## Plot log-densities
## ===================================================
plot(0, 0, type = 'n', xlim = range(xs), ylim = c(-20, -5))
legend("bottomright", c("log-concave", "normal", "kernel", 
    "log-concave smoothed"), lty = 1, col = 2:5, bty = "n")
rug(res$x)
lines(res$x, phi, col = 2)
lines(xs, log(f.normal), col = 3)
lines(xs, log(f.kernel), col = 4)
lines(xs, log(f.smoothed), lwd = 3, col = 5)


## ===================================================
## Confidence intervals at a fixed point for the density
## see help file for logConCI()
## ===================================================
</code></pre>


</div>