<div class="container">

<table style="width: 100%;"><tr>
<td>LocalControlClassic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local Control Classic</h2>

<h3>Description</h3>

<p>LocalControlClassic was originally contained in the deprecated
CRAN package USPS, this function is a combination
of three of the original USPS functions, UPShclus, UPSaccum, and UPSnnltd.
This replicates the original implementation of the Local Control functionality in
Robert Obenchain's USPS package. Some of the features have been
removed due to deprecation of R packages distributed through CRAN.
For a given number of patient clusters in baseline X-covariate space, LocalControlClassic()
characterizes the distribution of Nearest Neighbor "Local Treatement Differences" (LTDs) on
a specified Y-outcome variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LocalControlClassic(
  data,
  clusterVars,
  treatmentColName,
  outcomeColName,
  faclev = 3,
  scedas = "homo",
  clusterMethod = "ward",
  clusterDist = "euclidean",
  clusterCounts = c(50, 100, 200)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data frame containing all baseline X covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterVars</code></td>
<td>
<p>List of names of X variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatmentColName</code></td>
<td>
<p>Name of treatment factor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcomeColName</code></td>
<td>
<p>Name of outcome Y variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faclev</code></td>
<td>
<p>Maximum number of different numerical values an outcome variable can assume
without automatically being converted into a "factor" variable; faclev=1 causes a binary
indicator to be treated as a continuous variable determining an average or proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scedas</code></td>
<td>
<p>Scedasticity assumption: "homo" or "hete".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterMethod</code></td>
<td>
<p>Type of clustering method, defaults to "complete". Currently implemented methods:  "ward", "single", "complete" or "average".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterDist</code></td>
<td>
<p>Distance type to use, defaults to "euclidean". Currently implemented: "euclidiean", "manhattan", "maximum", or "minkowski".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterCounts</code></td>
<td>
<p>A vector containing different number of clusters in baseline X-covariate space which Local Control will iterate over.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing several elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>hiclus</code></td>
<td>
<p>Name of clustering object created by UPShclus().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dframe</code></td>
<td>
<p>Name of data.frame containing X, t &amp; Y variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trtm</code></td>
<td>
<p>Name of treatment factor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvar</code></td>
<td>
<p>Name of outcome Y variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numclust</code></td>
<td>
<p>Number of clusters requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>actclust</code></td>
<td>
<p>Number of clusters actually produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scedas</code></td>
<td>
<p>Scedasticity assumption: "homo" or "hete"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PStdif</code></td>
<td>
<p>Character string describing the treatment difference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nnhbindf</code></td>
<td>
<p>Vector containing cluster number for each patient. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rawmean</code></td>
<td>
<p>Unadjusted outcome mean by treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rawvars</code></td>
<td>
<p>Unadjusted outcome variance by treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rawfreq</code></td>
<td>
<p>Number of patients by treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratdif</code></td>
<td>
<p>Unadjusted mean outcome difference between treatments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratsde</code></td>
<td>
<p>Standard error of unadjusted mean treatment difference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binmean</code></td>
<td>
<p>Unadjusted mean outcome by cluster and treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binvars</code></td>
<td>
<p>Unadjusted variance by cluster and treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binfreq</code></td>
<td>
<p>Number of patients by bin and treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>awbdif</code></td>
<td>
<p>Across cluster average difference with cluster size weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>awbsde</code></td>
<td>
<p>Standard error of awbdif.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wwbdif</code></td>
<td>
<p>Across cluster average difference, inverse variance weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wwbsde</code></td>
<td>
<p>Standard error of wwbdif.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faclev</code></td>
<td>
<p>Maximum number of different numerical values an outcome variable can assume without
automatically being converted into a "factor" variable; faclev=1 causes a binary indicator to be
treated as a continuous variable determining an average or proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>youtype</code></td>
<td>
<p>"continuous" =&gt; only next eight outputs; "factor" =&gt; only last three outputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aovdiff</code></td>
<td>
<p>ANOVA summary for treatment main effect only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form2</code></td>
<td>
<p>Formula for outcome differences due to bins and to treatment nested within bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bindiff</code></td>
<td>
<p>ANOVA summary for treatment nested within cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>Estimate of error mean square in nested model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pbindif</code></td>
<td>
<p>Unadjusted treatment difference by cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pbinsde</code></td>
<td>
<p>Standard error of the unadjusted difference by cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pbinsiz</code></td>
<td>
<p>Cluster radii measure: square root of total number of patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symsiz</code></td>
<td>
<p>Symbol size of largest possible Snowball in a UPSnnltd() plot with 1 cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factab</code></td>
<td>
<p>Marginal table of counts by Y-factor level and treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumchi</code></td>
<td>
<p>Cumulative Chi-Square statistic for interaction in the three-way, nested table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumdf</code></td>
<td>
<p>Degrees of-Freedom for the Cumulative Chi-Squared.</p>
</td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> Obenchain, RL. <em>USPS package: Unsupervised and Supervised Propensity Scoring in R.</em> <a href="https://cran.r-project.org/src/contrib/Archive/USPS/">https://cran.r-project.org/src/contrib/Archive/USPS/</a> 2005.
</p>
</li>
<li>
<p> Obenchain, RL. <em>The ”Local Control” Approach to Adjustment for Treatment Selection Bias and Confounding (illustrated with JMP Scripts)</em>. Observational Studies. Cary, NC: SAS Press. 2009.
</p>
</li>
<li>
<p> Obenchain RL. The local control approach using JMP. In: Faries D, Leon AC, Haro JM, Obenchain RL, eds. Analysis of Observational Health Care Data Using SAS. Cary, NC: SAS Institute; 2010:151-194.
</p>
</li>
<li>
<p> Obenchain RL, Young SS. Advancing statistical thinking in observational health care research. J Stat Theory Pract. 2013;7(2):456-506.
</p>
</li>
<li>
<p> Faries DE, Chen Y, Lipkovich I, Zagar A, Liu X, Obenchain RL. Local control for identifying subgroups of interest in observational research: persistence of treatment for major depressive disorder. Int J Methods Psychiatr Res. 2013;22(3):185-194.
</p>
</li>
<li>
<p> Lopiano KK, Obenchain RL, Young SS. Fair treatment comparisons in observational research. Stat Anal Data Min. 2014;7(5):376-384.
</p>
</li>
<li>
<p> Young SS, Obenchain RL, Lambert CG (2016) A problem of bias and response heterogeneity. In: Alan Moghissi A, Ross G (eds) Standing with giants: A collection of public health essays in memoriam to Dr. Elizabeth M. Whelan. American Council on Science and Health, New York, NY, pp 153-169.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"> data(lindner)

 cvars &lt;- c("stent","height","female","diabetic","acutemi",
            "ejecfrac","ves1proc")
 numClusters &lt;- c(1, 2, 10, 15, 20, 25, 30, 35, 40, 45, 50)
 results &lt;- LocalControlClassic( data = lindner,
                                clusterVars = cvars,
                                treatmentColName = "abcix",
                                outcomeColName = "cardbill",
                                clusterCounts = numClusters)
 UPSLTDdist(results,ylim=c(-15000,15000))

</code></pre>


</div>