<div class="container">

<table style="width: 100%;"><tr>
<td>DT_example</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Broad sense heritability calculation.
</h2>

<h3>Description</h3>

<p>This dataset contains phenotpic data for 41 potato lines evaluated in 3 environments in an RCBD design. The phenotypic trait is tuber quality and we show how to obtain an estimate of DT_example for the trait.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data("DT_example")</code></pre>


<h3>Format</h3>

<p>The format is:
chr "DT_example"
</p>


<h3>Source</h3>

<p>This data was generated by a potato study.
</p>


<h3>References</h3>

<p>Giovanny Covarrubias-Pazaran (2024).  lme4breeding: enabling genetic evaluation in the age of genomic data. To be submitted to Bioinformatics.
</p>
<p>Douglas Bates, Martin Maechler, Ben Bolker, Steve Walker (2015). Fitting Linear Mixed-Effects Models Using lme4. Journal of Statistical Software, 67(1), 1-48.
</p>


<h3>See Also</h3>

<p>The core functions of the package <code>lmebreed</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
data(DT_example)
DT &lt;- DT_example
A &lt;- A_example
head(DT)

## Compound simmetry (CS) model
ans1 &lt;- lmebreed(Yield~Env + (1|Name) + (1|Env:Name),
             data=DT)
vc &lt;- VarCorr(ans1); print(vc,comp=c("Variance"))

BLUP &lt;- ranef(ans1, condVar=TRUE)$Name
SEs &lt;- attr(BLUP, which="postVar")[,,]



## Compound simmetry (CS) + Diagonal (DIAG) model
## with relationship matrix
Z &lt;- with(DT, smm(Env))
csdiagFormula &lt;- paste0( "Yield ~ Env + (", paste(colnames(Z), collapse = "+"), "|| Name)")
for(i in 1:ncol(Z)){DT[,colnames(Z)[i]] &lt;- Z[,i]}
ansCSDG &lt;- lmebreed(as.formula(csdiagFormula),
                    relmat = list(Name = A ),
                    data=DT)
vc &lt;- VarCorr(ansCSDG); print(vc,comp=c("Variance"))

## Compound simmetry (CS) + Diagonal (DIAG) model
## with diagonal residuals
## with relationship matrix
Z &lt;- with(DT, smm(Env))
DT$units &lt;- as.factor(1:nrow(DT))
csdiagFormula &lt;- paste0( "Yield ~ Env",
                        "+(", paste(colnames(Z), collapse = "+"), "|| Name)",
                        "+(0+ ",paste(colnames(Z), collapse = "+"), "|| units)")
for(i in 1:ncol(Z)){DT[,colnames(Z)[i]] &lt;- Z[,i]}
ansCSDG &lt;- lmebreed(as.formula(csdiagFormula),
                    relmat = list(Name = A ),
                    control = lmerControl(
                      check.nobs.vs.nlev = "ignore",
                      check.nobs.vs.rankZ = "ignore",
                      check.nobs.vs.nRE="ignore"
                    ),
                    data=DT)
vc &lt;- VarCorr(ansCSDG); print(vc,comp=c("Variance"))



</code></pre>


</div>