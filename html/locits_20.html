<div class="container">

<table style="width: 100%;"><tr>
<td>plot.lacf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot localized autocovariance (lacf) object.
</h2>

<h3>Description</h3>

<p>Produces various ways of looking at a localized autocovariance
(lacf) object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lacf'
plot(x, plotcor = TRUE, type = "line",
        lags = 0:min(as.integer(10 * log10(nrow(x$lacf))), ncol(x$lacf) - 1),
        tcex = 1, lcol = 1, llty = 1, the.time = NULL, plot.it=TRUE,
	xlab, ylab, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The localized autocovariance object you want to plot (lacf)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotcor</code></td>
<td>
<p>If TRUE then plot autocorrelations, otherwise plot
autocovariances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The lacf objects are fairly complex and so there are
different ways you can plot them. The <code>type</code>s are
<code>line</code>, <code>persp</code> or <code>acf</code>, see the details for
description. Note that the <code>line</code> plot only works with
correlations currently.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p>The <code>lags</code> that you wish included in the plot.
The default is all the lags from 0 up to the maximum that
is used in the R acf plot 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tcex</code></td>
<td>
<p>In the <code>line</code> plot lines are plotted that indicate
the time-varying correlation. Each lag gets a different line
and the lines are differentiated by the lag id being placed
at intervals along the line. This argument changes the
size of those ids (numbers).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p>Controls the colours of the lines in the <code>line</code>
plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llty</code></td>
<td>
<p>Controls the line types of the lines in the <code>line</code>
plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>the.time</code></td>
<td>
<p>If the <code>acf</code> plot is chosen then you have to specify
a time point about which to plot the acf. I.e. in general this
funcion's lacf argument is a 2D function: <code class="reqn">c(t, \tau)</code>, the
<code>acf</code> plot produces a plot like the regular acf function
and so you have to turn the 2D <code class="reqn">c(t, \tau)</code> into a
1D function <code class="reqn">c(t_0, \tau)</code> by specifying a fixed time
point <code class="reqn">t_0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>If <code>TRUE</code> the plot is produced and displayed. If
<code>FALSE</code> then no plot is produced but the autocovariance
or autocorrelation values that would have been produced are
returned as numerical values instead. This means that
this function is an extractor function for the <code>lacf</code>
class object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X-axis label, constructed internally if not supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y-axis label, constructed internally if not supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to plot.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function produces pictures of the
two-dimensional time-varying autocovariance
or autocorrelation, <code class="reqn">c(t, \tau)</code>,
of a locally stationary time series.
There are three types of plot depending on the argument to
the <code>type</code> argument.
</p>
<p>The <code>line</code> plot draws the autocorrelations as a series of
lines, one for each lag, as lines over time. E.g. a sequence
#of lines <code class="reqn">c(t, \tau_i)</code> is drawn, one for each <code class="reqn">\tau_i</code>.
The zeroth lag line is the autocorrelation at lag 0 which is
always 1. By default all the lags are drawn which can result
in a confusing picture. Often, one is only interested in the low
level lags, so only these can be plotted by changing the <code>lags</code>
argument and any selection of lags can be plotted. The colour
and line type of the plotted lines can be changed with the
<code>lcol</code> and the <code>llty</code> arguments.
</p>
<p>The <code>acf</code> plot produces pictures similar to the standard
R <code>acf()</code> function plot. However, the regular acf is a
1D function, since it is defined to be constant over all time.
The time-varying acf supplied to this function is not constant
over all time (except for stationary processes, theoretically).
So, this type of plot requires the user to specify a fixed
time at which to produce the plot, and this is supplied by
the <code>the.time</code> argument.
</p>
<p>The <code>persp</code> plot plots the 2D function <code class="reqn">c(t, \tau)</code>
as a perspective plot. 
</p>


<h3>Value</h3>

<p>For the <code>acf</code> type plot the acf values are returned
invisibly. For the other types nothing is returned.
</p>


<h3>Author(s)</h3>

<p>G.P. Nason
</p>


<h3>References</h3>

<p>Cardinali, A. and Nason, G.P. (2012) Costationarity of Locally 
Stationary Time Series using <code>costat</code>.
</p>
<p>Cardinali, A. and Nason, G.P. (2010) Costationarity of locally stationary
time series. <em>J. Time Series Econometrics</em>, <b>2</b>, Issue 2, Article 1.
</p>
<p>Nason, G.P. (2013) A test for second-order stationarity and
approximate confidence intervals for localized autocovariances
for locally stationary time series. <em>J. R. Statist. Soc.</em> B,
<b>75</b>, 879-904.
<a href="https://doi.org/10.1111/rssb.12015">doi:10.1111/rssb.12015</a>
</p>


<h3>See Also</h3>

<p><code>lacf</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Make some dummy data, e.g. white noise
#
v &lt;- rnorm(256)
#
# Compute the localized autocovariance (ok, the input is stationary
# but this is just an example. More interesting things could be achieved
# by putting the results of simulating from a LSW process, or piecewise
# stationary by concatenating different stationary realizations, etc.
#
vlacf &lt;- lacf(v, lag.max=30)
#
# Now let's do some plotting of the localized autocovariance
#
## Not run: plot(vlacf, lags=0:6)
#
# Should get a plot where lag 0 is all up at value 1, and all other
# autocorrelations are near zero (since its white noise).
#
#
# How about just looking at lags 0, 2 and 4, and some different colours.
#
## Not run: plot(vlacf, lags=c(0,2,4), lcol=c(1,2,3))
#
# O.k. Let's concentrate on time t=200, let's look at a standard acf
# plot near there.
#
## Not run: plot(vlacf, type="acf", the.time=200)
#
# Now plot the autocovariance, rather than the autocorrelation.
#
## Not run: plot(vlacf, type="acf", the.time=200, plotcor=FALSE)
#
# Actually, the plot doesn't look a lot different as the series is white
# noise, but it is different if you look closely.
</code></pre>


</div>