<div class="container">

<table style="width: 100%;"><tr>
<td>write_ini_file</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create initialization files to launch MT4 platform with specific configuration</h2>

<h3>Description</h3>

<p>Function generate initialization files suitable for launching MT4 terminal with
specific parameters. Several options available for generating files specific for each purpose.
Option 'prod' will just use existing profile and connect to the broker server
Option 'backtest' will generate file for the robot backtest
Option 'opt' will generate file needed for the robot optimization
Option 'full' allows to specify any desired parameter
</p>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>


<h3>Usage</h3>

<pre><code class="language-R">write_ini_file(
  mt4_Profile = "Default",
  mt4_MarketWatch = "Forex.set",
  mt4_Login = "1234567",
  mt4_Password = "xxxxxXX",
  mt4_Server = "BrokerServerName",
  mt4_AutoConfiguration = "false",
  mt4_EnableNews = "false",
  mt4_ExpertsEnable = "true",
  mt4_ExpertsDllImport = "true",
  mt4_ExpertsExpImport = "true",
  mt4_ExpertsTrades = "true",
  mt4_Symbol = "EURUSD",
  mt4_Period = "H1",
  mt4_Template = "Default",
  mt4_Expert = "",
  mt4_ExpertParameters = "",
  mt4_Script = "",
  mt4_ScriptParameters = "",
  mt4_TestExpert = "",
  mt4_TestExpertParameters = "",
  mt4_TestSymbol = "EURUSD",
  mt4_TestPeriod = "H1",
  mt4_TestModel = "",
  mt4_TestSpread = "",
  mt4_TestOptimization = "false",
  mt4_TestDateEnable = "true",
  mt4_TestFromDate = "",
  mt4_TestToDate = "",
  mt4_TestReport = "test report",
  mt4_TestReplaceReport = "false",
  mt4_TestShutdownTerminal = "",
  mt4_TestVisualEnable = "false",
  dss_inifilepath = "",
  dss_inifilename = "test.ini",
  dss_mode = "prod"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mt4_Profile</code></td>
<td>
<p>string, the subdirectory name in the /profiles directory.
The charts will be opened in the client terminal according to the given profile.
If this parameter is not specified, the current profile will be opened</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_MarketWatch</code></td>
<td>
<p>string, file name (the symbolsets directory) that contains the symbol
list to be shown in the Market Watch window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_Login</code></td>
<td>
<p>string,  the number of the account to connect to at startup.
If this parameter is not specified, the current login will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_Password</code></td>
<td>
<p>string, the password that allows entering the system.
This parameter will be ignored if the client terminal stores personal data on the disk
and the account to be connected is in the list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_Server</code></td>
<td>
<p>string,  the name of the trade server to be connected to.
The server name is the same as the name of the corresponding .srv file stored in the /config directory</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_AutoConfiguration</code></td>
<td>
<p>string, "true" or "false"
depending on whether the autoconfiguration of Data Center setting should be enabled or not.
If this parameter is not specified, the value from the current server settings will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_EnableNews</code></td>
<td>
<p>string, either 'false' or 'true'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_ExpertsEnable</code></td>
<td>
<p>string, enable/disable experts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_ExpertsDllImport</code></td>
<td>
<p>string, enable/disable DLL imports</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_ExpertsExpImport</code></td>
<td>
<p>string, enable/disable import of functions from external experts or MQL4 libraries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_ExpertsTrades</code></td>
<td>
<p>string, enable/disable the experts trading</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_Symbol</code></td>
<td>
<p>string,the symbol of the security the chart of which should be opened
immediately after the terminal startup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_Period</code></td>
<td>
<p>string, the chart timeframe (M1, M5, M15, M30, H1, H4, D1, W1, MN).
If this parameter is not specified, H1 is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_Template</code></td>
<td>
<p>string,  the name of the template file (the templates directory),
which should be applied to the chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_Expert</code></td>
<td>
<p>string, the name of the expert that should be launched after the client terminal has started</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_ExpertParameters</code></td>
<td>
<p>string, the name of the file containing the expert parameters
(the MQL4 Presets directory).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_Script</code></td>
<td>
<p>string, the name of the script, which must be launched after the client terminal startup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_ScriptParameters</code></td>
<td>
<p>string, the name of the file containing the script parameters
(the MQL5 Presets directory).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestExpert</code></td>
<td>
<p>string, the name of the expert to be launched for testing.
If this parameter has not been specified, no testing is launched.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestExpertParameters</code></td>
<td>
<p>string,  the name of the file containing parameters (the tester directory).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestSymbol</code></td>
<td>
<p>string,  the name of the symbol used for the expert testing.
If this parameter has not been specified, the latest value used in the tester is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestPeriod</code></td>
<td>
<p>string, the chart period (M1, M5, M15, M30, H1, H4, D1, W1, MN).
If this parameter has not been specified, H1 is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestModel</code></td>
<td>
<p>string, 0, 1, or 2, depending on the testing model
(Every tick, Control points, Open prices only).
If this parameter has not been specified, 0 is used (Every tick)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestSpread</code></td>
<td>
<p>string, spread value that will be used for modeling Ask prices during testing.
If 0 value is specified, the strategy tester will use the current spread of a symbol at the beginning of testing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestOptimization</code></td>
<td>
<p>string, enable/disable optimization. The values that can be taken are "true" or "false".
If this parameter had not been specified, the "false" value is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestDateEnable</code></td>
<td>
<p>string, enable/disable the "Use date" flag.
The values that can be taken are "true" or "false".
If this parameter had not been specified, the "false" value is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestFromDate</code></td>
<td>
<p>string, the date, from which to start testing, appeared as YYYY.MM.DD.
If this parameter has not been specified, this date is 1970.01.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestToDate</code></td>
<td>
<p>string, the date, on which to finish testing, appeared as YYYY.MM.DD.
If this parameter has not been specified, this date is 1970.01.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestReport</code></td>
<td>
<p>string, the name of the test report file.
The file will be created in the client terminal directory.
A relative path can be specified, for example: tester \ MovingAverageReport".
If the extension has not been specified in the file name, the ".htm" will be set automatically.
If this parameter has not been specified, the test report will not be formed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestReplaceReport</code></td>
<td>
<p>string, enable/disable the repeated report file record.
The values that can be taken are "true" or "false"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestShutdownTerminal</code></td>
<td>
<p>string, enable/disable shutdown of the terminal
after the testing has been finished.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt4_TestVisualEnable</code></td>
<td>
<p>string, enable (true) or disable  (false) the visual test mode.
If the parameter is not specified, the current setting is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dss_inifilepath</code></td>
<td>
<p>string, path on the computer where file will be stored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dss_inifilename</code></td>
<td>
<p>string, file name that should be written</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dss_mode</code></td>
<td>
<p>string,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>added value of this function is the ability to generate multiple files to backtest several robots
for several timeframes. For example it is solves the problem of doing repetitive tasks to 'backtest'
robots for several currencies and repeat this procedure over time.
</p>
<p>Most of the variables present in the function are starting with a prefix mt4_,
the remainder of the name comes from the platform documentation, see references
</p>
<p>Remaining variables are named with a prefix 'dss_' stands for 'Decision Support System', as these
are the variables used for further automation purposes
</p>
<p>Note that for simplicity reasons not all parameters are present in this function.
e.g. FTP Settings and Proxy Server settings are not present
</p>


<h3>Value</h3>

<p>output is a file with desired parameters
</p>


<h3>Author(s)</h3>

<p>(C) 2019 Vladimir Zhbanko
</p>


<h3>References</h3>

<p>All parameters used are taken from the reference documentation
https://www.metatrader4.com/en/trading-platform/help/service/start_conf_file
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(lazytrade)

dir &lt;- normalizePath(tempdir(),winslash = "/")

# test file to launch MT4 terminal with parameters
write_ini_file(mt4_Profile = "Default",
               mt4_Login = "12345678",
               mt4_Password = "password",
               mt4_Server = "BrokerServerName",
               dss_inifilepath = dir,
               dss_inifilename = "prod_T1.ini",
               dss_mode = "prod")

# test file to launch robot backtest
TO &lt;- format(as.Date(Sys.Date()), "%Y.%m.%d")
FROM &lt;- format(as.Date(Sys.Date()-60), "%Y.%m.%d")

# test file for MT4 use for backtesting
write_ini_file(mt4_Profile = "Default",
               mt4_Login = "12345678",
               mt4_Password = "password",
               mt4_Server = "BrokerServerName",
               mt4_TestExpert="FALCON_D\\Falcon_D",
               mt4_TestExpertParameters="Falcon_D.set",
               mt4_TestSymbol="EURUSD",
               mt4_TestPeriod="H1",
               mt4_TestModel="2",
               mt4_TestSpread="20",
               mt4_TestOptimization="false",
               mt4_TestDateEnable="true",
               mt4_TestFromDate=FROM,
               mt4_TestToDate=TO,
               mt4_TestReport="EURUSD_Report",
               mt4_TestReplaceReport="false",
               mt4_TestShutdownTerminal="true",
               mt4_TestVisualEnable="false",
               dss_inifilepath = dir,
               dss_inifilename = "backtest.ini",
               dss_mode = "backtest")


</code></pre>


</div>