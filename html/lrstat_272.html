<div class="container">

<table style="width: 100%;"><tr>
<td>simonBayesSim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of Simon's Bayesian basket trials</h2>

<h3>Description</h3>

<p>Obtains the simulated raw and summary data for Simon's
Bayesian basket discovery trials.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simonBayesSim(
  p = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  stratumFraction = 1L,
  lambda = NA_real_,
  gamma = NA_real_,
  phi = NA_real_,
  plo = NA_real_,
  T = NA_real_,
  maxSubjects = NA_integer_,
  plannedSubjects = NA_integer_,
  maxNumberOfIterations = 1000L,
  maxNumberOfRawDatasets = 1L,
  seed = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The vector of true response probabilities across strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The prior probability that the drug activity is
homogeneous across strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The prior probability that the drug is active in a
stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>The response probability for an active drug.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plo</code></td>
<td>
<p>The response probability for an inactive drug.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>The threshold for a conclusive posterior probability to
stop enrollment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxSubjects</code></td>
<td>
<p>The maximum total sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plannedSubjects</code></td>
<td>
<p>The planned cumulative number of subjects
at each stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxNumberOfIterations</code></td>
<td>
<p>The number of simulation iterations.
Defaults to 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxNumberOfRawDatasets</code></td>
<td>
<p>The number of raw datasets to extract.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The seed to reproduce the simulation results.
The seed from the environment will be used if left unspecified,</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following four components:
</p>

<ul>
<li> <p><code>rawdata</code>: A data frame for subject-level data, containing
the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number.
</p>
</li>
<li> <p><code>subjectId</code>: The subject ID.
</p>
</li>
<li> <p><code>arrivalTime</code>: The enrollment time for the subject.
</p>
</li>
<li> <p><code>stratum</code>: The stratum for the subject.
</p>
</li>
<li> <p><code>y</code>: Whether the subject was a responder (1) or
nonresponder (0).
</p>
</li>
</ul>
</li>
<li> <p><code>sumdata1</code>: A data frame for simulation and stratum-level
summary data, containing the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number.
</p>
</li>
<li> <p><code>stratum</code>: The stratum number.
</p>
</li>
<li> <p><code>active</code>: Whether the drug is active in the stratum.
</p>
</li>
<li> <p><code>n</code>: The number of subjects in the stratum.
</p>
</li>
<li> <p><code>r</code>: The number of responders in the stratum.
</p>
</li>
<li> <p><code>posterior</code>: The posterior probability that the drug is
active in the stratum.
</p>
</li>
<li> <p><code>open</code>: Whether the stratum is still open for enrollment.
</p>
</li>
<li> <p><code>positive</code>: Whether the stratum has been determined to be
a positive stratum.
</p>
</li>
<li> <p><code>negative</code>: Whether the stratum has been determined to be
a negative stratum.
</p>
</li>
</ul>
</li>
<li> <p><code>sumdata2</code>: A data frame for the simulation level summary data,
containing the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>numberOfStrata</code>: The total number of strata.
</p>
</li>
<li> <p><code>n_active_strata</code>: The number of active strata.
</p>
</li>
<li> <p><code>true_positive</code>: The number of true positive strata.
</p>
</li>
<li> <p><code>false_negative</code>: The number of false negative strata.
</p>
</li>
<li> <p><code>false_positive</code>: The number of false positive strata.
</p>
</li>
<li> <p><code>true_negative</code>: The number of true negative strata.
</p>
</li>
<li> <p><code>n_indet_strata</code>: The number of indeterminate strata.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
</ul>
</li>
<li> <p><code>overview</code>: A data frame for the summary across simulations,
containing the following variables:
</p>

<ul>
<li> <p><code>numberOfStrata</code>: The total number of strata.
</p>
</li>
<li> <p><code>n_active_strata</code>: The average number of active strata.
</p>
</li>
<li> <p><code>true_positive</code>: The average number of true positive strata.
</p>
</li>
<li> <p><code>false_negative</code>: The average number of false negative strata.
</p>
</li>
<li> <p><code>false_positive</code>: The average number of false positive strata.
</p>
</li>
<li> <p><code>true_negative</code>: The average number of true negative strata.
</p>
</li>
<li> <p><code>n_indet_strata</code>: The average number of indeterminate strata.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The average number of subjects.
</p>
</li>
</ul>
</li>
</ul>
<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
sim1 = simonBayesSim(
  p = c(0.25, 0.25, 0.05),
  accrualIntensity = 5,
  stratumFraction = c(1/3, 1/3, 1/3),
  lambda = 0.33, gamma = 0.5,
  phi = 0.25, plo = 0.05,
  T = 0.8, maxSubjects = 50,
  plannedSubjects = seq(5, 50, 5),
  maxNumberOfIterations = 1000,
  maxNumberOfRawDatasets = 1,
  seed = 314159)

sim1$overview

</code></pre>


</div>