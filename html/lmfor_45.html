<div class="container">

<table style="width: 100%;"><tr>
<td>mywhiskers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A whiskers type residual plot</h2>

<h3>Description</h3>

<p>A function for adding vertical lines onto residual plots to show 
</p>

<ol>
<li>
<p> 95% confidence intervals of means or 
</p>
</li>
<li>
<p> 95% confidence intervals for individual observations 
</p>
</li>
</ol>
<p>in the classes of the 
variable on the x-axis. Plot of the first type is useful for analyzing the fit of the assumed fixed part and plots of 
type b can be used to analyze the homogeneity of residuals. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">mywhiskers(x, y, 
           nclass = 10, 
           limits = NA, 
           add = FALSE, 
           se = TRUE, 
           main = "", 
           xlab = "x", 
           ylab = "y", 
           ylim = NA, 
           lwd = 1, 
           highlight = "red")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> The variable on the x-axis. Usually one of the predictors or the predicted value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The variable on the y-axis. Usually model residual.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>

<p>The maximum number of classes to be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>

<p>The class limits. Alternative to nclass.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>logical. Whether a new graphic window is opened or the lines will be added into an exosting plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>

<p>Logical. Use standard errors of means (se=TRUE, option (a) above) or class-specific standard deviations 
(se=FALSE, option (b) above).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab, ylim, lwd</code></td>
<td>

<p>Graphical parameters of the plot. ignored if <code>add=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight</code></td>
<td>

<p>The color for lines that do not cross the y-axis.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function first classifies the data in <code>nclass</code> classes of variable x so that 
each class has approximately equal number of observations. 
Then the class mean and deviation s is computed for each class, where s is either 
the standard error of the mean (if <code>se=TRUE</code>) 
or standard deviation (if <code>se=FALSE</code>). 
A vertical line is plotted at the middle of each class showing the class mean by a dot and 
lines of length 3.92*s. If the line does not cross the x- axis, then the highlight color is used in the line.
With small number of observations (or lot of ties), the number of classes is decreased until 
each class includes the minimum of 2 observations.  
</p>


<h3>Value</h3>

<p>The function is usually used for its side effects (i.e., the plot). However, the values used in producing 
the plot are returned in a list of elements 
</p>

<ul>
<li>
<p> x: the class middlepoint <code>x</code> values.
</p>
</li>
<li>
<p> m: class-specific means of <code>y</code>.
</p>
</li>
<li>
<p> s: class-specific standard deviations or standard errors of <code>y</code> (see details).
</p>
</li>
<li>
<p> lb: lower ends of the class-specific lines.
</p>
</li>
<li>
<p> ub: upper ends of the lines.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Lauri Mehtatalo &lt;<a href="mailto:lauri.mehtatalo@uef.fi">lauri.mehtatalo@uef.fi</a>&gt;
</p>


<h3>References</h3>

<p>Mehtatalo, Lauri and Lappi, Juha 2020. Biometry for Forestry and Environmental Data: with examples in R. 
New York: Chapman and Hall/CRC. 426 p. <a href="https://doi.org/10.1201/9780429173462">doi:10.1201/9780429173462</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x&lt;-seq(1,100,1)
y&lt;-x+10*log(x)+rnorm(100,0,5)
fm1&lt;-lm(y~x)
plot(x,resid(fm1))
mywhiskers(x,resid(fm1),se=FALSE,add=TRUE)
mywhiskers(x,resid(fm1),se=TRUE,lwd=2,add=TRUE)
abline(h=0)
</code></pre>


</div>