<div class="container">

<table style="width: 100%;"><tr>
<td>pyrola</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Demographic Dataset of <em>Pyrola japonica</em> and <em>Pyrola subaphylla</em>
Populations, in Horizontal Format</h2>

<h3>Description</h3>

<p>A dataset containing the states and fates of <em>Pyrola japonica</em> and
<em>Pyrola subaphylla</em>, family Ericaceae, from populations in the vicinity
of Mt. Bandai, Fukushima Prefecture, Japan, resulting from monitoring that
occurred annually between 2015 and 2020.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data(pyrola)
</code></pre>


<h3>Format</h3>

<p>A data frame with 454 individuals and 57 variables. Each row 
corresponds to an unique individual, and each variable from
<code>sprouted.2015</code> on refers to the state of the individual in a particular
year.
</p>

<dl>
<dt>species</dt>
<dd>
<p>String denoting which of the two species the individual
belongs to.</p>
</dd>
<dt>population</dt>
<dd>
<p>Integer denoting whcih population the individual belongs
to. Synonymous with species in this dataset.</p>
</dd>
<dt>id</dt>
<dd>
<p>A numeric variable giving a unique number to each 
individual within each species. Note that numbers are reused among the two
species.</p>
</dd>
<dt>sprouted.2015</dt>
<dd>
<p>A binomial indicating whether the individual had
living aboveground tissue observable in the 2015 census.</p>
</dd>
<dt>lvs.num.2015</dt>
<dd>
<p>Number of leaves in 2015.</p>
</dd>
<dt>lvs.lng.2015</dt>
<dd>
<p>Length of largest leaf in 2015.</p>
</dd>
<dt>lvs.wdt.2015</dt>
<dd>
<p>Width of largest leaf in 2015.</p>
</dd>
<dt>inf.num.2015</dt>
<dd>
<p>Number of inflorescences in 2015.</p>
</dd>
<dt>inf.lng.tot.2015</dt>
<dd>
<p>Summed inflorescence length in 2015.</p>
</dd>
<dt>flo.tot.2015</dt>
<dd>
<p>Number of flowers in 2015.</p>
</dd>
<dt>frt.tot.2015</dt>
<dd>
<p>Number of fruits in 2015.</p>
</dd>
<dt>sprouted.2016</dt>
<dd>
<p>A binomial indicating whether the individual had
living aboveground tissue observable in the 2016 census.</p>
</dd>
<dt>lvs.num.2016</dt>
<dd>
<p>Number of leaves in 2016.</p>
</dd>
<dt>lvs.lng.2016</dt>
<dd>
<p>Length of largest leaf in 2016.</p>
</dd>
<dt>lvs.wdt.2016</dt>
<dd>
<p>Width of largest leaf in 2016.</p>
</dd>
<dt>inf.num.2016</dt>
<dd>
<p>Number of inflorescences in 2016.</p>
</dd>
<dt>inf.lng.tot.2016</dt>
<dd>
<p>Summed inflorescence length in 2016.</p>
</dd>
<dt>flo.tot.2016</dt>
<dd>
<p>Number of flowers in 2016.</p>
</dd>
<dt>frt.tot.2016</dt>
<dd>
<p>Number of fruits in 2016.</p>
</dd>
<dt>sprouted.2017</dt>
<dd>
<p>A binomial indicating whether the individual had
living aboveground tissue observable in the 2017 census.</p>
</dd>
<dt>lvs.num.2017</dt>
<dd>
<p>Number of leaves in 2017.</p>
</dd>
<dt>lvs.lng.2017</dt>
<dd>
<p>Length of largest leaf in 2017.</p>
</dd>
<dt>lvs.wdt.2017</dt>
<dd>
<p>Width of largest leaf in 2017.</p>
</dd>
<dt>inf.num.2017</dt>
<dd>
<p>Number of inflorescences in 2017.</p>
</dd>
<dt>inf.lng.tot.2017</dt>
<dd>
<p>Summed inflorescence length in 2017.</p>
</dd>
<dt>flo.tot.2017</dt>
<dd>
<p>Number of flowers in 2017.</p>
</dd>
<dt>frt.tot.2017</dt>
<dd>
<p>Number of fruits in 2017.</p>
</dd>
<dt>sprouted.2018</dt>
<dd>
<p>A binomial indicating whether the individual had
living aboveground tissue observable in the 2018 census.</p>
</dd>
<dt>lvs.num.2018</dt>
<dd>
<p>Number of leaves in 2018.</p>
</dd>
<dt>lvs.lng.2018</dt>
<dd>
<p>Length of largest leaf in 2018.</p>
</dd>
<dt>lvs.wdt.2018</dt>
<dd>
<p>Width of largest leaf in 2018.</p>
</dd>
<dt>inf.num.2018</dt>
<dd>
<p>Number of inflorescences in 2018.</p>
</dd>
<dt>inf.lng.tot.2018</dt>
<dd>
<p>Summed inflorescence length in 2018.</p>
</dd>
<dt>flo.tot.2018</dt>
<dd>
<p>Number of flowers in 2018.</p>
</dd>
<dt>frt.tot.2018</dt>
<dd>
<p>Number of fruits in 2018.</p>
</dd>
<dt>sprouted.2019</dt>
<dd>
<p>A binomial indicating whether the individual had
living aboveground tissue observable in the 2019 census.</p>
</dd>
<dt>lvs.num.2019</dt>
<dd>
<p>Number of leaves in 2019.</p>
</dd>
<dt>lvs.lng.2019</dt>
<dd>
<p>Length of largest leaf in 2019.</p>
</dd>
<dt>lvs.wdt.2019</dt>
<dd>
<p>Width of largest leaf in 2019.</p>
</dd>
<dt>inf.num.2019</dt>
<dd>
<p>Number of inflorescences in 2019.</p>
</dd>
<dt>inf.lng.tot.2019</dt>
<dd>
<p>Summed inflorescence length in 2019.</p>
</dd>
<dt>flo.tot.2019</dt>
<dd>
<p>Number of flowers in 2019.</p>
</dd>
<dt>frt.tot.2019</dt>
<dd>
<p>Number of fruits in 2019.</p>
</dd>
<dt>sprouted.2020</dt>
<dd>
<p>A binomial indicating whether the individual had
living aboveground tissue observable in the 2020 census.</p>
</dd>
<dt>lvs.num.2020</dt>
<dd>
<p>Number of leaves in 2020.</p>
</dd>
<dt>lvs.lng.2020</dt>
<dd>
<p>Length of largest leaf in 2020.</p>
</dd>
<dt>lvs.wdt.2020</dt>
<dd>
<p>Width of largest leaf in 2020.</p>
</dd>
<dt>inf.num.2020</dt>
<dd>
<p>Number of inflorescences in 2020.</p>
</dd>
<dt>inf.lng.tot.2020</dt>
<dd>
<p>Summed inflorescence length in 2020.</p>
</dd>
<dt>flo.tot.2020</dt>
<dd>
<p>Number of flowers in 2020.</p>
</dd>
<dt>frt.tot.2020</dt>
<dd>
<p>Number of fruits in 2020.</p>
</dd>
</dl>
<h3>Source</h3>

<p>Shefferson, R.P., K. Shutoh, and K. Suetsugu. <em>In review</em>.
Vegetative dormancy and the evolution of mycoheterotrophy in sister
<em>Pyrola</em> species. <em>Journal of Ecology</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(pyrola)

pyrola$species &lt;- as.factor(pyrola$species)
pyrola$population &lt;- as.factor(pyrola$population)
jreg &lt;- pyrola[which(pyrola$population == 1),]
stagevec_jp &lt;- c("P1", "Sdl", "Dorm", "V0nr", "V1nr", "V2nr", "V3nr", "V4nr",
  "V0r", "V1r", "V2r", "V3r", "V4r")
sizeavec_jp &lt;- c(0, 0, 0, 0, 1, 2, 3, 7, 0, 1, 2, 3, 7)
sizeahbin_jp &lt;- c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 3.5, 0.5, 0.5, 0.5, 0.5,
  3.5)
repvec_jp &lt;- c(0, 0, 0, 0, rep(0, 4), rep(1, 5))
propvec_jp &lt;- c(1, rep(0, 12))
immvec_jp &lt;- c(1, 1, rep(0, 11))
matvec_jp &lt;- c(0, 0, rep(1, 11))
obsvec_jp &lt;- c(0, 0, 0, rep(1, 10))
indata_jp &lt;- c(0, 0, rep(1, 11))
comments_jp &lt;- c("protocorm", "seedling", "dormant adult", "stump", "1lf nr",
  "2lf nr", "3lf nr", "4+lf nr", "0lf r", "1lf r", "2lf r", "3lf r",
  "4+lf r")
jp_frame &lt;- sf_create(sizes = sizeavec_jp, stagenames = stagevec_jp,
  binhalfwidth = sizeahbin_jp, repstatus = repvec_jp, obsstatus = obsvec_jp,
  indataset = indata_jp, propstatus = propvec_jp, immstatus = immvec_jp,
  matstatus = matvec_jp, comments = comments_jp)
  
jhfv &lt;- verticalize3(data = jreg, noyears = 6, firstyear = 2015,
  individcol = "id", blocksize = 8, sizeacol = "lvs.num.2015",
  obsacol = "sprouted.2015", repstracol = "flo.tot.2015",
  repstrbcol = "frt.tot.2015", fecacol = "flo.tot.2015",
  fecbcol = "frt.tot.2015", NAas0 = TRUE, stagesize = "sizea",
  stageassign = jp_frame)

surv_model &lt;- glm(alive3 ~ sizea2 + as.factor(year2), data = jhfv, family = "binomial")

obs_data &lt;- subset(jhfv, alive3 == 1)
obs_model &lt;- glm(obsstatus3 ~ as.factor(year2), data = obs_data, family = "binomial")

size_data &lt;- subset(obs_data, obsstatus3 == 1)
size_model &lt;- glm(sizea3 ~ sizea2, data = size_data, family = "poisson")

reps_model &lt;- glm(repstatus3 ~ sizea2, data = size_data, family = "binomial")

fec_data &lt;- subset(jhfv, repstatus2 == 1)
fec_model &lt;- MASS::glm.nb(fec2added ~ 1, data = fec_data)

mod_params &lt;- create_pm(name_terms = TRUE)
mod_params$modelparams[4] &lt;- "alive3"
mod_params$modelparams[5] &lt;- "obsstatus3"
mod_params$modelparams[6] &lt;- "sizea3"
mod_params$modelparams[9] &lt;- "repstatus3"
mod_params$modelparams[11] &lt;- "fec2added"
mod_params$modelparams[12] &lt;- "sizea2"
mod_params$modelparams[18] &lt;- "repstatus2"

jp_germ &lt;- 0.90
jp_supp2 &lt;- supplemental(stage3 = c("Sdl", "Dorm", "V0nr", "V1nr", "P1", "Sdl"), 
  stage2 = c("P1", "Sdl", "Sdl", "Sdl", "rep", "rep"),
  eststage3 = c(NA, NA, NA, NA, NA, NA),
  eststage2 = c(NA, NA, NA, NA, NA, NA),
  givenrate = c(0.25, 0.35, 0.10, 0.10, NA, NA), # 0.345, 0.054
  multiplier = c(NA, NA, NA, NA, jp_germ * 0.5, jp_germ * 0.5),
  type = c(1, 1, 1, 1, 3, 3), stageframe = jp_frame, historical = FALSE)

jp_ahmpm &lt;- flefko2(year = "all", stageframe = jp_frame, supplement = jp_supp2,
  paramnames = mod_params, surv_model = surv_model, obs_model = obs_model,
  size_model = size_model, repst_model = reps_model, fec_model = fec_model,
  data = jhfv, err_check = TRUE)

lambda3(jp_ahmpm)
</code></pre>


</div>