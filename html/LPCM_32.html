<div class="container">

<table style="width: 100%;"><tr>
<td>plot.lpc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting local principal curves and mean shift trajectories</h2>

<h3>Description</h3>

<p>Takes an object of class <code>lpc</code>, <code>lpc.spline</code> or <code>ms</code>. In the case of principal curves, it plots any subset of the following components of the local principal curve:  Centers of mass; the curve connecting the local centers of mass; the cubic spline representation of the curve; the projections onto the curve; the starting points. For the mean shift procedure, it produces a plot of mean shift trajectories and cluster centers. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lpc'
plot(x, type, unscale = TRUE, lwd = 1, datcol = "grey60", 
    datpch = 21, masscol = NULL, masspch = 15, curvecol = 1, splinecol = 3, 
    projectcol = 4, startcol = NULL,  startpch=NULL,...)  
## S3 method for class 'lpc.spline'
plot(x, type, unscale = TRUE, lwd = 1, datcol = "grey60", 
    datpch = 21, masscol = NULL, masspch = 15, curvecol = 1, splinecol = 3, 
    projectcol = 4, startcol = NULL,  startpch=NULL,...)
## S3 method for class 'ms'
plot(x, unscale=FALSE, lwd=1, datcol="grey70",   datpch=21, masscol=NULL, 
    masspch=15, curvecol=NULL, ...)    
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>lpc</code>, <code>lpc.spline</code>, or <code>ms</code>.   </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a vector of type <code>c("mass", "spline",...)</code> with possible entries <code>mass, curve</code>, <code>spline, project, start.</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unscale</code></td>
<td>
<p>if TRUE, then data (and all fitted components) are scaled back to their original scale; otherwise the scaled data are plotted (only relevant if <code>scaled=TRUE</code>  in the fitted object). For <code>ms</code>, this is currently unimplemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>width of principal curves or trajectories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datcol</code></td>
<td>
<p>color of data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datpch</code></td>
<td>
<p>plotting symbol for data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>masscol</code></td>
<td>
<p>color of centers of mass (see below) or cluster centers.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>masspch</code></td>
<td>
<p>plotting symbol for centers of mass or cluster centers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curvecol</code></td>
<td>
<p>color of the curve interpolating the local centers of mass (this is the "local principal curve"!).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splinecol</code></td>
<td>
<p>color of the spline representation of the local principal curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projectcol</code></td>
<td>
<p>color of projections onto the spline representation of the local principal curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startcol</code></td>
<td>
<p>color of the plotted starting points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startpch</code></td>
<td>
<p>plotting symbol for starting points; needs to be either a
single symbol, or a vector of symbols of the same length as the number
of starting points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> further arguments passed to <code>plot</code> or <code>scatterplot3d</code>.  </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A plot of adequate dimensionality (depending on the type of object). 
</p>
<p>For local principal curves, the minimum supported dimension is <code class="reqn">d=2</code>, and for the mean shift it is <code class="reqn">d=1</code>. In either case, the maximum supported dimension is <code class="reqn">d=16</code>. With increasing dimension <code class="reqn">d</code>, less plotting options tend to be supported. The nicest plots are obtained  for <code class="reqn">d=2</code> and <code class="reqn">d=3</code>.
</p>
<p>The most flexible plotting option is <code>masscol</code>. Depending on the
length of the specified vector, this will be interpreted differently. If
a scalar is provided, the corresponding color will be given to all centers of
mass (or cluster centers). For LPCs, if the length of the vector is larger than 1, then this option
will assign different colours to  different depths, or different branch
numbers, or to individual data points, depending on the length. The
default setting is assigning colours according to depth, in the order
red, blue, black. 
</p>


<h3>Warning</h3>

<p>This function computes all missing information (if possible), so computation will take the longer the less informative the given object is, and the more advanced aspects are asked to plot!
</p>


<h3>Author(s)</h3>

<p> JE </p>


<h3>References</h3>

<p>Ameijeiras-Alonso, J. and Einbeck, J. (2023). A fresh look at mean-shift based modal clustering, Advances in Data Analysis and Classification, <a href="https://doi.org/10.1007/s11634-023-00575-1">doi:10.1007/s11634-023-00575-1</a>.
</p>
<p>Einbeck, J., Tutz, G.,  and Evers, L. (2005). Local principal curves. Statistics and Computing 15, 301-313.
</p>
<p>Einbeck, J., Evers, L. &amp; Hinchliff, K. (2010):  Data compression and regression based on local principal curves. In A. Fink, B. Lausen, W. Seidel, and A. Ultsch (Eds),  Advances in Data Analysis, Data Handling, and Business Intelligence, Heidelberg, pp. 701â€“712, Springer. 
</p>


<h3>See Also</h3>

 
<p><code>lpc</code>, <code>lpc.spline</code>  , <code>ms</code>  
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(calspeedflow)
lpc1 &lt;- lpc(calspeedflow[,3:4])
plot(lpc1, type=c("spline","project"), lwd=2)
ms1&lt;- ms(calspeedflow[,3:4], subset=sample.int(444,100), plot=FALSE) 
    # starts trajectories from 100 random obs'n
plot(ms1, masscol=1)
plot(ms1, curvecol="grey30")

data(mussels, package="dr")
ms2 &lt;- ms(mussels[,-3], scaled=1, h=0.1, plot=FALSE)
plot(ms2, datpch=20, masspch=24)
</code></pre>


</div>