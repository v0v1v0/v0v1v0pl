<div class="container">

<table style="width: 100%;"><tr>
<td>tau34sq.normtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Tau34-squared Test: A Normality Test based on L-skew and L-kurtosis and an Elliptical Rejection Region on an L-moment Ratio Diagram</h2>

<h3>Description</h3>

<p>This function performs highly intriguing test for normality using L-skew (<code class="reqn">\tau_3</code>) and L-kurtosis (<code class="reqn">\tau_4</code>) computed from an input vector of data. The test is simultaneously focused on L-skew and L-kurtosis. Harri and Coble (2011) presented two types of normality tests based on these two L-moment ratios. Their first test is dubbed the <code class="reqn">\tau_3\tau_4</code> test. Those authors however conclude that a second test dubbed the <code class="reqn">\tau^2_{3,4}</code> test “in particular shows consistently high power against [sic] symmetric distributions and also against [sic] skewed distributions and is a powerful test that can be applied against a variety of distributions.”
</p>
<p>A sample-size transformed quantity of the sample L-skew (<code class="reqn">\hat\tau_3</code>) is
</p>
<p style="text-align: center;"><code class="reqn">Z(\tau_3) = \hat\tau_3 \times \frac{1}{\sqrt{0.1866/n + 0.8/n^2}}\mathrm{,}</code>
</p>

<p>which has an approximate Standard Normal distribution. A sample-sized transformation of the sample L-kurtosis (<code class="reqn">\hat\tau_4</code>) is
</p>
<p style="text-align: center;"><code class="reqn">Z(\tau_4)' = \hat\tau_4 \times \frac{1}{\sqrt{0.0883/n}}\mathrm{,}</code>
</p>

<p>which also has an approximate Standard Normal distribution. A superior approximation for the variate of the Standard Normal distribution however is
</p>
<p style="text-align: center;"><code class="reqn">Z(\tau_4) = \hat\tau_4 \times \frac{1}{\sqrt{0.0883/n + 0.68/n^2 + 4.9/n^3}}\mathrm{,}</code>
</p>

<p>and is highly preferred for the algorithms in <code>tau34sq.normtest</code>.
</p>
<p>The <code class="reqn">\tau_3\tau_4</code> test (not implemented in <code>tau34sq.normtest</code>) by Harri and Coble (2011) can be constructed from the <code class="reqn">Z(\tau_3)</code> and <code class="reqn">Z(\tau_4)</code> statistics as shown, and a square rejection region constructed on an L-moment ratio diagram of L-skew versus L-kurtosis. However, the preferred method is the “Tau34-squared” test <code class="reqn">\tau^2_{3,4}</code> that can be developed by expressing an ellipse on the L-moment ratio diagram of L-skew versus L-kurtosis. The <code class="reqn">\tau^2_{3,4}</code> test statistic is defined as
</p>
<p style="text-align: center;"><code class="reqn">\tau^2_{3,4} = Z(\tau_3)^2 + Z(\tau_4)^2\mathrm{,}</code>
</p>

<p>which is approximately distributed as a <code class="reqn">\chi^2</code> distribution with two degrees of freedom. The <code class="reqn">\tau^2_{3,4}</code> also is the expression of the ellipical region on the L-moment ratio diagram of L-skew versus L-kurtosis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tau34sq.normtest(x, alpha=0.05, pvalue.only=FALSE, getlist=TRUE,
                    useHoskingZt4=TRUE, verbose=FALSE, digits=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code> significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue.only</code></td>
<td>
<p>Only return the p-value of the test and superceeds the <code>getlist</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>getlist</code></td>
<td>
<p>Return a list of salient parts of the computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useHoskingZt4</code></td>
<td>
<p>J.R.M. Hosking provided a better approximation <code class="reqn">Z(\tau_4)</code> in personal correspondance to Harri and Coble (2011) than the one <code class="reqn">Z(\tau_4)'</code> they first presented in their paper. This argument is a logical on whether this approximation should be used. It is highly recommended that <code>useHoskingZt4</code> be left at the default setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print a nice summary of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>How many digits to report in the summary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned if <code>getlist</code> argument is true. The list contents are
</p>
<table>
<tr style="vertical-align: top;">
<td><code>SampleTau3</code></td>
<td>
<p>The sample L-skew.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SampleTau4</code></td>
<td>
<p>The sample L-kurtosis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ztau3</code></td>
<td>
<p>The Z-value of <code class="reqn">\tau_3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ztau4</code></td>
<td>
<p>The Z-value of <code class="reqn">\tau_4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tau34sq</code></td>
<td>
<p>The <code class="reqn">\tau^2_{3,4}</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ChiSq.2df</code></td>
<td>
<p>The Chi-squared distribution nonexceedance probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>The p-value of the test (original notation for package).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>The p-value of the test (updated to align with many other hypothesis test styles).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isSig</code></td>
<td>
<p>A logical on whether the p-value is “statistically significant” based on the <code class="reqn">\alpha</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>The source of the parameters: “tau34sq.normtest”.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Harri, A., and Coble, K.H., 2011, Normality testing—Two new tests using L-moments: Journal of Applied Statistics, v. 38, no. 7, pp. 1369–1379.
</p>


<h3>See Also</h3>

<p><code>pdfnor</code>, <code>plotlmrdia</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">HarriCoble &lt;- tau34sq.normtest(rnorm(20), verbose=TRUE)
## Not run: 
# If this basic algorithm is run repeatedly with different arguments,
# then the first three rows of table 1 in Harri and Coble (2011) can
# basically be repeated. Testing by WHA indicates that even better
# empirical alphas will be computed compared to those reported in that table 1.
# R --vanilla --silent --args n 20 s 100 &lt; t34.R
# Below is file t34.R
library(batch) # for command line argument parsing
a &lt;- 0.05; n &lt;- 50; s &lt;- 5E5 # defaults
parseCommandArgs() # it will echo out those arguments on command line
sims &lt;- sapply(1:s, function(i) {
          return(tau34sq.normtest(rnorm(n),
                 pvalue.only=TRUE)) })
p &lt;- length(sims[sims &lt;= a])
print("RESULTS(Alpha, SampleSize, EmpiricalAlpha)")
print(c(a, n, p/s))

## End(Not run)
</code></pre>


</div>