<div class="container">

<table style="width: 100%;"><tr>
<td>lmrd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>L-moment ratio diagram</h2>

<h3>Description</h3>

<p>Draws an <code class="reqn">L</code>-moment ratio diagram.</p>


<h3>Usage</h3>

<pre><code class="language-R">lmrd(x, y, distributions = "GLO GEV GPA GNO PE3", twopar,
     xlim, ylim, pch=3, cex, col, lty, lwd=1,
     legend.lmrd = TRUE, xlegend, ylegend,
     xlab = expression(italic(L) * "-skewness"),
     ylab = expression(italic(L) * "-kurtosis"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector of <code class="reqn">L</code>-skewness values.
</p>
<p>Alternatively, if argument <code>y</code> is omitted, <code>x</code> can be an object
that contains both <code class="reqn">L</code>-skewness and <code class="reqn">L</code>-kurtosis values.
It can be a vector with elements named
<code>"t_3"</code> and <code>"t_4"</code> (or <code>"tau_3"</code> and <code>"tau_4"</code>),
a matrix or data frame with columns named
<code>"t_3"</code> and <code>"t_4"</code> (or <code>"tau_3"</code> and <code>"tau_4"</code>),
or an object of class <code>"regdata"</code> (as defined in package <span class="pkg">lmomRFA</span>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector of <code class="reqn">L</code>-kurtosis values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distributions</code></td>
<td>
<p>Indicates the three-parameter distributions
whose <code class="reqn">L</code>-skewness–<code class="reqn">L</code>-kurtosis relations
are to be plotted as lines on the diagram.
The following distribution identifiers are recognized, in upper or lower case:
</p>

<table>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>GLO</code>    </td>
<td style="text-align: left;"> generalized logistic </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>GEV</code>    </td>
<td style="text-align: left;"> generalized extreme-value </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>GPA</code>    </td>
<td style="text-align: left;"> generalized Pareto </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>GNO</code>    </td>
<td style="text-align: left;"> generalized normal </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>PE3</code>    </td>
<td style="text-align: left;"> Pearson type III </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>WAK.LB</code> </td>
<td style="text-align: left;"> lower bound of <code class="reqn">L</code>-kurtosis for given <code class="reqn">L</code>-skewness, </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;"> for the Wakeby distribution. </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>ALL.LB</code> </td>
<td style="text-align: left;"> lower bound of <code class="reqn">L</code>-kurtosis for given <code class="reqn">L</code>-skewness, </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;"> for all distributions.
      </td>
</tr>
</table>
<p>The argument should be either a character vector each of whose elements
is one of the above abbreviations or a character string
containing one or more of the abbreviations separated by blanks.
The specified <code class="reqn">L</code>-skewness–<code class="reqn">L</code>-kurtosis curves will be plotted.
</p>
<p>If no three-parameter distributions are to be plotted,
specify <code>distributions</code> to be <code>FALSE</code> or
the empty string, <code>""</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twopar</code></td>
<td>

<p>Two-parameter distributions whose (<code class="reqn">L</code>-skewness, <code class="reqn">L</code>-kurtosis) values
are to be plotted as points on the diagram.
The following distribution identifiers are recognized, in upper or lower case:
</p>

<table>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>E</code> or <code>EXP</code> </td>
<td style="text-align: left;"> exponential </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>G</code> or <code>GUM</code> </td>
<td style="text-align: left;"> Gumbel </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>L</code> or <code>LOG</code> </td>
<td style="text-align: left;"> logistic </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>N</code> or <code>NOR</code> </td>
<td style="text-align: left;"> normal </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>U</code> or <code>UNI</code> </td>
<td style="text-align: left;"> uniform
      </td>
</tr>
</table>
<p>The argument should be either a character vector each of whose elements
is one of the above abbreviations or a character string
containing one or more of the abbreviations separated by blanks.
<code class="reqn">L</code>-skewness–<code class="reqn">L</code>-kurtosis points for the specified distributions will be plotted
and given one-character labels.
</p>
<p>The default is to plot the two-parameter distributions that are special
cases of the three-parameter distributions specified in
argument <code>distributions</code>.  Thus for example if
<code>distributions="GPA PE3"</code>, the default for <code>twopar</code>
is <code>"EXP NOR UNI"</code>: NOR is a special case of PE3, UNI of GPA,
EXP of both GPA and PE3.
</p>
<p>If no two-parameter distributions are to be plotted,
specify <code>twopar</code> to be <code>FALSE</code> or the empty string, <code>""</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>x axis limits.
Default: <code>c(0, 0.6)</code>, expanded if necessary to cover the range of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y axis limits.
Default: <code>c(0, 0.4)</code>, expanded if necessary to cover the range of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Plotting character to be used for the plotted
(<code class="reqn">L</code>-skewness, <code class="reqn">L</code>-kurtosis) points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Symbol size for plotted points, like graphics parameter <code>cex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Vector specifying the colors.  If it is of length 1
and <code>x</code> is present, it will be used for the plotted points.
Otherwise it will be used for the lines on the plot.
For the default colors for the lines, see the description
of argument <code>lty</code> below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Vector specifying the line types to be used for the lines on the plot.
</p>
<p>By default, colors and line types are matched to the distributions given
in argument <code>distributions</code>, as follows:
</p>

<table>
<tr>
<td style="text-align: right;">
      
      
      
      
      
      
      
      
      
      </td>
<td style="text-align: left;"> <code>GLO</code>    </td>
<td style="text-align: left;"> blue,  solid line </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>GEV</code>    </td>
<td style="text-align: left;"> green, solid line </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>GPA</code>    </td>
<td style="text-align: left;"> red,   solid line </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>GNO</code>    </td>
<td style="text-align: left;"> black, solid line </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>PE3</code>    </td>
<td style="text-align: left;"> cyan,  solid line </td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>WAK.LB</code> </td>
<td style="text-align: left;"> red,   dashed line</td>
</tr>
<tr>
<td style="text-align: right;">
      </td>
<td style="text-align: left;"> <code>ALL.LB</code> </td>
<td style="text-align: left;"> black, dashed line
      </td>
</tr>
</table>
<p>The green and cyan colors are less bright than the standard
<code>"green"</code> and <code>"cyan"</code>; they are defined to be
<code>"#00C000"</code> and <code>"#00E0E0"</code>, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Vector specifying the line widths to be used for the lines on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.lmrd</code></td>
<td>
<p>Controls whether a legend,
identifying the <code class="reqn">L</code>-skewness–<code class="reqn">L</code>-kurtosis
relations of the three-parameter distributions, is plotted.
Either logical, indicating whether a legend is to be drawn,
or a list specifying arguments to the <code>legend</code> function.
Default arguments include <code>bty="n"</code>, which must be overridden
if a legend box is to be drawn; other arguments set by default are
<code>x</code>, <code>y</code>, <code>legend</code>, <code>col</code>, <code>lty</code>, and <code>lwd</code>.
</p>
<p>Not used if <code>distributions</code> is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlegend, ylegend</code></td>
<td>
<p>x and y coordinates of the upper left corner of the legend.
Default: coordinates of the upper left corner of the plot region,
shifted to the right and downwards, each by an amount equal to 1% of the range of the x axis.
</p>
<p>Not used if <code>distributions</code> is <code>FALSE</code> or if <code>legend.lmrd</code> is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments are passed to the function <code>matplot</code>,
which draws the axis box and the lines for three-parameter distributions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lmrd</code> calls a sequence of graphics functions:
<code>matplot</code> for the axis box and the curves for three-parameter distributions;
<code>points</code> for the points for two-parameter distributions and
<code>text</code> for their labels; <code>legend</code> for the legend; and
<code>points</code> for the <code class="reqn">(x,y)</code> data points.
</p>
<p>Note that the only graphics parameters passed to <code>points</code>
are <code>col</code> (if of length 1), <code>cex</code>, and <code>pch</code>.
If more complex features are required, such as different colors for
different points, follow <code>lmrd</code> by an additional call to <code>points</code>,
e.g. follow <code>lmrd(t3, t4)</code> by <code>points(t3, t4, col=c("red", "green"))</code>.
</p>


<h3>Value</h3>

<p>A list, returned invisibly, describing what was plotted.
Useful for customization of the legend, as in one of the examples below.
List elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lines</code></td>
<td>
<p>List containing elements describing the plotted distribution curves (if any).
Each element is a vector with the same length as <code>distributions</code>.
List elements <code>distributions</code>, <code>col.lines</code>, <code>lty</code>, <code>lwd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twopar</code></td>
<td>
<p>Character vector containing the 1-character symbols for the
two-parameter distributions that were plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>List containing elements describing the plot (if any) of the data points.
List elements <code>col.pts</code>, <code>pch</code>, <code>cex</code>.</p>
</td>
</tr>
</table>
<p>If any of the above items was not plotted, the corresponding list element is <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>See Also</h3>

<p>For adding to an <code class="reqn">L</code>-moment ratio diagram: <code>lmrdpoints</code>, <code>lmrdlines</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(airquality)
lmrd(samlmu(airquality$Ozone))

# Tweaking a few graphics parameters makes the graph look better
# (in the author's opinion)
lmrd(samlmu(airquality$Ozone), xaxs="i", yaxs="i", las=1)

# An example that illustrates the sampling variability of L-moments
#
# Generate 50 random samples of size 30 from the Gumbel distribution
# - stored in the rows of matrix mm
mm &lt;- matrix(quagum(runif(1500)), nrow=50)
#
# Compute the first four sample L-moments of each sample
# - stored in the rows of matrix aa
aa &lt;- apply(mm, 1, samlmu)
#
# Plot the L-skewness and L-kurtosis values on an L-moment ratio
# diagram that also shows (only) the population L-moment ratios
# of the Gumbel distribution
lmrd(t(aa), dist="", twopar="G", col="red")

# L-moment ratio diagram with curves for GLO, GEV, GPA, and Weibull.
# The Weibull curve is added manually. A legend is added,
# using information returned from lmrd().
#
# - Draw the diagram, with the GLO, GEV, and GPA curves
info &lt;- lmrd(distributions="GLO GEV GPA", xaxs="i", yaxs="i", las=1, legend=FALSE)
#
# - Compute L-skewness and L-kurtosis values for Weibull
sa &lt;- sapply(seq(0, 0.6, by=0.01),
    function(tau3) lmrwei(pelwei(c(0,1,tau3)), nmom=4)[3:4])
#
# - Plot the Weibull curve
lmrdlines(sa["tau_3",], sa["tau_4",], col="magenta", lwd=2)
#
# - Add a legend
legend("topleft", bty="n",
  legend = c(info$lines$distributions, "WEI"),
  col = c(info$lines$col.lines, "magenta"),
  lwd = c(info$lines$lwd, 3))
</code></pre>


</div>