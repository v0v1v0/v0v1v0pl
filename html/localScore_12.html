<div class="container">

<table style="width: 100%;"><tr>
<td>karlinMonteCarlo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo - Karlin [p-value]</h2>

<h3>Description</h3>

<p>Estimates p-value, for integer scores, based on a Monte Carlo estimation of Gumble
parameters from simulations of smaller sequences with same distribution. 
Appropriate for great sequences with length &gt; 10^3, for i.i.d and markovian sequence models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">karlinMonteCarlo(
  local_score,
  sequence_length,
  simulated_sequence_length,
  FUN,
  ...,
  numSim = 1000,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>local_score</code></td>
<td>
<p>local score observed in a segment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequence_length</code></td>
<td>
<p>length of the sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulated_sequence_length</code></td>
<td>
<p>length of simulated sequences produced by FUN</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>function to simulate similar sequences with.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>parameters for FUN</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numSim</code></td>
<td>
<p>number of sequences to create for estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>boolean value if to display plots for cumulated function and density</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The length of the simulated sequences is an argument specific to the function provided for simulation. Thus, it has to be
provided also in the parameter simulated_sequence_length in the arguments of the "Monte Carlo - Karlin" function. 
It is a crucial detail as it influences precision and computation time of the result. Note that to get an appropriate 
estimation, the given average score must be non-positive.
</p>


<h3>Value</h3>

<p>Floating value corresponding to the probability to obtain a local score with a value greater or equal to the parameter local_score
</p>


<h3>Examples</h3>

<pre><code class="language-R">new = sample(-7:6, replace = TRUE, size = 1000) 
#MonteCarlo taking random sample from the input sequence itself

karlinMonteCarlo(local_score = 66, sequence_length = 1000,  
               FUN = function(x, simulated_sequence_length) {return(sample(x = x, 
               size = simulated_sequence_length, replace = TRUE))}, 
               x=new, simulated_sequence_length = 1000,  numSim = 1000)

               
</code></pre>


</div>