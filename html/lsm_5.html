<div class="container">

<table style="width: 100%;"><tr>
<td>lsm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the log Likelihood of the Saturated Model</h2>

<h3>Description</h3>

<p>When the values of the outcome variable <code>Y</code> are either 0 or 1, the function <code>lsm()</code> calculates the estimation of the log likelihood in the saturated model. This model is characterized by Llinas (2006, ISSN:2389-8976) in section 2.3 through the assumptions 1 and 2. If <code>Y</code> is dichotomous and the data are grouped in <code>J</code> populations, it is recommended to use the function <code>lsm()</code> because it works very well for all <code>K</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lsm(formula, family = binomial, data = environment(formula), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An expression of the form y ~ model, where y is the outcome variable (binary or dichotomous: its values are 0 or 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>an optional funtion for example binomial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which <code>lsm()</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimation of the log Likelihood of the Saturated Model
</p>
<p>An expression of the form <code>y ~ model</code> is interpreted as a specification that the response <code>y</code> is modelled by a linear predictor specified symbolically by <code>model</code> (systematic component). Such a model consists of a series of terms separated by <code>+</code> operators. The terms themselves consist of variable and factor names separated by <code>:</code> operators. Such a term is interpreted as the interaction of all the variables and factors appearing in the term. Here, <code>y</code> is the outcome variable (binary or dichotomous: its values are 0 or 1).
</p>


<h3>Value</h3>

<p><code>lsm</code> returns an object of class "<code>lsm</code>".
</p>
<p>An object of class "<code>lsm</code>" is a list containing at least the
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Vector of coefficients estimations (intercept and slopes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>Vector of coefficients estimations (intercept and slopes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Std.Error</code></td>
<td>
<p>Vector of the coefficients’s standard error (intercept and slopes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ExpB</code></td>
<td>
<p>Vector with the exponential of the coefficients (intercept and slopes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wald</code></td>
<td>
<p>Value of the Wald statistic (with chi-squared distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DF</code></td>
<td>
<p>Degree of freedom for the Chi-squared distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.value</code></td>
<td>
<p>P-value calculated with the Chi-squared distribution. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Log_Lik_Complete</code></td>
<td>
<p>Estimation of the log likelihood in the complete model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Log_Lik_Null</code></td>
<td>
<p>Estimation of the log likelihood in the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Log_Lik_Logit</code></td>
<td>
<p>Estimation of the log likelihood in the logistic model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Log_Lik_Saturate</code></td>
<td>
<p>Estimation of the log likelihood in the saturate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Populations</code></td>
<td>
<p>Number of populations in the saturated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dev_Null_vs_Logit </code></td>
<td>
<p>Value of the test statistic  (Hypothesis: null vs logistic models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dev_Logit_vs_Complete</code></td>
<td>
<p>Value of the test statistic  (Hypothesis:  logistic vs complete models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dev_Logit_vs_Saturate</code></td>
<td>
<p>Value of the test statistic  (Hypothesis: logistic vs saturated models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Df_Null_vs_Logit </code></td>
<td>
<p>Degree of freedom for the test statistic’s distribution (Hypothesis: null vs logistic models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Df_Logit_vs_Complete </code></td>
<td>
<p>Degree of freedom for the test statistic’s distribution (Hypothesis: logistic vs saturated models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Df_Logit_vs_Saturate</code></td>
<td>
<p>Degree of freedom for the test statistic’s distribution (Hypothesis: logistic vs saturated models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.v_Null_vs_Logit</code></td>
<td>
<p>P-value for the hypothesis test: null vs logistic models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.v_Logit_vs_Complete </code></td>
<td>
<p>P-value for the hypothesis test:  logistic vs complete models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.v_Logit_vs_Saturate</code></td>
<td>
<p>P-value for the hypothesis test: logistic vs saturated models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Logit</code></td>
<td>
<p>Vector with the log-odds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_hat_complete</code></td>
<td>
<p>Vector with the probabilities that the outcome variable takes the value 1, given the <code>jth</code> population (estimated with the complete model and  without the logistic model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_hat_null</code></td>
<td>
<p>Vector with the probabilities that the outcome variable takes the value 1, given the <code>jth</code> population (estimated with the null model and  without the logistic model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_j</code></td>
<td>
<p>Vector with the probabilities that the outcome variable takes the value 1, given the <code>jth</code> population (estimated with the logistic model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odd</code></td>
<td>
<p>Vector with the values of the odd in each <code>jth</code> population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OR</code></td>
<td>
<p>Vector with the values of the odd ratio for each coefficient of the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_j</code></td>
<td>
<p>Vector with the values of each <code>Zj</code> (the sum of the observations in the <code>jth</code> population).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_j</code></td>
<td>
<p>Vector with the <code>nj</code> (the number of the observations in each <code>jth</code> population).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_j_tilde</code></td>
<td>
<p>Vector with the estimation of each <code>pj</code> (the probability of success in the <code>jth</code> population) in the saturated model (without estimate the logistic parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_j</code></td>
<td>
<p>Vector with the variance of the Bernoulli variables in the <code>jth</code> population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_j</code></td>
<td>
<p>Vector with the expected values of <code>Zj</code> in the <code>jth</code> population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V_j</code></td>
<td>
<p>Vector with the variances of <code>Zj</code> in the <code>jth</code> population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>Variance and covariance matrix of <code>Z</code>, the vector that contains all the <code>Zj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_p</code></td>
<td>
<p>Score vector in the saturated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I_p</code></td>
<td>
<p>Information matrix in the saturated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zast_j</code></td>
<td>
<p>Vector with the values of the standardized variable of <code>Zj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcov</code></td>
<td>
<p>Variance and covariance matrix for coefficient estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcor</code></td>
<td>
<p>Correlation matrix for coefficient estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Esm</code></td>
<td>
<p>Data frame with estimates in the saturated model. It contains for each population <code>j</code>: the value of the explanatory variables, <code>nj</code>, <code>Zj</code>, <code>pj</code> and Log-Likelihood <code>Lj_tilde</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Elm</code></td>
<td>
<p>Data frame with estimates in the logistic model. It contains for each population <code>j</code>: the value of the explanatory variables, <code>nj</code>, <code>Zj</code>, <code>pj</code>, Log-Likelihood <code>Lj</code>, <code>Logit_pj</code> and the variance of logit (<code>var.logit</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>It displays the original call that was used to fit the model lsm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data envarironment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to methods.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dr. rer. nat. Humberto LLinás Solano [aut] (Universidad del Norte, Barranquilla-Colombia);  MSc. Omar Fábregas Cera [aut] (Universidad del Norte, Barranquilla-Colombia); MSc. Jorge Villalba Acevedo [cre, aut] (Universidad Tecnológica de Bolívar, Cartagena-Colombia).
</p>


<h3>References</h3>

<p>[1] LLinás, H. J. (2006). Precisiones en la teoría de los modelos logísticos. Revista Colombiana de Estadística, 29(2), 239–265. https://revistas.unal.edu.co/index.php/estad/article/view/29310
</p>
<p>[2] Hosmer, D.W., Lemeshow, S. and Sturdivant, R.X. (2013). Applied Logistic Regression, 3rd ed., New York: Wiley.
</p>
<p>[3] Chambers, J. M. and Hastie, T. J. (1992). Statistical Models in S. Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code>lsm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#library(lsm)

#1. AGE and Coronary Heart Disease (CHD) Status of 20 subjects:

   #AGE &lt;- c(20,23,24,25,25,26,26,28,28,29,30,30,30,30,30,30,30,32,33,33)
   #CHD &lt;- c(0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0)
   #data &lt;- data.frame (CHD,  AGE )
   #lsm(CHD ~ AGE , data)

#2.You can use the following notation:

   #lsm(y~., data)

#3. Other example:

   #y &lt;- c(1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1)
   #x1 &lt;- c(2, 2, 2, 5, 5, 5, 5, 8, 8, 11, 11, 11)
   #data &lt;- data.frame (y, x1)
   #ELAINYS &lt;-lsm(y ~ x1, data)
   #summary(ELAINYS)

#4. Other example:

   #y &lt;- as.factor(c(1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1))
   #x1 &lt;- as.factor(c(2, 2, 2, 5, 5, 5, 5, 8, 8, 11, 11, 11))
   #data &lt;- data.frame (y, x1)
   #ELAINYS1 &lt;-lsm(y ~ x1, family=binomial, data)
   #summary(ELAINYS1)
</code></pre>


</div>