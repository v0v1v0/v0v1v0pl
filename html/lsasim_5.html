<div class="container">

<table style="width: 100%;"><tr>
<td>beta_gen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate regression coefficients</h2>

<h3>Description</h3>

<p>Uses the output from questionnaire_gen to generate linear
regression coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">beta_gen(
  data,
  MC = FALSE,
  MC_replications = 100,
  CI = c(0.005, 0.995),
  output_cov = FALSE,
  rename_to_q = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>output from the <code>questionnaire_gen</code> function with
<code>full_output = TRUE</code> and <code>theta = TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC</code></td>
<td>
<p>if <code>TRUE</code>, performs Monte Carlo simulation to estimate
regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC_replications</code></td>
<td>
<p>for <code>MC = TRUE</code>, this represents the number of
Monte Carlo subsamples calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>confidence interval for Monte Carlo simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_cov</code></td>
<td>
<p>if <code>TRUE</code>, will also output the covariance matrix of
YXW</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rename_to_q</code></td>
<td>
<p>if <code>TRUE</code>, renames the variables from "x" and "w" to
"q"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if 'FALSE', output messages will be suppressed (useful for simulations). Defaults to 'TRUE'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function was primarily conceived as a sub-function of
<code>questionnaire_gen</code>, when <code>family = "gaussian"</code>, <code>theta =
  TRUE</code>, and <code>full_output = TRUE</code>. However, it can also be directly
called by the user so they can perform further analysis.
</p>
<p>This function primarily calculates the true regression coefficients
(<code class="reqn">\beta</code>) for the linear influence of the background questionnaire
variables in <code class="reqn">\theta</code>. From a statistical perspective, this
relationship can be modeled as follows, where <code class="reqn">E(\theta | \boldsymbol{X}, \boldsymbol{W})</code> is the expectation of <code class="reqn">\theta</code> given <code class="reqn">\boldsymbol{X} = \{X_1, \ldots, X_P\}</code> and <code class="reqn">\boldsymbol{W} = \{W_1, \ldots, W_Q\}</code>:
</p>
<p style="text-align: center;"><code class="reqn">E(\theta | \boldsymbol{X}, \boldsymbol{W}) = \beta_0 + \sum_{p = 1}^P \beta_p X_p + \sum_{q = 1}^Q \beta_{P + q} W_q</code>
</p>

<p>The regression coefficients are calculated using the true covariance matrix
either provided by the user upon calling of <code>questionnaire_gen</code> or
randomly generated by that function if none was provided. In any case, that
matrix is not sample-dependent, though it should be similar to the one
observed in the generated data (especially for larger samples). One
convenient way to check for this similarity is by running the function with
<code>MC = TRUE</code>, which will generate a numeric estimate; the
<code>MC_replications</code> argument can be then increased to improve the
estimates at a often-noticeable cost in processing time. If <code>MC =
  FALSE</code>, the <code>MC_replications</code> will have no effect on the results. In
any case, each subsample will always have the same size as the original
sample.
</p>
<p>If the background questionnaire contains categorical variables (<code class="reqn">W</code>),
the original covariance matrix cannot be used because it contains the
covariances involving <code class="reqn">Z ~ N(0, 1)</code>, which is the random variable that
gets categorized into <code class="reqn">W</code>. The case where <code class="reqn">W</code> is always binomial is
trivial, but if at least one <code class="reqn">W</code> has more than two categories, the
structure of the covariance matrix changes drastically. In this case, this
function recalculates all covariances between <code class="reqn">\theta</code>, <code class="reqn">X</code> and
each category of <code class="reqn">W</code> using some auxiliary internal functions which rely
on the appropriate distribution (either multivariate normal or truncated
normal). To avoid multicollinearity, the first categories of each <code class="reqn">W</code>
are dropped before the regression coefficients are calculated.
</p>


<h3>Value</h3>

<p>By default, this function will output a vector of the regression
coefficients, including intercept. If <code>MC == TRUE</code>, the output will
instead be a matrix comparing the true regression coefficients obtained
from the covariance matrix with expected values obtained from a Monte Carlo
simulation, complete with 99% confidence interval.
</p>
<p>If <code>output_cov = TRUE</code>, the output will be a list with two elements:
the first one, <code>betas</code>, will contain the same output described in the
previous paragraph. The second one, called <code>vcov_YXW</code>, contains
the covariance matrix of the regression coefficients.
</p>


<h3>Note</h3>

<p>The equation in this page is best formatted in PDF. We recommend issuing 'help("beta_gen", help_type = "PDF")' in your terminal and opening the 'beta_gen.pdf' file generated in your working directly. You may also set 'help_type = "HTML"', but the equations will have degraded formatting.
</p>


<h3>See Also</h3>

<p>questionnaire_gen
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data &lt;- questionnaire_gen(100, family="gaussian", theta = TRUE,
                           full_output = TRUE, n_X = 2, n_W = list(2, 2, 4))
beta_gen(data, MC = TRUE)

</code></pre>


</div>