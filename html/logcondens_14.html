<div class="container">

<table style="width: 100%;"><tr>
<td>isoMean</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pool-Adjacent Violaters Algorithm: Least Square Fit under Monotonicity Constraint</h2>

<h3>Description</h3>

<p>Fits a vector <code class="reqn">\widehat {\bold{g}}</code> with nondecreasing components to the data vector 
<code class="reqn">{\bold{y}}</code> such that 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^n (y_i - \widehat g_i)^2 </code>
</p>

<p>is minimal (pool - adjacent - violators algorithm). In case a weight vector with positive entries (and the same size as <code class="reqn">{\bold{y}}</code>) is provided, the function produces an isotonic vector minimizing 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^n w_i(y_i - \widehat g_i)^2 .</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">isoMean(y, w)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector <code class="reqn">(y_1, \ldots, y_n)</code> of data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Arbitrary vector <code class="reqn">(w_1, \ldots, w_n)</code> of weights.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns vector <code class="reqn">\widehat {\bold{g}}</code>.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Lutz Duembgen, <a href="mailto:duembgen@stat.unibe.ch">duembgen@stat.unibe.ch</a>, <br><a href="https://www.imsv.unibe.ch/about_us/staff/prof_dr_duembgen_lutz/index_eng.html">https://www.imsv.unibe.ch/about_us/staff/prof_dr_duembgen_lutz/index_eng.html</a></p>


<h3>Examples</h3>

<pre><code class="language-R">## simple regression model
n &lt;- 50
x &lt;- sort(runif(n, 0, 1))
y &lt;- x ^ 2 + rnorm(n, 0, 0.2)
s &lt;- seq(0, 1, by = 0.01)
plot(s, s ^ 2, col = 2, type = 'l', xlim = range(c(0, 1, x)), 
    ylim = range(c(0, 1 , y))); rug(x)

## plot pava result
lines(x, isoMean(y, rep(1 / n, n)), type = 's')
</code></pre>


</div>