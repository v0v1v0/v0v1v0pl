<div class="container">

<table style="width: 100%;"><tr>
<td>MLE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Unconstrained piecewise linear MLE</h2>

<h3>Description</h3>

<p>Given a vector of observations <code class="reqn">{\bold{x}} = (x_1, \ldots, x_m)</code> with pairwise distinct entries and
a vector of weights <code class="reqn">{\bold{w}}=(w_1, \ldots, w_m)</code> s.t. <code class="reqn">\sum_{i=1}^m w_i = 1</code>, this function computes a function <code class="reqn">\widehat \phi_{MLE}</code> (represented by the vector <code class="reqn">(\widehat \phi_{MLE}(x_i))_{i=1}^m</code>) supported by <code class="reqn">[x_1, x_m]</code> such that 
</p>
<p style="text-align: center;"><code class="reqn">L(\phi) = \sum_{i=1}^m w_i \phi(x_i) - \sum_{j=1}^{m-1} (x_{j+1} - x_j) J(\phi_j, \phi_{j+1})</code>
</p>

<p>is maximal over all continuous, piecewise linear functions with knots in <code class="reqn">\{x_1, \ldots, x_m\}</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">MLE(x, w = NA, phi_o = NA, prec = 1e-7, print = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of independent and identically distributed numbers, with strictly increasing entries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Optional vector of nonnegative weights corresponding to <code class="reqn">{\bold{x}_m}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi_o</code></td>
<td>
<p>Optional starting vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>Threshold for the directional derivative during the Newton-Raphson procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>print = TRUE outputs log-likelihood in every loop, print = FALSE does not. Make sure to tell R to output (press CTRL+W).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Resulting column vector <code class="reqn">(\widehat \phi_{MLE}(x_i))_{i=1}^m.</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Value <code class="reqn">L(\widehat \phi_{MLE})</code> of the log-likelihood at <code class="reqn">\widehat \phi_{MLE}.</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fhat</code></td>
<td>
<p>Vector of the same length as <code class="reqn">{\bold{x}}</code> with entries <code class="reqn">\widehat F_{MLE,1} = 0</code> and 
</p>
<p style="text-align: center;"><code class="reqn">\widehat F_{MLE,k} = \sum_{j=1}^{k-1} (x_{j+1} - x_j) J(\phi_j, \phi_{j+1}) </code>
</p>

<p>for <code class="reqn">k \ge 2.</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is not intended to be invoked by the end user.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Lutz Duembgen, <a href="mailto:duembgen@stat.unibe.ch">duembgen@stat.unibe.ch</a>, <br><a href="https://www.imsv.unibe.ch/about_us/staff/prof_dr_duembgen_lutz/index_eng.html">https://www.imsv.unibe.ch/about_us/staff/prof_dr_duembgen_lutz/index_eng.html</a></p>


</div>