<div class="container">

<table style="width: 100%;"><tr>
<td>SKD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Skew Family Distributions
</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for a Skew Family Distribution useful for quantile regression. This family of distribution includes skewed versions of the Normal, Student's t, Laplace, Slash and Contaminated Normal distribution, all with location parameter equal to <code>mu</code>, scale parameter <code>sigma</code> and skewness parameter <code>p</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dSKD(y, mu = 0, sigma = 1, p = 0.5, dist = "normal", nu = "", gamma = "")
pSKD(q, mu = 0, sigma = 1, p = 0.5, dist = "normal", nu = "", gamma = "",
lower.tail = TRUE)
qSKD(prob, mu = 0, sigma = 1, p = 0.5, dist = "normal", nu = "", gamma = "",
lower.tail = TRUE)
rSKD(n, mu = 0, sigma = 1, p = 0.5, dist = "normal", nu = "", gamma = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y,q</code></td>
<td>

<p>vector of quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>

<p>vector of probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>location parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>scale parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>skewness parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>

<p>represents the distribution to be used for the error term. The values are <code>normal</code> for Normal distribution, <code>t</code> for Student's t distribution, <code>laplace</code> for Laplace distribution, <code>slash</code> for Slash distribution and <code>cont</code> for the Contaminated normal distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>It represents the degrees of freedom when <code>dist = t</code>. For the Slash distribution (<code>dist = slash</code>) it is a shape parameter <code class="reqn">\nu&gt;0</code>. For the Contaminated Normal distribution, <code class="reqn">\nu</code> is the parameter that represents the percentage of outliers. When is not provided, we use the MLE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>It represents a scale factor for the contaminated normal distribution. When is not provided, we use the MLE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X <code class="reqn">\le</code> x] otherwise, P[X &gt; x].
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>mu</code>, <code>sigma</code>, <code>p</code> or <code>dist</code> are not specified they assume the default values of 0, 1, 0.5 and <code>normal</code>, respectively, belonging to the Symmetric Standard Normal Distribution denoted by <code class="reqn">SKN(0,1,0.5)</code>.
</p>
<p>The scale parameter <code>sigma</code> must be positive and non zero. The skew parameter <code>p</code> must be between zero and one (0&lt;<code>p</code>&lt;1).
</p>
<p>This family of distributions generalize the skew distributions in Wichitaksorn et.al. (2014) as an scale mixture of skew normal distribution. Also the Three-Parameter Asymmetric Laplace Distribution defined in Koenker and Machado (1999) is a special case.
</p>


<h3>Value</h3>

<p><code>dSKD</code> gives the density, <code>pSKD</code> gives the distribution function, <code>qSKD</code> gives the quantile function, and <code>rSKD</code> generates a random sample.
</p>
<p>The length of the result is determined by n for <code>rSKD</code>, and is the maximum of the lengths of the numerical arguments for the other functions <code>dSKD</code>, <code>pSKD</code> and <code>qSKD</code>.
</p>


<h3>Note</h3>

<p>The numerical arguments other than <code>n</code> are recycled to the length of the result. 
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;, Luis Benites &lt;<a href="mailto:lsanchez@ime.usp.br">lsanchez@ime.usp.br</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C., Lachos, V. H., Cabral, C. R. B., &amp; Castro, C. L. (2017). Robust quantile regression using a generalized class of skewed distributions. Stat,
6(1), 113-130.
</p>
<p>Wichitaksorn, N., Choy, S. T., &amp; Gerlach, R. (2014). A generalized class of skew distributions and associated robust quantile regression models. Canadian Journal of Statistics, 42(4), 579-596.
</p>


<h3>See Also</h3>

<p><code>lqr</code>,<code>ais</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Let's plot (Normal Vs. Student-t's with 4 df)
##Density
sseq = seq(15,65,length.out = 1000)
dens = dSKD(y=sseq,mu=50,sigma=3,p=0.75)
plot(sseq,dens,type="l",lwd=2,col="red",xlab="x",ylab="f(x)", main="Normal Vs. t(4) densities")
dens2 = dSKD(y=sseq,mu=50,sigma=3,p=0.75,dist="t",nu=4)
lines(sseq,dens2,type="l",lwd=2,col="blue",lty=2)

## Distribution Function
df = pSKD(q=sseq,mu=50,sigma=3,p=0.75,dist = "laplace")
plot(sseq,df,type="l",lwd=2,col="blue",xlab="x",ylab="F(x)", main="Laplace Distribution function")
abline(h=1,lty=2)

##Inverse Distribution Function
prob = seq(0.001,0.999,length.out = 1000)
idf = qSKD(prob=prob,mu=50,sigma=3,p=0.25,dist="cont",nu=0.3,gamma=0.1) # 1 min appox
plot(prob,idf,type="l",lwd=2,col="gray30",xlab="x",ylab=expression(F^{-1}~(x)))
title(main="Skew Cont. Normal Inverse Distribution function")
abline(v=c(0,1),lty=2)

#Random Sample Histogram
sample = rSKD(n=20000,mu=50,sigma=3,p=0.2,dist="slash",nu=3)
seqq2 = seq(25,100,length.out = 1000)
dens3 = dSKD(y=seqq2,mu=50,sigma=3,p=0.2,dist="slash",nu=3)
hist(sample,breaks = 70,freq = FALSE,ylim=c(0,1.05*max(dens3,na.rm = TRUE)),main="")
title(main="Histogram and True density")
lines(seqq2,dens3,col="blue",lwd=2)

</code></pre>


</div>