<div class="container">

<table style="width: 100%;"><tr>
<td>lunar.phase</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lunar Phase</h2>

<h3>Description</h3>

<p>Returns the lunar phase on specified dates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lunar.phase(x, shift = 0, ..., name = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of <code>Date</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>The number of hours by which to shift the calculation of lunar phase.
By default lunar phase is calculated at 12 noon UT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other optional arguments are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Optional parameter indicating whether the return is a factor variable
By default lunar phase is returned in radians.
If assigned the value 8, it returns a factor variable with
8 phase levels.
If <code>TRUE</code> or any value other than 0 or 8,
it returns a factor variable with 4 phase labels.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Adapted from function 
<code>moon.illumination</code> in from the
R4MFCL project (not an R package), which was developed
by the Secretariat of the Pacific Community (SPC).
The R4MFCL project was led by Simon Hoyle, and also includes code
by Shelton Harley, Nick Davies, and Adam Langley of the SPC,
and Pierre Kleiber of the US National Marine Fisheries Service.
Pierre Kleiber is the author of the
<code>moon.illumination</code> function.
</p>
<p>Code from project R4MFCL is distributed under the MIT License:
</p>
<p><a href="https://opensource.org/licenses/mit-license.php">https://opensource.org/licenses/mit-license.php</a>
</p>
<p>Here is a link to the R4MFCL project:
</p>
<p><a href="https://code.google.com/archive/p/r4mfcl/">https://code.google.com/archive/p/r4mfcl/</a>
</p>
<p>The R4MFCL code was modified as follows:
</p>

<ul>
<li>
<p> Changed function name from <code>moonphase</code> to <code>lunar.phase</code>.
</p>
</li>
<li>
<p> Changed input date to be in <code>Date</code> format
(as opposed to <code>POSIXct</code>).
</p>
</li>
<li>
<p> Removed reliance on other R4MFCL functions.
</p>
</li>
<li>
<p> Changed name of primary input from <code>ptime</code> to <code>x</code>.
</p>
</li>
<li>
<p> Added optional <code>shift</code> term (in hours) relative to 12h UT.
</p>
</li>
<li>
<p> Added optional <code>name</code> term to control whether phase names
as opposed to radians should be returned.
</p>
</li>
<li>
<p> Changed the documentation.
</p>
</li>
</ul>
<p>Where radians are returned:
</p>

<ul>
<li>
<p> 0 refers to the new moon
</p>
</li>
<li> <p><code class="reqn">\pi/2</code> refers to the first quarter
</p>
</li>
<li> <p><code class="reqn">\pi</code> refers to the full moon
</p>
</li>
<li> <p><code class="reqn">3\pi/2</code> refers to the last quarter
</p>
</li>
</ul>
<p>Adapted originally from Stephen R. Schmitt: Sky &amp; Telescope,
Astronomical Computing, April 1994 and
<a href="https://web.archive.org/web/20140716104947/http://mysite.verizon.net/res148h4j/zenosamples/zs_lunarphasecalc.html">https://web.archive.org/web/20140716104947/http://mysite.verizon.net/res148h4j/zenosamples/zs_lunarphasecalc.html</a>,
which references
Jean Meeus, Astronomical Algorithms. Willmann-Bell, Inc. (1991) 429p.
</p>


<h3>See Also</h3>

<p><code>lunar.4phases</code>
</p>
<p><code>lunar.8phases</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">lunar.phase(as.Date("2013-05-06"))
</code></pre>


</div>