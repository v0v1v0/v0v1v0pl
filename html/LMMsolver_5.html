<div class="container">

<table style="width: 100%;"><tr>
<td>calcStandardErrors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Standard errors for predictions</h2>

<h3>Description</h3>

<p>Calculates the standard errors for predictions <code class="reqn">D \hat{u}</code>,
see Welham et al. 2004 and Gilmour et al. 2004 for details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcStandardErrors(C, D)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>a symmetric matrix of class spam</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>a matrix of class spam</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The prediction error variance is given by <code class="reqn">D C^{-1} D'</code>,
where <code class="reqn">C</code> is the mixed model coefficient matrix, and <code class="reqn">D</code> defines
linear combinations of fixed and random effects.
The standard errors are given by the the square root of
the diagonal. To calculate the standard errors in an efficient way we use that
</p>
<p style="text-align: center;"><code class="reqn">\frac{\partial log|C + \xi_i d_i d_i'|}{\partial \xi_i} |_{\xi_i=0}
 = trace(C^{-1} d_i d_i') =
trace(d_i' C^{-1} d_i) = d_i' C^{-1} d_i, </code>
</p>

<p>where <code class="reqn">d_i</code> is row <code class="reqn">i</code> of matrix <code class="reqn">D</code>. The values of
<code class="reqn">d_i' C^{-1} d_i</code> can be calculated more efficient, avoiding the
calculation of the inverse of <code class="reqn">C</code>, by using Automated Differentiation
of the Choleksy algorithm, see section 2.3 in Smith (1995) for details.
</p>


<h3>Value</h3>

<p>a vector with standard errors for predictions <code class="reqn">D \hat{u}</code>.
</p>


<h3>References</h3>

<p>Welham, S., Cullis, B., Gogel, B., Gilmour, A., &amp; Thompson, R. (2004).
Prediction in linear mixed models.
Australian &amp; New Zealand Journal of Statistics, 46(3), 325-347.
</p>
<p>Smith, S. P. (1995). Differentiation of the Cholesky algorithm.
Journal of Computational and Graphical Statistics, 4(2), 134-147.
</p>
<p>Gilmour, A., Cullis, B., Welham, S., Gogel, B., &amp; Thompson, R. (2004).
An efficient computing strategy for prediction in mixed linear models.
Computational statistics &amp; data analysis, 44(4), 571-586.
</p>


</div>