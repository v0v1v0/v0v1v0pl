<div class="container">

<table style="width: 100%;"><tr>
<td>fit_litter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit different models to single cohort decomposition data</h2>

<h3>Description</h3>

<p>Non-linear fits of different models to the decomposition trajectory
of one cohort (as in typical litterbag studies) data.
Models range from very simple (and easy to fit with limited data)
to more complex.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_litter(
  time,
  mass.remaining,
  model = c("neg.exp", "weibull", "discrete.parallel", "discrete.series", "cont.quality",
    "neg.exp.limit"),
  iters = 500,
  upper = NULL,
  lower = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>time since decomposition began, that is, ti-t0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass.remaining</code></td>
<td>
<p>proportional mass loss, that is, mi/m0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>there are five models currently implemented (see below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>Number of random starts for the fitting.  Use higher numbers for models with larger numbers of parameters and for models that inherently tend to be less identifiable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper, lower</code></td>
<td>
<p><b>Optional</b> user specified values for the upper and lower bounds used by
<code>optim</code> in the fitting procedure. Use with care, only minimal sanity checking is currently
implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>optim</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>the model likelihood is maximized using methods available in <code>optim</code>.  Optimization methods to be used within optim can be specified through the control object (i.e., control$method).  The default method is L-BFGS-B with bounds specific to each model. Each model 
</p>

<ul>
<li>
<p><b>weibull</b> The Weibull residence time model–two parameters (Frechet 1927)
</p>
</li>
<li>
<p><b>discrete.parallel</b> Two pools in parallel with a term for the fraction of initial mass in each pool–three parameter (Manzoni et al. 2012)
</p>
</li>
<li>
<p><b>discrete.series</b> A three parameter model in which there is the possibility of two sequential pools (Manzoni et al. 2012)
</p>
</li>
<li>
<p><b>cont.quality</b> (Ågren and Bosatta 1996, see also Manzoni et al. 2012)
</p>
</li>
</ul>
<p><em>Warning</em>: difficulty in finding the optimal solution is determined by an interaction between the nature and complexity of the 
likelihood space (which is both data- and model-dependent) as well as the optimization methods.  There is can never be a guarantee that the optimal solution is found, but using many random starting points will increase these odds.  It should be noted that there is significant variation among models in identifiability, with some models inherently less identifiable likely due to a tendency to form for flat ridges in likelihood space.  The confidence in the fit should be very low in these cases (see Cornwell and Weedon 2013).   A number of random starting points are used in optimization and are given through the iters.  The function checks whether the the top 10 optimizations have converged on the same likelihood, and if they have not this function will return a warning.
</p>


<h3>Value</h3>

<p>returns a litfit object with the following elements: 
</p>

<ul>
<li>
<p><b>optimFit:</b> a list generated by the <code>optim</code> function
</p>
</li>
<li>
<p><b>logLik:</b> the log-likelihood of the model
</p>
</li>
<li>
<p><b>time:</b> vector of time (same as input)
</p>
</li>
<li>
<p><b>mass:</b> vector os mass remaining (same as input)
</p>
</li>
<li>
<p><b>predicted:</b> predicted values from the model for each of the points within time
</p>
</li>
<li>
<p><b>model:</b> name of the model 
</p>
</li>
<li>
<p><b>nparams:</b> number of fit parameters in the model
</p>
</li>
<li>
<p><b>AIC:</b> AIC of the model fit
</p>
</li>
<li>
<p><b>AICc:</b> AICc of the model fit
</p>
</li>
<li>
<p><b>BIC:</b> BIC of the model fit
</p>
</li>
<li>
<p>and some other potentially useful things
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Will Cornwell and James Weedon
</p>


<h3>References</h3>

 <ul>
<li>
<p>Ågren, G. and Bosatta, E. (1996) Quality: a bridge between theory and experiment in soil organic matter studies. Oikos, 76, 522–528.
</p>
</li>
<li>
<p>Cornwell, W. K., and J. T. Weedon. (2013).  Decomposition trajectories of diverse litter types: a model selection analysis. Methods in Ecology and Evolution.
</p>
</li>
<li>
<p>Frechet, M. (1927) Sur la loi de probabilite de lecart maximum. Ann de la Soc polonaise de Math, 6, 93–116.
</p>
</li>
<li>
<p>Manzoni, S., Pineiro, G., Jackson, R. B., Jobbagy, E. G., Kim, J. H., &amp; Porporato, A. (2012). Analytical models of soil and litter decomposition: Solutions for mass loss and time-dependent decay rates. Soil Biology and Biochemistry, 50, 66-76.
</p>
</li>
<li>
<p>Olson, J.S. (1963) Energy storage and the balance of producers and decomposers in ecological systems. Ecology, 44, 322–331.</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>optim</code>,
<code>steady_state</code>,
<code>plot.litfit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(pineneedles)
fit&lt;-fit_litter(time=pineneedles$Year,mass.remaining=pineneedles$Mass.remaining,
model='neg.exp',iters=1000)
</code></pre>


</div>