<div class="container">

<table style="width: 100%;"><tr>
<td>plotLMER3d.fnc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dynamic 3d plot for <code>mer</code> object.</h2>

<h3>Description</h3>

<p>Plot dynamic 3d partial effects of a (generalized) linear mixed-effects model fit with <code>LMER</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">plotLMER3d.fnc(model = NULL, pred, intr, plot.type = "contour",
xlim = range(x, na.rm = TRUE), ylim = range(y, na.rm = TRUE), 
zlim = range(z, na.rm = TRUE), xlab = NULL, 
ylab = NULL, zlab = NULL, main = NULL, shift = 0, scale = 1, cex = 1, 
fun = NA, n = 30, color = "topo", theta = 0, phi = 0,
contourstepsize = 0.2, legend.args = NULL, rug = FALSE, 
plot.dat = "default", path = "default", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A <code>mer</code> object or <code>NULL</code> (the default) to plot from an existing data-plotting object returned by this function and saved as an <code>.rda</code> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>The quoted name of a model predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intr</code></td>
<td>
<p>The quoted name of a continuous model predicor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>
<p>The type of plot to make. Can be any of <code>"contour"</code> (default), or <code>"image.plot"</code> if package <code>fields</code> is available, <code>"persp"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim, zlim</code></td>
<td>
<p><em>x-</em>, <em>y-</em> and <em>z-</em>limits. The plot is produced so that the rectangular volume defined by these limits is visible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, zlab</code></td>
<td>
<p>Titles for the axes. N.B. These must be character strings; expressions are not accepted. Numbers will be coerced to character strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>The main title on top of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>Constant to add to the smooth (on the scale of the linear predictor) before plotting. Defaults to 0. Passed to <code>plotRaw3d.fnc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Constant by which to multiply the smooth before plotting. Defaults to 1. Passed to <code>plotRaw3d.fnc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>The size of label and main text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>A function to be applied for transforming the dependent variable, if <code>NA</code>, no transformation is applied; for models with <code>family = "binomial"</code>, fun is set to <code>plogis</code> by default; this can be disabled by setting <code>fun=function(x)return(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer denoting number of points for the plot, chosen at equally spaced intervals across the empirical range of the predictor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>The colour scheme to use for plots. One of <code>topo</code>, <code>heat</code>, <code>cm</code>, <code>terrain</code>, <code>gray</code> or <code>bw</code>.  Schemes <code>gray</code>, <code>grey</code>, and <code>bw</code> also modify the colors used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Angle defining the viewing direction. <code>theta</code> gives the azimuthal direction. Used only if <code>plot.type = "persp"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Angle defining the viewing direction. <code>phi</code> gives the colatitude. Used only if <code>plot.type = "persp"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contourstepsize</code></td>
<td>
<p>The size of the steps from contour line to contour line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.args</code></td>
<td>
<p>When <code>plot.type = "image.plot"</code>, arguments for a complete specification of the legend label. This is in the form of list and is just passed to the mtext function. (See example in <code>image.plot</code> help page). Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p>Whether a rug ought to be plotted on the 3d surface. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.dat, path</code></td>
<td>
<p>Whether to cache the plotting data generated by a previous call to <code>plotLMER3d.fnc</code>. Generating the 3d plots can be time consuming. If the <code>plot.dat</code> argument is non-FALSE, the plotting information generated in the first call to the function will be saved so that in a second call to the function with exactly the same argument values, the plotting information will be retrieved and plotting will be significantly quicker. If <code>plotting.data = "default"</code> and <code>path = "default"</code>, the plotting information will be saved in a temporary directory and the name of the file containing the information will equal to <code>paste("lmer___",model@call,pred,intr,".rda",sep="")</code>. The name of the file and the path where it will be saved can be set by the user in the <code>plot.dat</code> and <code>path</code> arguments. For example, <code>plot.dat = "my_plotting.data", path = "Documents"</code>. Note that <code>"lmer___"</code> will be appended to the begining of whatever is specified in <code>plot.dat</code> and <code>".rda"</code> to the end. Also note that if the user wants to save the plotting information returned by this function, the name of this object has to be <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>image</code>, <code>contour</code>, <code>image.plot</code>, <code>persp</code>, or <code>persp3d</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See help page to Harald Baayen's <code>plotLMER.fnc</code> function as well as to Duncan Murdoch's <code>persp3d</code> function and the help page to function <code>image.plot</code> from package <code>fields</code>. To save screenshots of "persp3d" plots (after plotting), use function <code>rgl.snapshot</code> (produces <code>png</code> files) or function <code>rgl.postscript</code> (produces <code>eps</code> files).</p>


<h3>Value</h3>

<p>Invisibly returns plotting information (<code>x</code> and <code>y</code> vectors, <code>z</code> matrix, and colors, <code>col</code>). If <code>plot.type = "contour"</code>, <code>plot.type = "image.plot"</code>, or <code>plot.type = "persp"</code>, a contour or perspective plot, respectively. If <code>ret = TRUE</code>, a two-element list is returned containing the <em>matrix</em> and the matrix of corresponding colors is returned. If argument <code>intel</code> in non-null, a file containing plotting information will be saved.</p>


<h3>Author(s)</h3>

<p>Antoine Tremblay, Statistics Canada, <a href="mailto:trea26@gmail.com">trea26@gmail.com</a>.</p>


<h3>See Also</h3>

<p><code>persp</code>;
<code>contour</code>;
<code>plotLMER.fnc</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(try(require(LCFdata,quietly=TRUE))){
	data(z)
	temp.dir &lt;- tempdir()
	save(z,file=file.path(temp.dir,"lmer___z.rda"))

  plotLMER3d.fnc(pred = "LengthBc", intr = "WMCc", 
    plot.dat = "z", path = temp.dir)
  plotLMER3d.fnc(pred = "LengthBc", intr = "WMCc",
    plot.type = "persp", phi = 25, plot.dat = "z", 
    path = temp.dir)
}
</code></pre>


</div>