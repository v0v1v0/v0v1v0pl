<div class="container">

<table style="width: 100%;"><tr>
<td>loglike_mvnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Log-Likelihood Value of a Multivariate Normal Distribution
</h2>

<h3>Description</h3>

<p>Computes log-likelihood value of a multivariate normal distribution
given the empirical mean vector and the empirical covariance matrix
as sufficient statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loglike_mvnorm(M, S, mu, Sigma, n, log=TRUE, lambda=0, ginv=FALSE, eps=1e-30,
       use_rcpp=FALSE )

loglike_mvnorm_NA_pattern( suff_stat, mu, Sigma, log=TRUE, lambda=0, ginv=FALSE,
       eps=1e-30, use_rcpp=FALSE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>Empirical mean vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>Empirical covariance matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>Population mean vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>

<p>Population covariance matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Sample size
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>

<p>Optional logical indicating whether the logarithm of the likelihood
should be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Regularization parameter of the covariance matrix (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ginv</code></td>
<td>
<p>Logical indicating whether generalized inverse matrix of
<code class="reqn">\bold{\Sigma}</code> should be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Threshold for determinant value of <code class="reqn">\bold{\Sigma}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_rcpp</code></td>
<td>
<p>Logical indicating whether <span class="pkg">Rcpp</span> function should be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suff_stat</code></td>
<td>
<p>List with sufficient statistics as generated by
<code>suff_stat_NA_pattern</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The population covariance matrix <code class="reqn">\bold{\Sigma}</code> is regularized if
<code class="reqn">\lambda</code> (<code>lambda</code>) is chosen larger than zero.
Let <code class="reqn">\bold{\Delta _\Sigma}</code> denote a diagonal matrix containing
the diagonal entries of <code class="reqn">\bold{\Sigma}</code>. Then, a regularized matrix
<code class="reqn">\bold{\Sigma}^\ast</code> is defined as
<code class="reqn">\bold{\Sigma}^\ast=w \bold{\Sigma} + (1-w)\bold{\Delta _\Sigma }</code>
with <code class="reqn">w=n/(n+\lambda)</code>.
</p>


<h3>Value</h3>

<p>Log-likelihood value
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Multivariate normal distribution
#############################################################################

library(MASS)

#--- simulate data
Sigma &lt;- c( 1, .55, .5, .55, 1, .5,.5, .5, 1 )
Sigma &lt;- matrix( Sigma, nrow=3, ncol=3 )
mu &lt;- c(0,1,1.2)
N &lt;- 400
set.seed(9875)
dat &lt;- MASS::mvrnorm( N, mu, Sigma )
colnames(dat) &lt;- paste0("Y",1:3)
S &lt;- stats::cov(dat)
M &lt;- colMeans(dat)

#--- evaulate likelihood
res1 &lt;- LAM::loglike_mvnorm( M=M, S=S, mu=mu, Sigma=Sigma, n=N, lambda=0 )
# compare log likelihood with somewhat regularized covariance matrix
res2 &lt;- LAM::loglike_mvnorm( M=M, S=S, mu=mu, Sigma=Sigma, n=N, lambda=1 )
print(res1)
print(res2)

## Not run: 

#############################################################################
# EXAMPLE 2: Multivariate normal distribution with missing data patterns
#############################################################################

library(STARTS)
data(data.starts01b, package="STARTS")
dat &lt;- data.starts01b
dat1 &lt;- dat[, paste0("E",1:3)]

#-- compute sufficient statistics
suff_stat &lt;- LAM::suff_stat_NA_pattern(dat1)
#-- define some population mean and covariance
mu &lt;- colMeans(dat1, na.rm=TRUE)
Sigma &lt;- stats::cov(dat1, use="pairwise.complete.obs")

#-- compute log-likelihood
LAM::loglike_mvnorm_NA_pattern( suff_stat=suff_stat, mu=mu, Sigma=Sigma)

## End(Not run)
</code></pre>


</div>