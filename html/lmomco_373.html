<div class="container">

<table style="width: 100%;"><tr>
<td>theoLmoms.max.ostat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Theoretical L-moments of a Distribution Distribution based on System of Maximum Order Statistic Expectations</h2>

<h3>Description</h3>

<p>This function computes the theoretical L-moments of a distribution by the following
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_r = (-1)^{r-1} \sum_{k=1}^r (-1)^{r-k}k^{-1}{r-1 \choose k-1}{r+k-2 \choose k-1}\mathrm{E}[X_{1:k}]
</code>
</p>

<p>for the minima  (<code>theoLmoms.min.ostat</code>, theoretical L-moments from the minima of order statistics) or
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_r = \sum_{k=1}^r (-1)^{r-k}k^{-1}{r-1 \choose k-1}{r+k-2 \choose k-1}\mathrm{E}[X_{k:k}]
</code>
</p>

<p>for the maxima (<code>theoLmoms.max.ostat</code>, theoretical L-moments from the maxima of order statistics). The functions <code>expect.min.ostat</code> and <code>expect.max.ostat</code> compute the minima (<code class="reqn">\mathrm{E}[X_{1:k}]</code>) and maxima (<code class="reqn">\mathrm{E}[X_{k:k}]</code>), respectively.
</p>
<p>If <code>qua != NULL</code>, then the first expectation equation shown under <code>expect.max.ostat</code> is used for the order statistic expectations and any function set in <code>cdf</code> and <code>pdf</code> is ignored.
</p>


<h3>Usage</h3>

<pre><code class="language-R">theoLmoms.max.ostat(para=NULL, cdf=NULL, pdf=NULL, qua=NULL,
                    nmom=4, switch2minostat=FALSE, showterms=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>A distribution parameter list from a function such as <code>lmom2par</code> or <code>vec2par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdf</code></td>
<td>
<p>CDF of the distribution for the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf</code></td>
<td>
<p>PDF of the distribution for the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qua</code></td>
<td>
<p>Quantile function for the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmom</code></td>
<td>
<p>The number of L-moments to compute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>switch2minostat</code></td>
<td>
<p>A logical in which a switch to the expectations of minimum order statistics will be used and <code>expect.min.ostat</code> instead of <code>expect.max.ostat</code> will be used with expected small change in overall numerics. The function <br><code>theoLmoms.min.ostat</code> provides a direct interface for L-moment computation by minimum order statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showterms</code></td>
<td>
<p>A logical controlling just a reference message that will show the multipliers on each of the order statistic minima or maxima that comprise the terms within the summations in the above formulae (see Asquith, 2011, p. 95).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional, but likely, arguments to pass to <code>expect.min.ostat</code> or <br><code>expect.max.ostat</code>. Such arguments will likely tailor the integration limits that can be specific for the distribution in question. Further these arguments might be needed for the cumulative distribution function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lambdas</code></td>
<td>
<p>Vector of the L-moments: first element is
<code class="reqn">\lambda_1</code>, second element is <code class="reqn">\lambda_2</code>, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratios</code></td>
<td>
<p>Vector of the L-moment ratios. Second element is
<code class="reqn">\tau</code>, third element is <code class="reqn">\tau_3</code> and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Level of symmetrical trimming used in the computation, which will equal <code>NULL</code> until trimming support is made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leftrim</code></td>
<td>
<p>Level of left-tail trimming used in the computation, which will equal <code>NULL</code> until trimming support is made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rightrim</code></td>
<td>
<p>Level of right-tail trimming used in the computation, which will equal <code>NULL</code> until trimming support is made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>An attribute identifying the computational source of the L-moments: “theoLmoms.max.ostat”.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Perhaps one of the neater capabilities that the <code>theoLmoms.max.ostat</code> and <code>theoLmoms.min.ostat</code> functions provide is for computing L-moments that are not analytically available from other authors or have no analytical solution.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Asquith, W.H., 2011, Distributional analysis with L-moment statistics using the R environment for statistical computing: Createspace Independent Publishing Platform, ISBN 978–146350841–8.
</p>


<h3>See Also</h3>

<p><code>theoLmoms</code>, <code>expect.min.ostat</code>, <code>expect.max.ostat</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
para &lt;- vec2par(c(40,20), type='nor')
A1 &lt;- theoLmoms.max.ostat(para=para, cdf=cdfnor, pdf=pdfnor, switch2minostat=FALSE)
A2 &lt;- theoLmoms.max.ostat(para=para, cdf=cdfnor, pdf=pdfnor, switch2minostat=TRUE)
B1 &lt;- theoLmoms.max.ostat(para=para, qua=quanor, switch2minostat=FALSE)
B2 &lt;- theoLmoms.max.ostat(para=para, qua=quanor, switch2minostat=TRUE)
print(A1$ratios[4]) # reports 0.1226017
print(A2$ratios[4]) # reports 0.1226017
print(B1$ratios[4]) # reports 0.1226012
print(B2$ratios[4]) # reports 0.1226012
# Theoretical value = 0.122601719540891.
# Confirm operational with native R-code being used inside lmomco functions
# Symmetrically correct on whether minima or maxima are used, but some
# Slight change when qnorm() used instead of dnorm() and pnorm().

para &lt;- vec2par(c(40,20), type='exp')
A1 &lt;- theoLmoms.max.ostat(para=para, cdf=cdfexp, pdf=pdfexp, switch2minostat=FALSE)
A2 &lt;- theoLmoms.max.ostat(para=para, cdf=cdfexp, pdf=pdfexp, switch2minostat=TRUE)
B1 &lt;- theoLmoms.max.ostat(para=para, qua=quaexp, switch2minostat=FALSE)
B2 &lt;- theoLmoms.max.ostat(para=para, qua=quaexp, switch2minostat=TRUE)
print(A1$ratios[4]) # 0.1666089
print(A2$ratios[4]) # 0.1666209
print(B1$ratios[4]) # 0.1666667
print(B2$ratios[4]) # 0.1666646
# Theoretical value = 0.1666667

para &lt;- vec2par(c(40,20), type='ray')
A1 &lt;- theoLmoms.max.ostat(para=para, cdf=cdfray, pdf=pdfray, switch2minostat=FALSE)
A2 &lt;- theoLmoms.max.ostat(para=para, cdf=cdfray, pdf=pdfray, switch2minostat=TRUE)
B1 &lt;- theoLmoms.max.ostat(para=para, qua=quaray, switch2minostat=FALSE)
B2 &lt;- theoLmoms.max.ostat(para=para, qua=quaray, switch2minostat=TRUE)
print(A1$ratios[4]) # 0.1053695
print(A2$ratios[4]) # 0.1053695
print(B1$ratios[4]) # 0.1053636
print(B2$ratios[4]) # 0.1053743
# Theoretical value = 0.1053695

## End(Not run)
## Not run: 
# The Rice distribution is complex and tailoring of the integration
# limits is needed to effectively trap errors, the limits for the
# Normal distribution above are infinite so no granular control is needed.
para &lt;- vec2par(c(30,10), type="rice")
theoLmoms.max.ostat(para=para, cdf=cdfrice, pdf=pdfrice,
                    lower=0, upper=.Machine$double.max)

## End(Not run)
## Not run: 
para &lt;- vec2par(c(0.6, 1.5), type="emu")
theoLmoms.min.ostat(para, cdf=cdfemu, pdf=pdfemu,
                    lower=0, upper=.Machine$double.max)
theoLmoms.min.ostat(para, cdf=cdfemu, pdf=pdfemu, yacoubsintegral = FALSE,
                    lower=0, upper=.Machine$double.max)

para &lt;- vec2par(c(0.6, 1.5), type="kmu")
theoLmoms.min.ostat(para, cdf=cdfkmu, pdf=pdfkmu,
                    lower=0, upper=.Machine$double.max)
theoLmoms.min.ostat(para, cdf=cdfkmu, pdf=pdfkmu, marcumQ = FALSE,
                    lower=0, upper=.Machine$double.max)

## End(Not run)
## Not run: 
# The Normal distribution is used on the fly for the Rice for high to
# noise ratios (SNR=nu/alpha &gt; some threshold). This example will error out.
nu &lt;- 30; alpha &lt;- 0.5
para &lt;- vec2par(c(nu,alpha), type="rice")
theoLmoms.max.ostat(para=para, cdf=cdfrice, pdf=pdfrice,
                    lower=0, upper=.Machine$double.max)

## End(Not run)
</code></pre>


</div>