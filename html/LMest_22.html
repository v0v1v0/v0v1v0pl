<div class="container">

<table style="width: 100%;"><tr>
<td>draw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw simulated sample from a Generalized Latent Markov Model</h2>

<h3>Description</h3>

<p>Draw a sample for LMest objects of classes: <code>LMbasic</code>, <code>LMbasiccont</code>, <code>LMlatent</code>, <code>LMlatentcont</code>, and <code>LMmixed</code></p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'LMbasic'
draw(est, n = NULL, TT = NULL, format = c("long","matrices"), seed = NULL, ...)
## S3 method for class 'LMlatent'
draw(est, n = NULL, TT = NULL, data, index, format = c("long", "matrices"),
                        fort = TRUE, seed = NULL, ...)
## S3 method for class 'LMbasiccont'
draw(est, n = NULL, TT = NULL, format = c("long","matrices"), seed = NULL, ...)
## S3 method for class 'LMlatentcont'
draw(est, n = NULL , TT = NULL, data, index, format = c("long", "matrices"),
                            fort = TRUE, seed = NULL, ...)
## S3 method for class 'LMmixed'
draw(est, n = NULL, TT = NULL, format = c("long", "matrices"), seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>object of class <code>LMbasic</code> (<code>LMbasic-class</code>), <code>LMlatent</code> (<code>LMlatent-class</code>), class <code>LMbasiccont</code> (<code>LMbasiccont-class</code>),  <code>LMlatentcont</code> (<code>LMlatentcont-class</code>), or <code>LMmixed</code> (<code>LMmixed-class</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>character string indicating the format of final responses matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in long format, with rows corresponding to observations and columns corresponding to covariates, a column corresponding to time occasions and a column containing the unit identifier when est is of class <code>LMlatent</code> or <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>a character vector with two elements indicating the name of the "id" column as first element and the "time" column as second element when est is of class <code>LMlatent</code> or <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fort</code></td>
<td>
<p>to use fortran routine when possible (FALSE for not use fortran)  when est is of class <code>LMlatent</code> or <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TT</code></td>
<td>
<p>number of time occasions when est is of class <code>LMmixed</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>matrix of response configurations unit by unit when est is of class <code>LMbasic</code> or <code>LMmixed</code>; array of continuous outcomes (n x TT x r) when est is of class <code>LMbasiccont</code> or <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>matrix of distinct response configurations when est is of class <code>LMbasic</code> or <code>LMmixed</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yv</code></td>
<td>
<p>corresponding vector of frequencies when est is of class <code>LMbasic</code> or <code>LMmixed</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>piv</code></td>
<td>
<p>vector of initial probabilities of the latent Markov chain when est is of class <code>LMbasic</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi</code></td>
<td>
<p>set of transition probabilities matrices (k x k x TT) when est is of class <code>LMbasic</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>array of conditional response probabitlies (mb x k x r)when est is of class <code>LMbasic</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>object of class <code>LMbasic</code>, <code>LMlatent</code>, <code>LMbasiccont</code>, <code>LMlatentcont</code>, or <code>LMmixed</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>matrix containing the sequence of latent states (n x TT) when est is of class <code>LMlatent</code> or <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>array of conditional response probabilities (mb x k x r) when est is of class <code>LMlatent</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Be</code></td>
<td>
<p>parameters affecting the logit for the initial probabilities when est is of class <code>LMlatent</code> or <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ga</code></td>
<td>
<p>parametes affecting the logit for the transition probabilitieswhen est is of class <code>LMlatent</code> or <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latentFormula</code></td>
<td>
<p>a symbolic description of the model to be fitted when est is of class <code>LMlatent</code>. Detailed description is given in <code>lmest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in long format, with rows corresponding to observations and columns corresponding to variables, a column corresponding to time occasions and a column containing the unit identifier when est is of class <code>LMlatent</code> or <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu</code></td>
<td>
<p>array of conditional means for the response variables (r x k) when est is of class <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Si</code></td>
<td>
<p>var-cov matrix common to all states (r x r) when est is of class <code>LMlatentcont</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latentFormula</code></td>
<td>
<p>a symbolic description of the model to be fitted. A detailed description is given in <code>lmestCont</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, Fulvia Pennoni</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# draw a sample for 1000 units and only one response variable when est is of class LMbasic
n &lt;- 1000
TT &lt;- 6
k &lt;- 2
r &lt;- 1 #number of response variables
mb &lt;- 3 #maximum number of response categories

piv &lt;- c(0.7,0.3)
Pi &lt;- matrix(c(0.9,0.1,0.1,0.9), k, k)
Pi &lt;- array(Pi, c(k, k, TT))
Pi[,,1] &lt;- 0
Psi &lt;- matrix(c(0.7,0.2,0.1,0.5,0.4,0.1), mb, k)
Psi &lt;- array(Psi, c(mb, k, r))
est = list(piv=piv, Pi=Pi, Psi=Psi, n=n, TT=TT)
class(est) = "LMbasic"

out &lt;- draw(est)


data("data_SRHS_long")
SRHS &lt;- data_SRHS_long[1:2400,]

SRHS$srhs &lt;- 5 - SRHS$srhs

est &lt;- lmest(responsesFormula = srhs ~ NULL,
             index = c("id","t"),
             data = SRHS,
             k = 3)

out1 &lt;- draw(est = est, format = "matrices", seed = 4321, n = 100)

# draw a sample for 7074 units and only one response variable when est is of class LMlatent
data(data_SRHS_long)

data_SRHS_long$srhs &lt;- 5 - data_SRHS_long$srhs
n &lt;- length(unique(data_SRHS_long$id))
TT &lt;- max(data_SRHS_long$t)

est  &lt;- lmest(responsesFormula = srhs ~ NULL,
              latentFormula =  ~
              I(gender - 1) +
              I( 0 + (race == 2) + (race == 3)) +
              I(0 + (education == 4)) +
              I(0 + (education == 5)) +
              I(age - 50) + I((age-50)^2/100),
              index = c("id","t"),
              data = data_SRHS_long,
              k = 2,
              paramLatent = "multilogit",
              start = 0)

out &lt;- draw(est = est, data = data_SRHS_long, index = c("id","t"),
            format = "matrices",seed = 4321)

est1 = list(Psi = est$Psi, Be = est$Be, Ga = est$Ga,
            paramLatent = "multilogit",n=n,TT=TT)

attributes(est1)$latentFormula = ~
              I(gender - 1) +
              I( 0 + (race == 2) + (race == 3)) +
              I(0 + (education == 4)) +
              I(0 + (education == 5)) +
              I(age - 50) + I((age-50)^2/100)
class(est1) = "LMlatent"

out1 &lt;- draw(est = est1, data = data_SRHS_long, index = c("id","t"),
                     format = "matrices",
                     seed = 4321)

# draw a sample for 1000 units and 3 response variable when est is of class LMbasiccont
n &lt;- 1000
TT &lt;- 5
k &lt;- 2
r &lt;- 3 #number of response variables

piv &lt;- c(0.7,0.3)
Pi &lt;- matrix(c(0.9,0.1,0.1,0.9), k, k)
Pi &lt;- array(Pi, c(k, k, TT))
Pi[,,1] &lt;- 0
Mu &lt;- matrix(c(-2,-2,0,0,2,2), r, k)
Si &lt;- diag(r)
est = list(piv=piv,Pi=Pi,Mu=Mu,Si=Si,n=n,TT=TT)
class(est) = "LMbasiccont"

out &lt;- draw(est)

data(data_long_cont)

est &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                 index = c("id", "time"),
                 data = data_long_cont,
                 k = 3,
                 modBasic = 1,
                 tol = 10^-5)

out2 &lt;- draw(est = est, n = 100, format = "long", seed = 4321)

# draw a sample for 1000 units and 3 response variable when est is of class LMlatentcont
data(data_long_cont)

est &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3~ NULL,
                 latentFormula = ~ X1 + X2,
                 index = c("id", "time"),
                 data = data_long_cont,
                 k = 3)
out &lt;- draw(est = est, data = data_long_cont, index = c("id", "time"), format = "matrices", 
            seed = 4321)

est1 &lt;- list(Mu = est$Mu,Si = est$Si,Be = est$Be,Ga = est$Ga,paramLatent="multilogit",n=est$n,
             TT=est$TT)
attributes(est1)$latentFormula = ~ X1 + X2
class(est1) = "LMlatentcont"
out1 &lt;- draw(est = est1, data = data_long_cont,
                         index = c("id", "time"),
                         fort=TRUE, seed = 4321, format = "matrices")

## End(Not run)

# draw a sample for 1000 units and only one response variable and 5 time occasions 
# when est if of class LMmixed
k1 &lt;- 2
k2 &lt;- 3
la &lt;- rep(1/k1, k1)
Piv &lt;- matrix(1/k2, k2, k1)
Pi &lt;- array(0, c(k2, k2, k1))
Pi[,,1] &lt;- diag(k2)
Pi[,,2] &lt;- 1/k2
Psi &lt;- cbind(c(0.6,0.3,0.1), c(0.1,0.3,0.6), c(0.3,0.6,0.1))
est &lt;- list(la=la, Piv=Piv, Pi=Pi, Psi=Psi, n=1000,TT=5)
class(est) = "LMmixed"

out &lt;- draw(est = est)

## Not run: 
# Example based on criminal data when est if of class LMmixed
data(data_criminal_sim)
data_criminal_sim = data.frame(data_criminal_sim)

# Estimate mixed LM model for females
responsesFormula &lt;- lmestFormula(data = data_criminal_sim,
                                  response = "y")$responsesFormula
est &lt;- lmestMixed(responsesFormula = responsesFormula,
                  index = c("id","time"),
                  k1 = 2,
                  k2 = 2,
                  data = data_criminal_sim[data_criminal_sim$sex == 2,])

out &lt;- draw(est = est, n = 100, TT = 6, seed = 4321)

## End(Not run)

</code></pre>


</div>