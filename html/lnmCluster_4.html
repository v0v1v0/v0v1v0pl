<div class="container">

<table style="width: 100%;"><tr>
<td>lnmbiclust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Logistic Normal Multinomial Biclustering algorithm</h2>

<h3>Description</h3>

<p>Main function that can do LNM biclustering and select the best model based on BIC, AIC or ICL.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lnmbiclust(W_count, range_G, range_Q, model, criteria, iter, permutation, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>W_count</code></td>
<td>
<p>The microbiome count matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_G</code></td>
<td>
<p>All possible number of components. A vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_Q</code></td>
<td>
<p>All possible number of bicluster for each component. A vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The covaraince structure you choose, there are 16 different models belongs to
this family:UUU, UUG, UUD, UUC, UGU, UGG, UGD, UGC, GUU, GUG, GUD, GUC, GGU, GGG, GGD, GGC. You can
choose more than 1 covarance structure to do model selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>one of AIC, BIC or ICL. The best model is depends on the criteria you choose. The default is BIC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Max iterations, defaul is 150.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutation</code></td>
<td>
<p>Only has effect when model contains UUU, UUG, UUD or UUC. If TRUE,
it assume the number of biclusters could be different for different components. If FALSE,
it assume the number of biclusters are the same cross all components. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The regression covariate matrix, which is generated by model.matrix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>z_ig Estimated latent variable z
</p>
<p>cluster Component labels
</p>
<p>mu_g Estimated component mean
</p>
<p>pi_g Estimated component proportion
</p>
<p>B_g Estimated bicluster membership
</p>
<p>T_g Estimated covariance of latent variable u
</p>
<p>D_g Estimated error covariance
</p>
<p>COV Estimated sparsity component covariance
</p>
<p>beta_g Estimated covariate coefficients
</p>
<p>sigma Estimated original component covariance
</p>
<p>overall_loglik Complete log likelihood value for each iteration
</p>
<p>ICL ICL value
</p>
<p>BIC BIC value
</p>
<p>AIC AIC value
</p>
<p>all_fitted_model display all names of fitted models in a data.frame.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#generate toy data with n=100, K=5,
#set up parameters
n&lt;-100
p&lt;-5
mu1&lt;-c(-2.8,-1.3,-1.6,-3.9,-2.6)
B1&lt;-matrix(c(1,0,1,0,1,0,0,1,0,1),nrow = p, byrow=TRUE)
T1&lt;-diag(c(2.9,0.5))
D1&lt;-diag(c(0.52, 1.53, 0.56, 0.19, 1.32))
cov1&lt;-B1%*%T1%*%t(B1)+D1
mu2&lt;-c(1.5,-2.7,-1.1,-0.4,-1.4)
B2&lt;-matrix(c(1,0,1,0,0,1,0,1,0,1),nrow = p, byrow=TRUE)
T2&lt;-diag(c(0.2,0.003))
D2&lt;-diag(c(0.01, 0.62, 0.45, 0.01, 0.37))
cov2&lt;-B2%*%T2%*%t(B2)+D2

#generate normal distribution
library(mvtnorm)
simp&lt;-rmultinom(n,1,c(0.6,0.4))
lab&lt;-as.factor(apply(t(simp),1,which.max))
df&lt;-matrix(0,nrow=n,ncol=p)
for (i in 1:n) {
 if(lab[i]==1){df[i,]&lt;-rmvnorm(1,mu1,sigma = cov1)}
 else if(lab[i]==2){df[i,]&lt;-rmvnorm(1,mu2,sigma = cov2)}
}
#apply inverse of additive log ratio and transform normal to count data
f_df&lt;-cbind(df,0)
z&lt;-exp(f_df)/rowSums(exp(f_df))
W_count&lt;-matrix(0,nrow=n,ncol=p+1)
for (i in 1:n) {
 W_count[i,]&lt;-rmultinom(1,runif(1,10000,20000),z[i,])
}

#'#if run one model let range_Q be an integer
res&lt;-lnmbiclust(W_count,2,2,model="UUU")

#following will run 2 combinations of Q: 2 2, and 3 3 with G=2.
res&lt;-lnmbiclust(W_count,2,range_Q=c(2:3),model="UUU")

#if run model selection let range_Q and range_G be a vector.
#model selection for all 16 models with G=1 to 3, Q=1 to 3.
res&lt;-lnmbiclust(W_count,c(1:3),c(1:3))





</code></pre>


</div>