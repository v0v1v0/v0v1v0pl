<div class="container">

<table style="width: 100%;"><tr>
<td>stocks_file</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build a Personal Investing Portfolio Report</h2>

<h3>Description</h3>

<p><code>stocks_file()</code> lets the user download his personal Excel with his
Portfolio's data, locally or from Dropbox.
</p>
<p><code>daily_stocks()</code> creates a dataframe with all relevant metrics and values,
for each ticker or symbol, for every day since inception.
</p>
<p><code>daily_portfolio()</code> creates a data.frame with all relevant
metrics and values, for the overall portfolio, for every day
since inception.
</p>
<p><code>stocks_obj()</code> lets the user create his portfolio's calculations and
plots for further study.
</p>
<p><code>stocks_report()</code> lets the user create his portfolio's full report with
plots and send it to an email with the HTML report attached
</p>


<h3>Usage</h3>

<pre><code class="language-R">stocks_file(
  file = NA,
  creds = NA,
  auto = TRUE,
  sheets = c("Portafolio", "Fondos", "Transacciones"),
  keep_old = TRUE,
  cache = TRUE,
  quiet = FALSE
)

daily_stocks(hist, trans, tickers = NA, window = "MAX", ...)

daily_portfolio(hist, trans, cash, cash_fix = 0, window = "MAX")

stocks_obj(
  data = stocks_file(),
  cash_fix = 0,
  tax = 30,
  sectors = FALSE,
  parg = FALSE,
  window = c("1M", "YTD", "1Y", "MAX"),
  cache = TRUE,
  quiet = FALSE
)

stocks_report(
  data = NA,
  keep_old = TRUE,
  dir = NA,
  mail = FALSE,
  attachment = TRUE,
  to = "laresbernardo@gmail.com",
  sectors = FALSE,
  keep = FALSE,
  creds = NA,
  cache = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Character. Import an Excel file, local or from URL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>creds</code></td>
<td>
<p>Character. Credential's user (see <code>get_creds()</code>) for
sending mail and Dropbox interaction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto</code></td>
<td>
<p>Boolean. Automatically use my local personal file? You might want
to set in into your .Renviron <code>LARES_PORTFOLIO=~/dir/to/your/file.xlsx</code> so you
can leave all other parameters as <code>NA</code> and use it every time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheets</code></td>
<td>
<p>Character Vector. Names of each sheet containing Portfolio summary,
Cash, and Transactions information. Please, keep the order of these tabs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_old</code></td>
<td>
<p>Boolean. Include sold tickers even though not currently in portfolio?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache</code></td>
<td>
<p>Boolean. Use daily cache if available?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Boolean. Keep quiet? If not, informative messages will be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist</code></td>
<td>
<p>Dataframe. Result from <code>stocks_hist()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>Dataframe. Result from <code>stocks_file()$transactions</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tickers</code></td>
<td>
<p>Dataframe. Result from <code>stocks_file()$portfolio</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>Character. Choose any of: "1W", "1M", "6M", "1Y", "YTD", "5Y", "MAX"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cash</code></td>
<td>
<p>Dataframe. Result from <code>stocks_file()$cash</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cash_fix</code></td>
<td>
<p>Numeric. If, for some reason, you need to fix your
cash amount for all reports, set the amount here</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Character. <code>stocks_obj()</code> output. If NA, automatic
parameters and <code>stocks_file()</code> defaults will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax</code></td>
<td>
<p>Numeric. How much [0-99] of your dividends are gone with taxes?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sectors</code></td>
<td>
<p>Boolean. Return sectors segmentation for ETFs?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parg</code></td>
<td>
<p>Boolean. Personal argument. Used to personalize stuff, in this
case, taxes changed from A to B in given date (hard-coded)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>Character. Directory for HTML report output. If set to NA,
current working directory will be used. If mail sent, file will be erased</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mail</code></td>
<td>
<p>Boolean. Do you want to send an email with the report attached?
If not, an HTML file will be created in dir</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attachment</code></td>
<td>
<p>Boolean. Create and add report as attachment if
<code>mail=TRUE</code>? If not, no report will be rendered and only tabulated
summaries will be included on email's body.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>Character. Email to send the report to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>Boolean. Keep HTML file when sent by email?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List with portfolio, transactions, and cash data.frames.
</p>
<p>data.frame. Processed at date and symbol level.
</p>
<p>data.frame. Processed at date and portfolio level.
</p>
<p>List. Aggregated results and plots.
</p>
<p>Invisible list. Aggregated results and plots.
</p>


<h3>See Also</h3>

<p>Other Investment: 
<code>etf_sector()</code>,
<code>splot_summary()</code>,
<code>stocks_quote()</code>
</p>
<p>Other Credentials: 
<code>db_download()</code>,
<code>db_upload()</code>,
<code>get_credentials()</code>,
<code>get_tweets()</code>,
<code>mail_send()</code>,
<code>queryDB()</code>,
<code>queryGA()</code>,
<code>slackSend()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load lares dummy portfolio XLSX
file &lt;- system.file("inst/docs", "dummyPortfolio.xlsx", package = "lares")
df &lt;- stocks_file(
  file = file,
  sheets = c("Portafolio", "Fondos", "Transacciones"),
  keep_old = FALSE
)

## End(Not run)
## Not run: 
list &lt;- stocks_obj()
stocks_report(list, dir = "~/Desktop")

## End(Not run)
</code></pre>


</div>