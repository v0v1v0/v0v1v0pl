<div class="container">

<table style="width: 100%;"><tr>
<td>Lsei</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Solves a linear inverse model using the least squares method.
</h2>

<h3>Description</h3>

<p>Solves a linear inverse model using the least squares method
</p>
<p>Input presented as:
</p>

<ul>
<li>
<p> matrices E, F, A, B, G, H (Lsei.double) or
</p>
</li>
<li>
<p> a list (Lsei.lim) or
</p>
</li>
<li>
<p> as a lim input file (Lsei.limfile)
</p>
</li>
</ul>
<p>Useful for solving overdetermined lims.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Lsei(...)
## S3 method for class 'double'
Lsei(...)
## S3 method for class 'lim'
Lsei(lim, exact = NULL, parsimonious = FALSE, ...)
## S3 method for class 'limfile'
Lsei(file, exact = NULL, parsimonious = FALSE, 
             verbose = TRUE, ...)
## S3 method for class 'character'
Lsei(...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lim </code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact </code></td>
<td>
<p>if not <code>NULL</code>, a vector containing the numbers of
the equations to be solved exactly; if <code>NULL</code>, all equations
are considered exact.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parsimonious </code></td>
<td>
<p>if <code>TRUE</code>, also minimises the sum of squared
unknowns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file </code></td>
<td>
<p>name of the inverse input file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose </code></td>
<td>
<p>if <code>TRUE</code>: when reading the file,
prints warnings and messages to the screen.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>
<p>other arguments passed to function
<code>lsei</code> from package<code>limSolve</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Solves the following inverse problem:
</p>
<p style="text-align: center;"><code class="reqn">\min(||AAx-BB||^2)</code>
</p>
<p>, the approximate equations subject to
</p>
<p style="text-align: center;"><code class="reqn">Ex=F</code>
</p>
<p>, the mass balances
</p>
<p style="text-align: center;"><code class="reqn">Gx&gt;=H</code>
</p>
<p>, the constraints.
</p>
<p>and where <code>E</code> and <code>F</code> make up the equations from <code>A</code>
and <code>B</code>, as specified by vector <code>exact</code>.
</p>
<p><code>AA</code> and <code>BB</code> are the equations from <code>A</code> and <code>B</code>,
NOT in vector <code>exact</code>.
</p>
<p>in case <code>exact</code> = <code>NULL</code>, there are no approximate equations.
</p>
<p>in case <code>parsimonious</code> = <code>TRUE</code>, then the sum of squared
unknowns is also minimised. This means that <code>AA</code> is
augmented with the unity matrix (of size Nunknowns) and <code>BB</code>
contains Nunknowns additional zeros.
</p>
<p>For overdetermined lim problems, for instance, the inverse equations
may be split up in the mass balance equations which have to be exactly met
and the other equations which have to be approximated.
</p>
<p>This is, it is assumed that the first *NComponents* equations, the mass
balances, should be met exactly and the call to the function is:
<code>Lsei(lim,exact = 1:lim$NComponents,...)</code>
</p>
<p>If the lim is underdetermined, an alternative is to use
<code>Ldei</code> instead.
</p>
<p>This will return the parsimonious solution.
</p>
<p>The results should be similar with <code>Lsei(...,parsimonious=TRUE)</code>.
</p>
<p>In theory both <code>Lsei.lim</code> and <code>Ldei</code> should return the same
value for underdetermined systems.
</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X </code></td>
<td>
<p>vector containing the solution of the least squares problem.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residualNorm </code></td>
<td>
<p>scalar, the sum of residuals of equalities and
violated inequalities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solutionNorm </code></td>
<td>
<p>scalar, the value of the minimised quadratic
function at the solution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IsError </code></td>
<td>
<p><code>TRUE</code> if an error occurred.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Error </code></td>
<td>
<p>error text.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>lsei.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>K. H. Haskell and R. J. Hanson, An algorithm for linear least
squares problems with equality and nonnegativity constraints,
Report SAND77-0552, Sandia Laboratories, June 1978.
</p>
<p>K. H. Haskell and R. J. Hanson, Selected algorithms for the linearly
constrained least squares problem - a users guide,
Report SAND78-1290, Sandia Laboratories,August 1979.
</p>
<p>K. H. Haskell and R. J. Hanson, An algorithm for linear least squares
problems with equality and nonnegativity constraints, Mathematical
Programming 21 (1981), pp. 98-118.
</p>
<p>R. J. Hanson and K. H. Haskell, Two algorithms for the linearly
constrained least squares problem, ACM Transactions on Mathematical
Software, September 1982.
</p>


<h3>See Also</h3>

<p><code>lsei</code>, the more general function from
package limSolve
</p>
<p><code>Linp</code>, to solve the linear inverse problem by
linear programming
</p>
<p><code>Ldei</code>, to solve the linear inverse problem by
least distance programming
</p>
<p>function <code>lsei</code> from package<code>limSolve</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  Lsei(LIMRigaAutumn, parsimonious = TRUE)
</code></pre>


</div>