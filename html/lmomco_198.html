<div class="container">

<table style="width: 100%;"><tr>
<td>lmomTLgld</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Trimmed L-moments of the Generalized Lambda Distribution</h2>

<h3>Description</h3>

<p>This function estimates the symmetrical trimmed L-moments (TL-moments) for <code class="reqn">t=1</code> of the Generalized Lambda distribution given the parameters (<code class="reqn">\xi</code>, <code class="reqn">\alpha</code>, <code class="reqn">\kappa</code>, and <code class="reqn">h</code>) from <code>parTLgld</code>. The TL-moments in terms of the parameters are complicated; however, there are analytical solutions. There are no simple expressions of the parameters in terms of the L-moments. The first four TL-moments (trim = 1) of the distribution are
</p>
<p style="text-align: center;"><code class="reqn">\lambda^{(1)}_1 = \xi + 6\alpha
                              \left(\frac{1}{(\kappa+3)(\kappa+2)} -
               \frac{1}{(h+3)(h+2)} \right) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda^{(1)}_2 = 6\alpha \left(\frac{\kappa}{(\kappa+4)(\kappa+3)(\kappa+2)} +
                                           \frac{h}{(h+4)(h+3)(h+2)}\right) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda^{(1)}_3 =  \frac{20\alpha}{3} \left(\frac{\kappa (\kappa - 1)}
                                                {(\kappa+5)(\kappa+4)(\kappa+3)(\kappa+2)} -
        \frac{h (h - 1)}
             {(h+5)(h+4)(h+3)(h+2)} \right) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda^{(1)}_4 = \frac{15\alpha}{2} \left(\frac{\kappa (\kappa - 2)(\kappa - 1)}
                                                {(\kappa+6)(\kappa+5)(\kappa+4)(\kappa+3)(\kappa+2)} +
        \frac{h (h - 2)(h - 1)}
             {(h+6)(h+5)(h+4)(h+3)(h+2)} \right) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda^{(1)}_5 = \frac{42\alpha}{5} \left(N1 - N2 \right) \mbox{,}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">N1 = \frac{\kappa (\kappa - 3)(\kappa - 2)(\kappa - 1) }
                {(\kappa+7)(\kappa+6)(\kappa+5)(\kappa+4)(\kappa+3)(\kappa+2)} \mbox{ and}</code>
</p>

<p style="text-align: center;"><code class="reqn">N2 = \frac{h (h - 3)(h - 2)(h - 1)}{(h+7)(h+6)(h+5)(h+4)(h+3)(h+2)} \mbox{.}</code>
</p>

<p>The TL-moment (<code class="reqn">t=1</code>) for <code class="reqn">\tau^{(1)}_3</code> is
</p>
<p style="text-align: center;"><code class="reqn">\tau^{(1)}_3 = \frac{10}{9} \left( \frac{\kappa(\kappa-1)(h+5)(h+4)(h+3)(h+2) -
                     h(h-1)(\kappa+5)(\kappa+4)(\kappa+3)(\kappa+2)}
      {(\kappa+5)(h+5) \times [\kappa(h+4)(h+3)(h+2) +
                                  h(\kappa+4)(\kappa+3)(\kappa+2)]
      } \right)
      \mbox{.}</code>
</p>

<p>The TL-moment (<code class="reqn">t=1</code>) for <code class="reqn">\tau^{(1)}_4</code> is
</p>
<p style="text-align: center;"><code class="reqn">N1 = \kappa(\kappa-2)(\kappa-1)(h+6)(h+5)(h+4)(h+3)(h+2) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">N2 = h(h-2)(h-1)(\kappa+6)(\kappa+5)(\kappa+4)(\kappa+3)(\kappa+2) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">D1 = (\kappa+6)(h+6)(\kappa+5)(h+5) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">D2 = [\kappa(h+4)(h+3)(h+2) + h(\kappa+4)(\kappa+3)(\kappa+2)] \mbox{, and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau^{(1)}_4 = \frac{5}{4} \left( \frac{N1 +  N2}{D1 \times D2} \right) \mbox{.}</code>
</p>

<p>Finally the TL-moment (<code class="reqn">t=1</code>) for <code class="reqn">\tau^{(1)}_5</code> is
</p>
<p style="text-align: center;"><code class="reqn">N1 = \kappa(\kappa-3)(\kappa-2)(\kappa-1)(h+7)(h+6)(h+5)(h+4)(h+3)(h+2) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">N2 = h(h-3)(h-2)(h-1)(\kappa+7)(\kappa+6)(\kappa+5)(\kappa+4)(\kappa+3)(\kappa+2) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">D1 = (\kappa+7)(h+7)(\kappa+6)(h+6)(\kappa+5)(h+5) \mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">D2 = [\kappa(h+4)(h+3)(h+2) + h(\kappa+4)(\kappa+3)(\kappa+2)] \mbox{, and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau^{(1)}_5 = \frac{7}{5} \left( \frac{N1 -  N2}{D1 \times D2} \right)\mbox{.}</code>
</p>

<p>By inspection the <code class="reqn">\tau_r</code> equations are not applicable for negative integer values <code class="reqn">k=\{-2, -3, -4, \dots \}</code> and <code class="reqn">h=\{-2, -3, -4, \dots \}</code> as division by zero will result. There are additional, but difficult to formulate, restrictions on the parameters both to define a valid Generalized Lambda distribution as well as valid L-moments. Verification of the parameters is conducted through <code>are.pargld.valid</code>, and verification of the L-moment validity is conducted through <code>are.lmom.valid</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmomTLgld(para, nmom=6, trim=1, leftrim=NULL, rightrim=NULL, tau34=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>The parameters of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmom</code></td>
<td>
<p>Number of L-moments to compute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Symmetrical trimming level set to unity as the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leftrim</code></td>
<td>
<p>Left trimming level, <code class="reqn">t_1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rightrim</code></td>
<td>
<p>Right trimming level, <code class="reqn">t_2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau34</code></td>
<td>
<p>A logical controlling the level of L-moments returned by the function. If true, then this function returns only <code class="reqn">\tau_3</code> and <code class="reqn">\tau_4</code>; this feature might be useful in certain research applications of the Generalized Lambda distribution associated with the multiple solutions possible for the distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The opening comments in the description pertain to single and symmetrical endpoint trimming, which has been extensively considered by Asquith (2007).  Deriviations backed by numerical proofing of variable arrangement in March 2011 led the the inclusion of the following generalization of the L-moments and TL-moments of the Generalized Lambda shown in Asquith (2011) that was squeezed in late ahead of the deadlines for that monograph.
</p>
<p style="text-align: center;"><code class="reqn">
\lambda^{(t_1,t_2)}_{r} = \alpha (r^{-1}) (r+t_1+t_2) \sum_{j=0}^{r-1} (-1)^{r}{r-1 \choose j}{r+t_1+t_2-1 \choose r+t_1-j-1} \times A\mbox{,}</code>
</p>

<p>where <code class="reqn">A</code> is
</p>
<p style="text-align: center;"><code class="reqn">A = \biggl(\frac{\Gamma(\kappa+r+t_1-j)\Gamma(t_2+j+1)}{\Gamma(\kappa+r+t_1+t_2+1)} - \frac{\Gamma(r+t_1-j)\Gamma(h+t_2+j+1)}{\Gamma(h+r+t_1+t_2+1)}\biggr)\mbox{,}</code>
</p>

<p>where for the special condition of <code class="reqn">r = 1</code>, the real mean is
</p>
<p style="text-align: center;"><code class="reqn">
\mathrm{mean} = \xi + \lambda^{(t_1,t_2)}_{1}\mbox{,}</code>
</p>

<p>but for <code class="reqn">r \ge 2</code> the <code class="reqn">\lambda^{(t_1,t_2)}</code> provides correct values.  So care is needed algorithmically also when <code class="reqn">\tau^{(t1, t2)}_2</code> is computed. Inspection of the <code class="reqn">\Gamma(\cdot)</code> arguments, which must be <code class="reqn"> &gt; 0</code>, shows that
</p>
<p style="text-align: center;"><code class="reqn">
\kappa &gt; -(1+t_1)</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">h &gt; -(1+t_2)
\mbox{.}</code>
</p>



<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lambdas</code></td>
<td>
<p>Vector of the TL-moments. First element is
<code class="reqn">\lambda^{(t_1,t_2)}_1</code>, second element is <code class="reqn">\lambda^{(t_1,t_2)}_2</code>, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratios</code></td>
<td>
<p>Vector of the TL-moment ratios. Second element is
<code class="reqn">\tau^{(1)}</code>, third element is <code class="reqn">\tau^{(1)}_3</code> and so on. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Trim level = left or right values if they are equal. The default for this function is <code>trim = 1</code> because the <code>lmomgld</code> provides for <code>trim = 0</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leftrim</code></td>
<td>
<p>Left trimming level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rightrim</code></td>
<td>
<p>Right trimming level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>An attribute identifying the computational source of the TL-moments: “lmomTLgld”.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>Source</h3>

<p>Derivations conducted by W.H. Asquith on February 18 and 19, 2006 and others in early March 2011.
</p>


<h3>References</h3>

<p>Asquith, W.H., 2007, L-moments and TL-moments of the generalized lambda distribution: Computational Statistics and Data Analysis, v. 51, no. 9, pp. 4484–4496.
</p>
<p>Asquith, W.H., 2011, Distributional analysis with L-moment statistics using the R environment for statistical computing: Createspace Independent Publishing Platform, ISBN 978–146350841–8.
</p>
<p>Elamir, E.A.H., and Seheult, A.H., 2003, Trimmed L-moments: Computational statistics and data analysis, v. 43, pp. 299–314.
</p>
<p>Karian, Z.A., and Dudewicz, E.J., 2000, Fitting statistical distributions—The generalized lambda distribution and generalized bootstrap methods: CRC Press, Boca Raton, FL, 438 p.
</p>


<h3>See Also</h3>

<p><code>lmomgld</code>, <code>parTLgld</code>, <code>pargld</code>, <code>cdfgld</code>, <code>quagld</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
lmomgld(vec2par(c(10,10,0.4,1.3), type='gld'))

PARgld &lt;- vec2par(c(15,12,1,.5), type="gld")
theoTLmoms(PARgld, leftrim=0, rightrim=0, nmom=6)
lmomTLgld(PARgld, leftrim=0, rightrim=0)

theoTLmoms(PARgld, trim=2, nmom=6)
lmomTLgld(PARgld, trim=2)

theoTLmoms(PARgld, trim=3, nmom=6)
lmomTLgld(PARgld, leftrim=3, rightrim=3)

theoTLmoms(PARgld, leftrim=10, rightrim=2, nmom=6)
lmomTLgld(PARgld, leftrim=10, rightrim=2)

## End(Not run)
</code></pre>


</div>