<div class="container">

<table style="width: 100%;"><tr>
<td>plot.lcc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diagnostic Plots of an <code>lcc</code> Object.</h2>

<h3>Description</h3>

<p>Diagnostic plots for conditional error and random
effects from the linear mixed-effects fit are obtained. Six plots
plots (selectable by 'which') are currently available: a plot of
residuals against fitted values, a plot of residuals against
time variable, a boxplot of residuals by subject,
a plot of observerd values against fitted values, a normal Q-Q plot
with simulation envelopes based on conditional error,  and a normal
Q-Q plot with simulation envelopes based on the random effects. By
default, all plots are provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lcc'
plot(x, which = c(1L:6L),
     caption = list("Residuals vs Fitted",
                    "Residuals vs Time",
                    "Residuals by Subject",
                    "Observed values vs Fitted values",
                    "Normal Q-Q Plot (Conditional residuals)",
                    "Normal Q-Q Plot (Random effects)"),
     sub.caption =  NULL,  main = NULL,
     panel = if(add.smooth) panel.smooth else points,
     add.smooth = TRUE, ask = TRUE,
     id.n = 3, labels.id = names(residuals(x)),
     label.pos = c(4, 2), cex.id = 0.75, cex.caption = 1,
     cex.oma.man = 1.25, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>lcc</code>,
representing a fitted longitudinal concordance correlation
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>if a subset of the plots is required, specify a subset
of the numbers from 1 to 6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>captions to appear above the plots. Vector or list of
valid graphics annotations is required. All captions can be
supressed using '""' or <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub.caption</code></td>
<td>
<p>common sub-title (at bottom). Default to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>The main title (on top) above the caption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>panel function. If <code>add.smooth = TRUE</code>,
<code>panel.smooth</code> is used rather than <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.smooth</code></td>
<td>
<p>logical indicating if smoother should be added to
most plots; see also <code>panel</code> above. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if <code>TRUE</code>, the default, the user is _ask_ed
before each plot, see <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.n</code></td>
<td>
<p>number of points to be labelled is the first three
plots, starting with the most extreme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels.id</code></td>
<td>
<p>vector of labels, from which the labels for extreme
points will be chosen. Default to <code>NULL</code> (uses observation
numbers).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.pos</code></td>
<td>
<p>positioning of labels, for the left half and right
half of the graph respectively, for plots 1-3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.id</code></td>
<td>
<p>magnification of point label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.caption</code></td>
<td>
<p>controls the size of <code>caption</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.oma.man</code></td>
<td>
<p>controls the size of the <code>sub.caption</code> only
if that is _above_ the figures when there is more than one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further graphical parameters from 'par'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Q-Q plot uses the normalized residuals. The
standardized residuals is pre-multiplied by the inverse
square-root factor of the estimated error correlation matrix while
the random effects is pre-multiplied by the inverse square root of
the estimated variances obtained from matrix G. The simulate
envelopes are obtained from package hnp (Moral et al.,  2018).
</p>
<p>Code partially adapted from <code>plot.lm</code>.
</p>


<h3>Value</h3>

<p>Return plots for conditional error and random effects from the linear mixed-effects
</p>


<h3>Author(s)</h3>

<p>Thiago de Paula Oliveira,
<a href="mailto:thiago.paula.oliveira@alumni.usp.br">thiago.paula.oliveira@alumni.usp.br</a>
</p>


<h3>See Also</h3>

<p><code>lccPlot</code>, <code>lcc</code>,
<code>mtext</code>, <code>text</code>, <code>plotmath</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Second degree polynomial model with random intercept, slope and
## quadratic term
fm1 &lt;- lcc(data = hue, subject = "Fruit", resp = "H_mean",
           method = "Method", time = "Time", qf = 2, qr = 2)
plot(fm1)
</code></pre>


</div>