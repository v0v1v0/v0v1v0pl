<div class="container">

<table style="width: 100%;"><tr>
<td>lm.diallel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting diallel linear models
</h2>

<h3>Description</h3>

<p>Wrapper function for lm.fit and diallel models. It can be used to carry out several powerful methods for linear models, such as 'summary()', anova() or 'glht()' in the 'multcomp' package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lm.diallel(formula, Block, Env, fct = "GRIFFING2", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>an object of class "formula" (or one that can be coerced to that class): a symbolic description of the model to be fitted.'formula' uses the regular R syntax to specify the response variable and the two variables for parentals <code>(e.g., Yield ~ Par1 + Par2)</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Block</code></td>
<td>
<p>used to specify an optional variable coding for blocks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Env</code></td>
<td>
<p>used to specify an optional variable coding for environments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fct</code></td>
<td>
<p>a string variable coding for the selected model. 8 main diallel models: Hayman's model 1 (="HAYMAN1"), Hayman's model 2 (="HAYMAN2"), Griffing's model 1 (="GRIFFING1"), Griffing's model 2 (="GRIFFING2"), Griffing's model 3 (="GRIFFING3"), Griffing's model 4 (="GRIFFING4"), Gardner-Eberhart model 2 (="GE2")  and Gardner-Eberhart model 3 (="GE3"). The strings "GE2r" and "GE3r" can be used to specify the 'enhanced' GE2 and GE3 models, including the effect of reciprocals (REC).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a 'data.frame' where to look for explanatory variables</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Notations for the 8 models
</p>

<table>
<tr>
<td style="text-align: left;">
Model name in 'lm.diallel()' </td>
<td style="text-align: left;"> 	Model notation in 'lm()' </td>
</tr>
<tr>
<td style="text-align: left;">
HAYMAN1 	</td>
<td style="text-align: left;"> Y ~ GCA(Par1, Par2) + tSCA(Par1, Par2) + RGCA(Par1, Par2) + RSCA(Par1, Par2) </td>
</tr>
<tr>
<td style="text-align: left;">
GRIFFING1	</td>
<td style="text-align: left;"> Y ~ GCA(Par1, Par2) + tSCA(Par1, Par2) + REC(Par1, Par2) </td>
</tr>
<tr>
<td style="text-align: left;">
GRIFFING2	</td>
<td style="text-align: left;"> Y ~ GCA(Par1, Par2) + tSCA(Par1, Par2) </td>
</tr>
<tr>
<td style="text-align: left;">
HAYMAN2	</td>
<td style="text-align: left;"> Y ~ GCA(Par1, Par2) + MDD(Par1, Par2) + DD(Par1, Par2) + SCA(Par1, Par2) + RGCA(Par1, Par2) + RSCA(Par1, Par2) </td>
</tr>
<tr>
<td style="text-align: left;">
GE2	</td>
<td style="text-align: left;"> Y ~ H.BAR(Par1, Par2) + VE.i(Par1, Par2) + H.i(Par1, Par2) + SCA(Par1, Par2) </td>
</tr>
<tr>
<td style="text-align: left;">
GE3	</td>
<td style="text-align: left;"> Y ~ H.BAR(Par1, Par2) + SP(Par1, Par2) + GCAC(Par1, Par2) + SCA(Par1, Par2) </td>
</tr>
<tr>
<td style="text-align: left;">
GE2r </td>
<td style="text-align: left;"> Y ~ H.BAR(Par1, Par2) + VE.i(Par1, Par2) + H.i(Par1, Par2) + SCA(Par1, Par2) + RGCA(Par1, Par2) + RSCA(Par1, Par2) </td>
</tr>
<tr>
<td style="text-align: left;">
GE3r	</td>
<td style="text-align: left;"> Y ~ H.BAR(Par1, Par2) + SP(Par1, Par2) + GCAC(Par1, Par2) + SCA(Par1, Par2) + RGCA(Par1, Par2) + RSCA(Par1, Par2)</td>
</tr>
</table>
<h3>Value</h3>

<p>lm.diallel returns an object of class  c("diallel", "lm"), that is a list containing at least the following components:
</p>

<dl>
<dt><code>coefficients</code></dt>
<dd>
<p>a named vector of coefficients</p>
</dd>
<dt><code>residuals</code></dt>
<dd>
<p>the residuals, that is response minus fitted values</p>
</dd>
<dt><code>fitted.values</code></dt>
<dd>
<p>the fitted mean values</p>
</dd>
<dt><code>rank</code></dt>
<dd>
<p>the numeric rank of the fitted linear models</p>
</dd>
<dt><code>weights</code></dt>
<dd>
<p>(only for weighted fits) the specified weights</p>
</dd>
<dt><code>df.residual</code></dt>
<dd>
<p>the residual degrees of freedom</p>
</dd>
<dt><code>call</code></dt>
<dd>
<p>the matched call</p>
</dd>
<dt><code>terms</code></dt>
<dd>
<p>the terms object used</p>
</dd>
<dt><code>contrasts	</code></dt>
<dd>
<p>(only where relevant) the contrasts used</p>
</dd>
<dt><code>xlevels</code></dt>
<dd>
<p>(only where relevant) a record of the levels of the factors used in fitting</p>
</dd>
<dt><code>call</code></dt>
<dd>
<p>the matched call</p>
</dd>
<dt><code>offset</code></dt>
<dd>
<p>the offset used (missing if none were used)</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>if requested, the response used</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>if requested, the model matrix used</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>if requested (the default), the model frame used</p>
</dd>
<dt><code>na.action</code></dt>
<dd>
<p>(where relevant) information returned by model.frame on the special handling of NAs</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("hayman54")
dMod &lt;- lm.diallel(Ftime ~ Par1 + Par2, Block = Block,
                  data = hayman54,
                  fct = "HAYMAN1")
anova(dMod)

#or
data("zhang05")
contrasts(zhang05$Block) &lt;- c("contr.sum")
dMod2 &lt;- lm.diallel(Yield ~ Par1 + Par2, Env = Env, Block = Block,
            data = zhang05, fct = "GE2")

#or
data("lonnquist61")
dMod3 &lt;- lm.diallel(Yield ~ Par1 + Par2,
                  data = lonnquist61,
                  fct = "GE2")
summary(dMod3, MSE = 7.10, dfr = 60)
anova(dMod3, MSE = 7.10, dfr = 60)
</code></pre>


</div>