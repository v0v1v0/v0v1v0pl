<div class="container">

<table style="width: 100%;"><tr>
<td>lmv.linkage.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>LinkageMapView plotting function</h2>

<h3>Description</h3>

<p>lmv.linkage.plot is the main function to produce linkage group maps and has many
parameters to customize the pdf output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmv.linkage.plot(mapthis, outfile, mapthese = NULL, at.axis = NULL,
  autoconnadj = TRUE, cex.axis = par("cex.axis"),
  cex.lgtitle = par("cex.main"), cex.main = par("cex.main"),
  col.axis = par("col.axis"), col.lgtitle = par("col.main"),
  col.main = par("col.main"), conndf = NULL, denmap = FALSE,
  dupnbr = FALSE, font.axis = par("font.axis"),
  font.lgtitle = par("font.main"), font.main = par("font.main"),
  header = TRUE, labdist = 0.3, labels.axis = TRUE, lcex = par("cex"),
  lcol = par("col"), lfont = par("font"), lgperrow = NULL,
  lgtitles = NULL, lgw = 0.25, lg.col = NULL, lg.lwd = par("lwd"),
  lty.axis = "solid", lwd.axis = 1, lwd.ticks.axis = lwd.axis,
  main = NULL, markerformatlist = NULL, maxnbrcolsfordups = 3,
  pdf.bg = "transparent", pdf.family = "Helvetica", pdf.fg = "black",
  pdf.width = NULL, pdf.height = NULL, pdf.pointsize = 12,
  pdf.title = "LinkageMapView R output", posonleft = NULL,
  prtlgtitles = TRUE, qtldf = NULL, revthese = NULL, rcex = par("cex"),
  rcol = par("col"), rfont = par("font"), roundpos = 1, rsegcol = TRUE,
  ruler = FALSE, sectcoldf = NULL, segcol = NULL, qtlscanone = NULL,
  showonly = NULL, units = "cM", ylab = units)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mapthis</code></td>
<td>
<p>Required, either a 'cross' object from r/qtl, a csv or txt
file or a data frame with the following 3 columns in this order:
</p>

<ol>
<li>
<p> Required, linkage group name. This will be the title for the linkage
group unless overridden - see lgtitles.
</p>
</li>
<li>
<p> Required, position - must be in numerical order ascending within
linkage group name.
</p>
</li>
<li>
<p> Required, locus - marker name at this position.
</p>
</li>
<li>
<p> Optional, segcol - color for the line across the chromosome
at this marker.  See also segcol parameter.
</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outfile</code></td>
<td>
<p>Required, name for the output pdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapthese</code></td>
<td>
<p>Optional vector of linkage group names to print.
The default, NULL, will print all linkage groups in mapthis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at.axis</code></td>
<td>
<p>Optional. The points at which tick-marks are to be drawn on the ruler.
Non-finite (infinite, NaN or NA) values are omitted.
By default (when NULL) tickmark locations are computed.
#' @seealso <code>axis</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoconnadj</code></td>
<td>
<p>If TRUE (the default), locus with the same name
(homologs) on adjacent linkage groups will be connected with a line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>The magnification to be used for axis (ruler) text.
The default is par("cex.axis").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lgtitle</code></td>
<td>
<p>The magnification to be used for linkage group titles.
The default is par("cex.main").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p>The magnification to be used for main title.
The default is par("cex.main").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.axis</code></td>
<td>
<p>The color to be used for axis (ruler) text.
Defaults to par("col.axis").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.lgtitle</code></td>
<td>
<p>The color to be used for linkage group titles.
Defaults to par("col.main").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.main</code></td>
<td>
<p>The color to be used for the main title.
Defaults to par("col.main").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conndf</code></td>
<td>
<p>An optional data frame containing markers to be connected
with lines (homologs).  If autoconnadj = TRUE, these lines will
appear as well as those with the same name in adjacent linkage
groups.  Required columns:
</p>

<ul>
<li>
<p> fromchr Linkage group for the line start.
</p>
</li>
<li>
<p> fromlocus Locus name for the line start.
</p>
</li>
<li>
<p> tochr Linkage group for the line end.
</p>
</li>
<li>
<p> tolocus Locus name for the line end.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denmap</code></td>
<td>
<p>If TRUE, you are requesting a density map which means no locus
or position labels will be printed and the following parameters are
set:
ruler = TRUE
autoconndf = FALSE
conndf = NULL
See also sectcoldf parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dupnbr</code></td>
<td>
<p>If TRUE, only the first marker name at a position will print
with (## more) afterwards indicating the number of duplicate markers
at that position.  dupnbr should be left to the default, FALSE,
if showonly provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.axis</code></td>
<td>
<p>An integer which specifies which font to use for the
axis (ruler) text.
The default is par("font.axis"). 1 is plain text.  2 is bold.
3 is italic. 4 is bold italic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.lgtitle</code></td>
<td>
<p>An integer which specifies which font to use for the
linkage group titles text.
The default is par("font.main"). 1 is plain text.  2 is bold.
3 is italic. 4 is bold italic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.main</code></td>
<td>
<p>An integer which specifies which font to use for title text.
The default is par("font.main"). 1 is plain text.  2 is bold.
3 is italic. 4 is bold italic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>
<p>A boolean indicating if the input file has a header row.
Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labdist</code></td>
<td>
<p>Distance in inches from the chromosome to the position
and locus labels. The default is 0.3 inches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels.axis</code></td>
<td>
<p>Optional. This can either be a logical value specifying
whether (numerical) annotations are to be made at the tickmarks on the ruler,
or a character or expression vector of labels to be placed at the tickpoints.
If this is not logical, at should also be supplied and of the same length.
The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcex</code></td>
<td>
<p>A numerical value giving the amount by which position labels
should be magnified.  The default is par("cex").
See also rcex for locus labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p>The color for the position labels.  The default is par("col").
See also rcol for locus labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfont</code></td>
<td>
<p>An integer which specifies which font to use for the position
labels.  The default is par("font").  See also rfont for locus labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lgperrow</code></td>
<td>
<p>An integer specifying how many linkage groups to plot in
one row.  As many rows as needed to plot all requested linkage
groups will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lgtitles</code></td>
<td>
<p>Optional vector of titles for the linkage groups.  These
will override the default, which is that the linkage group names
in the input print as titles.  This may be useful if in mapthese you
have indicated to print the same linkage group more than once for the
purpose of showing homologous markers without having lines cross.
See also cex.lgtitle, col.lgtitle, font.lgtitle</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lgw</code></td>
<td>
<p>Width of chromosome in inches.  Default is 0.25 inches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lg.col</code></td>
<td>
<p>Linkage group color.  The color of the chromosomes.
The default is the background color (pdf.bg).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lg.lwd</code></td>
<td>
<p>Linkage group linewidth. The width of the line around
the chromosome.  Defaults to par("lwd").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.axis</code></td>
<td>
<p>Optional. Line type for both the axis line and the tick marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.axis</code></td>
<td>
<p>Optional.  Line width for the axis line.  The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.ticks.axis</code></td>
<td>
<p>Optional.  Line width for the axis tick marks.
Default is lwd.axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>An optional title for the linkage group map.  See also
cex.main, col.main, and font.main.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markerformatlist</code></td>
<td>
<p>An optional list containing the following vectors:
</p>

<ul>
<li>
<p> locus Required.  A vector of loci for which the following
should be applied.
</p>
</li>
<li>
<p> col Optional.  The color for these locus labels.  This color
will override rcol.  See also rsegcol.
</p>
</li>
<li>
<p> cex Optional.  A numerical vlue giving the amount by which
these locus labels should be magnified.  This value will override
rcex.
</p>
</li>
<li>
<p> font Optional. An integer which specifies which font to use
for these locus labels. This value will override rfont.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxnbrcolsfordups</code></td>
<td>
<p>Indicates the number of columns across the page for
locus labels appearing at duplicate positions.  The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.bg</code></td>
<td>
<p>Background color for the pdf.  Default is "transparent".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.family</code></td>
<td>
<p>Font family for all text.  Default is "Helvetica".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.fg</code></td>
<td>
<p>Foreground color for the pdf.  Default is black.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.width</code></td>
<td>
<p>Width of the output file in inches.  Defaults to the size
necessary to fit all linkage groups with other options specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.height</code></td>
<td>
<p>Height of the output file in inches.  Defaults to the size
necessary to fit all linkage groups with other options specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.pointsize</code></td>
<td>
<p>The default point size to be used.  Defaults to 12.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.title</code></td>
<td>
<p>Title to be passed to pdf as metadata.  This title does not
appear except in the pdf metadata.  Defaults to
"LinkageMapView R output".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posonleft</code></td>
<td>
<p>A vector of boolean (TRUE or FALSE) the length of the
number of linkage groups to be plotted. If FALSE, print positions on
right hand side of linkage group and locus names on left hand side
of linkage group.  Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prtlgtitles</code></td>
<td>
<p>If FALSE do not print linkage group titles.
Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qtldf</code></td>
<td>
<p>An optional data frame containing QTL information for plotting.
The data frame, if provided, must contain:
</p>

<ul>
<li>
<p> chr Linkage group name for QTL.
</p>
</li>
<li>
<p> qtl Name (label) for QTL.
</p>
</li>
<li>
<p> so Start of outer interval. Numeric.
</p>
</li>
<li>
<p> si Start of inner interval. Numeric.
</p>
</li>
<li>
<p> ei End of inner interval. Numeric.
</p>
</li>
<li>
<p> eo End of outer interval. Numeric.
</p>
</li>
<li>
<p> col Color for QTL.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>revthese</code></td>
<td>
<p>Optional vector of linkage group names to reverse.  The end
position becomes position 0 and position 0 becomes the end position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcex</code></td>
<td>
<p>A numerical value giving the amount by which locus labels
should be magnified.  The default is par("cex").
See also lcex for position labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcol</code></td>
<td>
<p>The color for the locus labels.  The default is par("col").
See also lcol for position labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rfont</code></td>
<td>
<p>An integer which specifies which font to use for the locus
labels.  The default is par("font").
See also lfont for position labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roundpos</code></td>
<td>
<p>Number of positions after the decimal point to print for
positions.  Default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsegcol</code></td>
<td>
<p>Color of the segments across the chromosome and to the label.
TRUE, the default, indicates the color should be the
same as the label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ruler</code></td>
<td>
<p>A single boolean (TRUE OR FALSE).  If TRUE, an axis is
drawn on the left hand side of the page and the position labels
are not printed on any linkage group.  The default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sectcoldf</code></td>
<td>
<p>Optional data frame containing the following named columns
indicating sections of the chromosome to be colored:
</p>

<ul>
<li>
<p> Required, chr - matches from input file or cross object
linkage group name
</p>
</li>
<li>
<p> Required, s - start position in cM
</p>
</li>
<li>
<p> Required, e - end position in cM
</p>
</li>
<li>
<p> Required, col - color for section
</p>
</li>
<li>
<p> Optional, dens - a numeric cm / marker value used to print
the density map legend.
</p>
</li>
</ul>
<p>For a density map, use the lmvdencolor function to populate sectcoldf.
When denmap = TRUE and no sectcoldf parameter is supplied, lmvdencolor
is called with defaults fully populating the sectcoldf data frame.
See also the denmap parameter.
</p>
<p>@seealso <code>lmvdencolor</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segcol</code></td>
<td>
<p>Optional. Name of the column in mapthis that contains colors for the line
segments across the chromosome.  If specified, this overrides rsegcol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qtlscanone</code></td>
<td>
<p>Optional scanone data frame from package r/qtl.  If provided,
all QTLs in the dataframe will be drawn by calculating their
start and end with the r/qtl function bayesint with defaults.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showonly</code></td>
<td>
<p>Optional vector of marker names.  If provided, only these
marker names will be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>Units of the position values supplied in mapthis.  The default
value is cM (centimorgan) but any value can be provided.  The
value provided is only used for a ruler (y axis) title and the density
map legend text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Optional.  Title for the y-axis (ruler).  The default value is
units.  See units parameter.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
## take a cross object from r/qtl and produce linkage map
## on chr 1,4,6,15

library(qtl)
data(hyper)
outfile = file.path(tempdir(), "hyper.pdf")
lmv.linkage.plot(hyper,outfile,mapthese=c(1,4,6,15))

## color some of the markers for emphasis

library(qtl)
data(hyper)

# make a list to pass label options
flist &lt;- list()
locus &lt;- c("D1Mit123","D1Mit105","D6Mit273","D15Mit56","D15Mit156")
col   &lt;- c("red")
flist[[1]] &lt;- list(locus=locus,col=col)

outfile = file.path(tempdir(), "hyperred.pdf")
lmv.linkage.plot(hyper,outfile,mapthese=c(1,4,6,15),markerformatlist=flist)

## change some of the pdf options and chromosome color
## changing linkage group title color (col.lgtitle) to same as
## foreground pdf color

library(qtl)
data(hyper)

outfile = file.path(tempdir(), "hyperlg.pdf")
lmv.linkage.plot(hyper,outfile,
mapthese=c(1,4,6,15),
pdf.bg="black",pdf.fg="white",col.lgtitle="white",
pdf.height=8,pdf.title="myhyper",lg.col="tan")

## change all label colors and fonts

library(qtl)
data(hyper)

outfile = file.path(tempdir(), "hypercol.pdf")
lmv.linkage.plot(hyper,outfile,mapthese=c(1,4,6,15),
lcol="blue",lfont=2,lcex=1.2,rcol="red",rfont=3,rcex=2)

## make a dataframe to pass sections of chr to col
## use a ruler instead of printing positions as labels
## only allow one column for duplicate markers at same position
## (default is 3)

library(qtl)
data(hyper)

chr = c(1, 4, 6, 15)
s = c(82,35,9.8,7.7)
e = c(94,47,21.9,13.1)
col = c("pink","blue","blue","green")
sectcoldf &lt;-  data.frame(chr, s, e, col,stringsAsFactors = FALSE)

outfile = file.path(tempdir(), "hyperruler.pdf")
lmv.linkage.plot(hyper,outfile,mapthese=c(1,4,6,15),
ruler=TRUE,maxnbrcolsfordups = 1, sectcoldf=sectcoldf)

## plot qtls also out of a r/qtl scanone object
## plot marker names on left (instead of right) of chr 4 and 7

library(qtl)
data(hyper)

# create scanone df for testing
hyper &lt;-
 calc.genoprob(hyper,
               step = 2.0,
               map.function = "haldane",
               stepwidth = "fixed")
hyper.scanone &lt;- scanone(hyper)

outfile = file.path(tempdir(), "testrqtlhyper2.pdf")
lmv.linkage.plot(hyper,
   outfile, mapthese=c(1,4,6,7,15),
   qtlscanone = hyper.scanone,
   posonleft = c(TRUE,FALSE,TRUE,FALSE,TRUE))

## Not run: 
## plot a carrot comparative linkage map
## kindly provided by Massimo Iorizzo:
## Cavagnaro et al. BMC Genomics 2014, 15:1118

# make a df to pass qtl info
qtldf &lt;- data.frame(
  chr = character(),
  qtl = character(),
  so = numeric(),
  si = numeric(),
  ei = numeric(),
  eo = numeric(),
  col = character(),
  stringsAsFactors = FALSE
)
qtldf &lt;- rbind(qtldf,
               data.frame(
                 chr = "70349LG3",
                 qtl = "RTPE-Q1",
                 so = 36.6,
                 si = 37,
                 ei = 37,
                 eo = 38,
                 col="red"
               ))
# make a list to pass label options
flist &lt;- list()
locus &lt;- c("BSSR-094", "K0149", "K0627", "K2161", "ESSR-087", "ESSR-057")
font  &lt;- c(2)   #bold
flist[[1]] &lt;- list(locus = locus, font = font)
locus &lt;- c("F3H", "FLS1")
font  &lt;- c(4)   #bold italic
flist[[2]] &lt;- list(locus = locus, font = font)
locus &lt;- c("P3", "P1", "Raa1")
font  &lt;- c(3)   #italic
col &lt;- c("red")
flist[[3]] &lt;- list(locus = locus, font = font, col = col)
filename &lt;- system.file("extdata", "Carrot.csv", package="LinkageMapView")
outfile = file.path(tempdir(), "carrot.pdf")
lmv.linkage.plot(
  mapthis = filename,
  outfile = outfile,
  ruler = TRUE,
  lgtitle = c("2170", "70349", "10117"),
  maxnbrcolsfordups = 1,
  markerformatlist = flist,
  lg.col = "lightblue1",
  pdf.width =10,
  revthese = c("70349LG3"),
  qtldf=qtldf
)

## End(Not run)

## do a density map with default colors
data(oat)

outfile = file.path(tempdir(), "oat_Mrg01.pdf")
lmv.linkage.plot(oat,outfile,mapthese=c("Mrg01","Mrg02"),denmap=TRUE)

## Not run: 
## do a density map and provide your own colors with lmvdencolor helper
data(oat)
##
outfile = file.path(tempdir(), "oat_Mrg01_YlGn.pdf")

sectcoldf &lt;- lmvdencolor(oat,colorin =
colorRampPalette(RColorBrewer::brewer.pal(8, "YlGn"))(5))

lmv.linkage.plot(oat,outfile,denmap=TRUE,sectcoldf=sectcoldf)

## End(Not run)
</code></pre>


</div>