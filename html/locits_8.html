<div class="container">

<table style="width: 100%;"><tr>
<td>ewspecHaarNonPer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute evolutionary wavelet spectrum (EWS) estimate based
on the Haar wavelet transform.
</h2>

<h3>Description</h3>

<p>This function uses the special <code>HwdS</code> function
to compute the Haar wavelet transform with out boundary
conditions (neither periodic, interval, mirror reflection).
This is so all coefficients are genuine Haar coefficients without
involving extra/repeated data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ewspecHaarNonPer(x, filter.number = 1, family = "DaubExPhase",
    UseLocalSpec = TRUE, DoSWT = TRUE, WPsmooth = TRUE,
    verbose = FALSE, smooth.filter.number = 10,
    smooth.family = "DaubLeAsymm",
    smooth.levels = 3:WPwst$nlevels - 1, smooth.dev = madmad,
    smooth.policy = "LSuniversal", smooth.value = 0,
    smooth.by.level = FALSE, smooth.type = "soft",
    smooth.verbose = FALSE, smooth.cvtol = 0.01,
    smooth.cvnorm = l2norm, smooth.transform = I,
    smooth.inverse = I)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of dyadic length that contains the time series
you want to form the EWS of.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.number</code></td>
<td>
<p>Should always be 1 (for Haar)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Should always be "DaubExPhase", for Haar.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UseLocalSpec</code></td>
<td>

<p>Should always be <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DoSWT</code></td>
<td>
<p>Should always be <code>TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WPsmooth</code></td>
<td>
<p>Should alway be <code>TRUE</code> to do smoothing. If <code>FALSE</code>
then not smoothed.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> If <code>TRUE</code> informative messages are printed during
the progress of the algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.filter.number</code></td>
<td>
<p>Wavelet filter number for doing the
wavelet smoothing of the EWS estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.family</code></td>
<td>
<p>Wavelet family for doing the wavelet smoothing
of the EWS estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.levels</code></td>
<td>
<p>Which levels of the EWS estimate to apply smoothing
to.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.dev</code></td>
<td>
<p>What kind of deviance to use. The default is madmad,
an alternative might be var. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.policy</code></td>
<td>
<p>What kind of smoothing to use. See help
page for <code>ewspec</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.value</code></td>
<td>
<p>If a manual value has to be supplied according
to the <code>smooth.policy</code> then this is it.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.by.level</code></td>
<td>
<p>If <code>TRUE</code> then all levels are smoothed
independently with different smoothing, otherwise all levels
are smoothed together (eg one threshold for all levels).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.type</code></td>
<td>
<p>The type of wavelet smoothing "hard" or "soft"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.verbose</code></td>
<td>
<p>If <code>TRUE</code> then informative messages about
the smoothing are printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.cvtol</code></td>
<td>
<p>If cross-validation smoothing is used, this is
the tolerance
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.cvnorm</code></td>
<td>
<p>If cross-validation smoothing used, this is the
norm that's used
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.transform</code></td>
<td>

<p>A transform is applied before smoothing
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.inverse</code></td>
<td>

<p>The inverse transform is applied after smoothing
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is very similar
to <code>ewspec</code> from wavethresh, and many arguments here perform
the same function as there.
</p>


<h3>Value</h3>

<p>The same value as for the <code>ewspec</code> function.
</p>


<h3>Author(s)</h3>

<p>Guy Nason.
</p>


<h3>References</h3>

<p>Nason, G.P. (2013) A test for second-order stationarity and
approximate confidence intervals for localized autocovariances
for locally stationary time series. <em>J. R. Statist. Soc.</em> B,
<b>75</b>, 879-904.
<a href="https://doi.org/10.1111/rssb.12015">doi:10.1111/rssb.12015</a></p>


<h3>See Also</h3>

<p><code>hwtos2</code>,
<code>HwdS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Requires wavethresh, so not run directly in installation of package
#
ewspecHaarNonPer(rnorm(512))
</code></pre>


</div>