<div class="container">

<table style="width: 100%;"><tr>
<td>varip2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Direct computation of estimate of variance of v_ip,
the Haar wavelet coefficients of the periodogram.
</h2>

<h3>Description</h3>

<p>Performs a direct computation of an estimate
of the variance of the Haar wavelet coefficients of
the raw wavelet periodogram of a time series. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">varip2(i, p, ll, S, P)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>Scale parameter of Haar wavelet analyzing periodogram.
Scale 1 is the finest scale.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Location parameter of Haar wavelet analyzing periodogram
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll</code></td>
<td>
<p>Scale of the raw wavelet periodogram being analyzed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>Estimate of the spectrum, under the assumption of stationarity.
So, this is just a vector of (possibly) J scales (which is often
the usual spectral estimate averaged over time). Note: that the
main calling function, <code>hwtos2</code>, actually passes
<code>maxD</code> levels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Is an autocorrelation wavelet object, returned by the
<code>PsiJ</code> function. The wavelet concerned is the analyzing
one underlying the raw wavelet periodogram of the series.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the variance of the Haar wavelet coefficients of
the raw wavelet periodogram. Note, that this is merely
an estimate of the variances.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>covAA</code></td>
<td>
<p>A component of the variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covAB</code></td>
<td>
<p>A component of the variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covBB</code></td>
<td>
<p>A component of the variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ans</code></td>
<td>
<p>The actual variance</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Guy Nason.
</p>


<h3>References</h3>

<p>Nason, G.P. (2013) A test for second-order stationarity and
approximate confidence intervals for localized autocovariances
for locally stationary time series. <em>J. R. Statist. Soc.</em> B,
<b>75</b>, 879-904.
<a href="https://doi.org/10.1111/rssb.12015">doi:10.1111/rssb.12015</a></p>


<h3>See Also</h3>

<p><code>Cvarip2</code>,<code>hwtos2</code>, <code>covIwrap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Generate autocorrelation wavelets
#
P1 &lt;- PsiJ(-5, filter.number=1, family="DaubExPhase")
#
#
# Now compute varip2: this is the variance of the Haar wavelet coefficient
# at the finest scale, location 10 and P1 autocorrelation wavelet.
# Note, I've used S to be the exact coefficients which would be for white noise.
# In practice, S would be an *estimate* calculated from the data.
#
varip2(i=1, p=10, ll=2, S=c(1/2, 1/4, 1/8, 1/16, 1/32), P=P1)
#
# Ans component is 1.865244
  </code></pre>


</div>