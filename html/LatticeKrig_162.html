<div class="container">

<table style="width: 100%;"><tr>
<td>directionCosines</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Utility functions for spherical coordinate and projections. 

</h2>

<h3>Description</h3>

<p>Convert back and forth between  lon/lat and direction cosines and also project spherical coordinates on a local tangent plane. 

</p>


<h3>Usage</h3>

<pre><code class="language-R">directionCosines(x)
toSphere( Grid)
projectionSphere(x1, x2) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A two column matrix of lon/lat coordinates in degrees.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p> A vector of direction cosines defining the intersection of the tangent plane
with the unit sphere</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p> A matrix of direction cosines that will be projected onto the plane defined by 
x2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Grid</code></td>
<td>

<p>A three column matrix of direction cosines 

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The conversion functions are  based on straight forward definitions of spherical 
coordinates.  The projection function is done by two rotations, first around the Z axis and then around the Y axis.  

</p>


<h3>Value</h3>

<p><strong>directionCosines</strong> A three column matrix of direction cosines.
</p>
<p><strong>toSphere</strong> A two column matrix of longitudes and latitudes.
</p>
<p><strong>projectionSphere</strong> A two column matrix of Euclidean coordinates on the tangent plane to <code>x1</code>. The convention is that the origin (0,0) is mapped to <code>x1</code> and the X- axis are points along the meridian through  <code>x1</code>. The Y axis are points on the great circle passing through  <code>x1</code> and perpendicular to the meridian. 
</p>


<h3>Author(s)</h3>

<p>Doug Nychka

</p>


<h3>Examples</h3>

<pre><code class="language-R"># 
# icosahedron:
 phi = (1 + sqrt(5))/2
  V = matrix(c(0, 1, phi, 0, 1, -phi, 0, -1, phi, 0, -1, -phi, 
        1, phi, 0, -1, phi, 0, 1, -phi, 0, -1, -phi, 0, phi, 
        0, 1, -phi, 0, 1, phi, 0, -1, -phi, 0, -1), 12, 3, byrow = TRUE)

# check : library( rgl); plot3d( V, size=10, col="red4" )
# as lon lat:
V2&lt;- toSphere( V)
plot( V2)

# lon lat grid
 lGrid&lt;- make.surface.grid(  list(x= seq( -10,10,, 10), y= seq( -20,20,,10)) )
 
 dGrid&lt;- directionCosines( lGrid)
 pairs( dGrid)
 # also try:   library( rgl); plot3d(  dGrid)
 </code></pre>


</div>