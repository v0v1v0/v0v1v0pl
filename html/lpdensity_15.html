<div class="container">

<table style="width: 100%;"><tr>
<td>lpdensity_fn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Supporting Function for <code>lpdensity</code>
</h2>

<h3>Description</h3>

<p><code>lpdensity_fn</code> implements the local polynomial density estimator. This
function is for internal use, and there is no error handling or robustness check.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lpdensity_fn(
  data,
  grid,
  bw,
  p,
  q,
  v,
  kernel,
  Cweights,
  Pweights,
  massPoints,
  showSE = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Numeric vector or one dimensional matrix/data frame, the raw data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Numeric vector or one dimensional matrix/data frame, the grid on which
density is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Numeric vector or one dimensional matrix/data frame, the bandwidth
used for estimation. Should be strictly positive, and have the same length as
<code>grid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Integer, nonnegative, the order of the local-polynomial used to construct point
estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Integer, nonnegative, the order of the local-polynomial used to construct
confidence interval (a.k.a. the bias correction order).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Integer, nonnegative, the derivative of distribution function to be estimated. <code>0</code> for
the distribution function, <code>1</code> (default) for the density funtion, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel, </code></td>
<td>
<p>String, the kernel function, should be one of <code>"triangular"</code>,
<code>"uniform"</code> or <code>"epanechnikov"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cweights</code></td>
<td>
<p>Numeric vector or one dimensional matrix/data frame, the weights used
for counterfactual distribution construction. Should have the same length as sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pweights</code></td>
<td>
<p>Numeric vector or one dimensional matrix/data frame, the weights used
in sampling. Should have the same length as sample size, and nonnegative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>massPoints</code></td>
<td>
<p>Boolean, whether whether point estimates and standard errors
should be corrected if there are mass points in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showSE</code></td>
<td>
<p><code>TRUE</code> (default) or <code>FALSE</code>, whether standard errors should be computed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Recommend: use <code>lpdensity</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>grid points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>bandwidth for each grid point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nh</code></td>
<td>
<p>Effective sample size for each grid point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_p</code></td>
<td>
<p>Density estimates on the grid with local polynomial of order <code>p</code>,
with the same length as <code>grid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_q</code></td>
<td>
<p>Density estimates on the grid with local polynomial of order <code>q</code>,
with the same length as <code>grid</code>. This is reported only if <code>q</code> is greater than
0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_p</code></td>
<td>
<p>Standard errors corresponding to <code>hat_p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_q</code></td>
<td>
<p>Standard errors corresponding to <code>hat_q</code>. This is reported only
if <code>q</code> is greater than 0.</p>
</td>
</tr>
</table>
</div>