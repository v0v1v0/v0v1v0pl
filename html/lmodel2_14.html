<div class="container">

<table style="width: 100%;"><tr>
<td>lmodel2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model II regression</h2>

<h3>Description</h3>

<p> This function computes model II simple linear
regression using the following methods: ordinary least squares (OLS),
major axis (MA), standard major axis (SMA), and ranged major axis
(RMA). The model only accepts one response and one explanatory
variable. </p>


<h3>Usage</h3>

<pre><code class="language-R">lmodel2(formula, data = NULL, range.y=NULL, range.x=NULL, nperm=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula </code></td>
<td>
<p> A formula specifying the bivariate model, as in
<code>lm</code> and <code>aov</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> A data frame containing the two variables specified in the formula. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.y, range.x</code></td>
<td>
<p> Parametres for ranged major axis regression
(RMA). If <code>range.y = NULL</code> and <code>range.x = NULL</code>, RMA will
not be computed. If only one of them is <code>NULL</code>, the program will stop.  
If <code>range.y = "relative"</code>: variable <code>y</code> has a true zero
(relative-scale variable). If <code>range.y = "interval"</code>: variable
<code>y</code> possibly includes negative values (interval-scale
variable). If <code>range.x = "relative"</code>: variable <code>x</code> has a
true zero (relative-scale variable). If <code>range.x = "interval"</code>:
variable <code>x</code> possibly includes negative values (interval-scale
variable)  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p> Number of permutations for the tests. If <code>nperm =
   0</code>, tests will not be computed. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Model II regression should be used when the two variables in the
regression equation are random, i.e. not controlled by the
researcher. Model I regression using least squares underestimates
the slope of the linear relationship between the variables when they
both contain error. Ordinary least squares (OLS) is, however, appropriate 
in some cases as a model II regression model; see the “Model
II User's guide, R edition” which you can read using command
<code>vignette("mod2user")</code>. 
</p>
<p>The model II regression methods of ordinary least squares (OLS),
major axis (MA), standard major axis (SMA), and ranged major axis
(RMA) are described in Legendre and Legendre (1998, Section
10.3.2). OLS, MA, and SMA are also described in Sokal and Rohlf
(1995). The PDF document “Model II User's guide, R edition”
provided with this function contains a tutorial for model II
regression, and can be read with command
<code>vignette("mod2user")</code>. 
</p>
<p>The <code>plot</code> function plots the data points together with one of the
regression lines, specified by <code>method="OLS"</code>, <code>method="MA"</code> (default),
<code>method="SMA"</code>, or <code>method="RMA"</code>, and its 95 percent confidence interval.
</p>


<h3>Value</h3>

<p>The default output provides the regression output. It draws
information from a list, produced by function <code>lmodel2</code>, which
contains the following elements: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code> y </code></td>
<td>
<p> The response variable.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> x </code></td>
<td>
<p> The explanatory variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> regression.results </code></td>
<td>
<p> A table with rows corresponding to the
four regression methods. Column 1 gives the method name, followed by
the intercept and slope estimates, the angle between the regression
line and the abscissa, and the permutational probability
(one-tailed, for the tail corresponding to the sign of the slope
estimate). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> confidence.intervals </code></td>
<td>
<p> A table with rows corresponding to
the four regression methods. The method name is followed by the
parametric 95
the intercept and slope estimates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> eigenvalues  </code></td>
<td>
<p> Eigenvalues of the bivariate dispersion,
computed during major axis regression. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> H </code></td>
<td>
<p> The H statistic used for computing the confidence
interval of the major axis slope. Notation following Sokal and Rohlf
(1995). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> n </code></td>
<td>
<p> Number of objects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> r </code></td>
<td>
<p> Correlation coefficient. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> rsquare </code></td>
<td>
<p> Coefficient of determination (R-square) of the OLS regression. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> P.param </code></td>
<td>
<p> 2-tailed parametric P-value for the test of r and the OLS slope. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> theta </code></td>
<td>
<p> Angle between the two OLS regression lines,
<code>lm(y ~ x)</code> and <code>lm(x ~ y)</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> nperm </code></td>
<td>
<p> Number of permutations for the permutation tests. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> epsilon </code></td>
<td>
<p> Any value smaller than epsilon is considered to be zero. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> info.slope </code></td>
<td>
<p> Information about the slope notation when <code class="reqn">r = 0</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> info.CI </code></td>
<td>
<p> Information about the confidence limits notation
when the slope is infinite. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> call </code></td>
<td>
<p> Call of the function. </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The package exports only the main functions <code>lmodel2</code>,
<code>plot.lmodel2</code> and <code>lines.lmodel2</code>.  Much of the work is
done by internal functions which are not directly visible, but you
can use triple colon to see or directly use these functions (e.g.,
<code>lmodel2:::print.lmodel2</code>).  Internal functions that perform
essential parts of the analysis are <code>MA.reg</code>, <code>SMA.reg</code>,
<code>CLma</code>, <code>CLsma</code> and <code>permutest.lmodel2</code>. </p>


<h3>Author(s)</h3>

<p> Pierre Legendre, Departement de Sciences Biologiques, Universite de Montreal </p>


<h3>References</h3>

 
<p>Legendre, P. and L. Legendre. 1998. Numerical ecology, 2nd English
edition. Elsevier Science BV, Amsterdam. 
</p>
<p>Sokal, R. R. and F. J. Rohlf. 1995. Biometry – The principles and
practice of statistics in biological research. 3rd
edition. W. H. Freeman, New York. 
</p>


<h3>See Also</h3>

 
<p>A tutorial (file “Model II User's guide, R edition”) is provided
with this function, and can be read within <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> session using command
<code>vignette("mod2user", package="lmodel2")</code>. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## The example data files are described in more detail in the
## \dQuote{Model II User's guide, R edition} tutorial. 

## Example 1 (surgical unit data)
data(mod2ex1)
Ex1.res &lt;- lmodel2(Predicted_by_model ~ Survival, data=mod2ex1, nperm=99)
Ex1.res
plot(Ex1.res) 

## Example 2 (eagle rays and Macomona)
data(mod2ex2)
Ex2.res &lt;- lmodel2(Prey ~ Predators, data=mod2ex2, "relative", "relative", 99)
Ex2.res
op &lt;- par(mfrow = c(1,2))
plot(Ex2.res, "SMA")
plot(Ex2.res, "RMA")
par(op)

## Example 3 (cabezon spawning)
op &lt;- par(mfrow = c(1,2))
data(mod2ex3)
Ex3.res &lt;- lmodel2(No_eggs ~ Mass, data=mod2ex3, "relative", "relative", 99)
Ex3.res
plot(Ex3.res, "SMA")
plot(Ex3.res, "RMA")
par(op)

## Example 4 (highly correlated random variables)
op &lt;- par(mfrow=c(1,2))
data(mod2ex4)
Ex4.res &lt;- lmodel2(y ~ x, data=mod2ex4, "interval", "interval", 99)
Ex4.res
plot(Ex4.res, "OLS")
plot(Ex4.res, "MA")
par(op)

# Example 5 (uncorrelated random variables)
data(mod2ex5)
Ex5.res &lt;- lmodel2(random_y ~ random_x, data=mod2ex5, "interval", "interval", 99)
Ex5.res
op &lt;- par(mfrow = c(2,2))
plot(Ex5.res, "OLS")
plot(Ex5.res, "MA")
plot(Ex5.res, "SMA")
plot(Ex5.res, "RMA")
par(op)

## Example 6 where cor(y,x) = 0 by construct (square grid of points)

y0 = rep(c(1,2,3,4,5),5)
x0 = c(rep(1,5),rep(2,5),rep(3,5),rep(4,5),rep(5,5))
plot(x0, y0)
Ex6 = as.data.frame(cbind(x0,y0))
zero.res = lmodel2(y0 ~ x0, data=Ex6, "relative", "relative")
print(zero.res)
op &lt;- par(mfrow = c(1,2))
plot(zero.res, "OLS")
plot(zero.res, "MA")
par(op)
</code></pre>


</div>