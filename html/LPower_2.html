<div class="container">

<table style="width: 100%;"><tr>
<td>randomEffectsMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculates the variance covariance matrix for a multivariate normal vector when there are random effects.
</h2>

<h3>Description</h3>

<p>Computes the variance covariance matrix of an <code class="reqn">m</code> vector which results from a random effects model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">randomEffectsMatrix(zMatrix, vs, sigma2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zMatrix</code></td>
<td>

<p>An <code class="reqn">m X p</code> design matrix which specifies how <code class="reqn">p</code> random variables with zero mean are linearly related to the m-dimensional normal vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vs</code></td>
<td>

<p>The <code class="reqn">p X p</code> variance covariance matrix of the random effects,
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>

<p>The error variance.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We assume that <code class="reqn">y_{t}=\mu_t+\Sigma \gamma_j z_{t,j}+\sigma^2 \epsilon</code>,
where <code class="reqn">\gamma_j</code> are random variables with mean <code class="reqn">0</code> and and variance covariance <code>vs</code>, and <code class="reqn">z</code> is <code>zMatrix</code>, <code class="reqn">\epsilon</code> is a standard normal random variable.
The <code>zMatrix</code> could be a list of matricies
</p>


<h3>Value</h3>

<p>Either a single variance covariance matrix or a list of them if zMatrix is a list.
</p>


<h3>Author(s)</h3>

<p>David A. Schoenfeld
</p>


<h3>See Also</h3>

<p><code>LPower</code>,<code>randomSlopesMatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> #Creates random variance covariance matrix for random follow up model
 #where baseline is random among patients and all follow up have a compound symetry structure
 #from a common random effect
vars=randomEffectsMatrix(cbind(rep(1,5),matrix(c(0,rep(1,4)),5,1)),
            matrix(c(31.8,.8527,.8527,.6687),2,2),2.7085)
LPower(sample_size=40,power=.8,
          xMatrix=list(cbind(1,c(0,rep(1,4)),0),cbind(1,c(0,rep(1,4)),c(0,rep(1,4)))),vMatrix=vars)
#Creates random variance covariance matrix for random slopes model
vars=randomEffectsMatrix(cbind(rep(1,5),0:4),
            matrix(c(31.8,.8527,.8527,.6687),2,2),2.7085)
LPower(sample_size=40,power=.8,
       xMatrix=list(cbind(1,0:4,0),cbind(1,0:4,0:4)),vMatrix=vars)

</code></pre>


</div>