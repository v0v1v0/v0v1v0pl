<div class="container">

<table style="width: 100%;"><tr>
<td>BestM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Chooses the size of the polynomial basis</h2>

<h3>Description</h3>

<p>Computes the deviance p-values considering different sizes of the polynomial basis and selects the one for which the deviance p-value is the smallest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BestM(data, g, Mmax = 20, range = c(min(data),max(data)))</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A vector of data. See details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>The postulated model from which we want to assess if deviations occur.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mmax</code></td>
<td>
<p>The maximum size of the polynomial basis from which a suitable value <code>M</code> is selected (the default is 20). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>Range of the data/ search region considered. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument <code>data</code> collects the data for which we want to test if deviations occur from the postulated model specified in the argument <code>g</code>. As in Algeri, 2019, the sample specified under <code>data</code> corresponds to the source-free sample in the background calibration phase and to the physics sample in the signal search phase.
The value <code>M</code> selected determines the smoothness of the estimated comparison density, with smaller values of M leading to smoother estimates. The deviance test is used to select the value <code>M</code> which leads to the most significant deviation from the postulated model. The default value for <code>Mmax</code> is set to 20. Notice that numerical issues may
arise for larger values of <code>Mmax</code>.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pvals</code></td>
<td>
<p>The deviance test p-value obtained for each values of <code>M</code> (from 1 to <code>Mmax</code>) considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minp</code></td>
<td>
<p>The minimum value of the deviance p-values observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Msel</code></td>
<td>
<p>The value of <code>M</code> at which the minimum deviance p-values is achieved.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sara Algeri</p>


<h3>References</h3>

<p>S. Algeri, 2019. Detecting new signals under background mismodelling	&lt;arXiv:1906.06615&gt;. </p>


<h3>See Also</h3>

<p><code>denoise</code>, <code>dhatL2</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Generating data
x&lt;-rnorm(1000,10,7)
data&lt;-x[x&gt;=10 &amp; x&lt;=20]

#Create suitable postulated quantile function of data
G&lt;-pnorm(20,5,15)-pnorm(10,5,15)
g&lt;-function(x){dnorm(x,5,15)/G}

Mmax=10
range=c(10,20)

BestM(data,g,Mmax,range)

</code></pre>


</div>