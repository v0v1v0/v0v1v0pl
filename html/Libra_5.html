<div class="container">

<table style="width: 100%;"><tr>
<td>ising</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linearized Bregman solver for composite conditionally likelihood of Ising model 
with lasso penalty.</h2>

<h3>Description</h3>

<p>Solver for the entire solution path of coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ising(
  X,
  kappa,
  alpha,
  c = 2,
  tlist,
  responses = c(-1, 1),
  nt = 100,
  trate = 100,
  intercept = TRUE,
  print = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An n-by-p matrix of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>The damping factor of the Linearized Bregman Algorithm that is
defined in the reference paper. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Parameter in Linearized Bregman algorithm which controls the 
step-length of the discretized solver for the Bregman Inverse Scale Space. 
See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Normalized step-length. If alpha is missing, alpha is automatically generated by 
<code>alpha=c*n/(kappa*||X^T*X||_2)</code>. Default is 2. It should be in (0,4).
If beyond this range the path may be oscillated at large t values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlist</code></td>
<td>
<p>Parameters t along the path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>responses</code></td>
<td>
<p>The type of data. c(0,1) or c(-1,1), Default is c(-1,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nt</code></td>
<td>
<p>Number of t. Used only if tlist is missing. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trate</code></td>
<td>
<p>tmax/tmin. Used only if tlist is missing. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>if TRUE, an intercept is included in the model (and not 
penalized), otherwise no intercept is included. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>If TRUE, the percentage of finished computation is printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data matrix X is assumed in {1,-1}. The Ising model here used is described as following:<br></p>
<p style="text-align: center;"><code class="reqn">P(x) \sim \exp(\sum_i \frac{a_{0i}}{2}x_i + x^T \Theta x/4)</code>
</p>
<p><br>
where <code class="reqn">\Theta</code> is p-by-p symmetric and 0 on diagnal. Then conditional on <code class="reqn">x_{-j}</code><br></p>
<p style="text-align: center;"><code class="reqn">\frac{P(x_j=1)}{P(x_j=-1)} = exp(\sum_i a_{0i} + \sum_{i\neq j}\theta_{ji}x_i)</code>
</p>
<p><br>
then the composite conditional likelihood is like this:<br></p>
<p style="text-align: center;"><code class="reqn">- \sum_{j} condloglik(X_j | X_{-j})</code>
</p>



<h3>Value</h3>

<p>A "ising" class object is returned. The list contains the call, 
the path, the intercept term a0 and value for alpha, kappa, t.
</p>


<h3>Author(s)</h3>

<p>Jiechao Xiong
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library('Libra')
library('igraph')
data('west10')
X &lt;- as.matrix(2*west10-1);
obj = ising(X,10,0.1,nt=1000,trate=100)
g&lt;-graph.adjacency(obj$path[,,770],mode="undirected",weighted=TRUE)
E(g)[E(g)$weight&lt;0]$color&lt;-"red"
E(g)[E(g)$weight&gt;0]$color&lt;-"green"
V(g)$name&lt;-attributes(west10)$names
plot(g,vertex.shape="rectangle",vertex.size=35,vertex.label=V(g)$name,
edge.width=2*abs(E(g)$weight),main="Ising Model (LB): sparsity=0.51")
</code></pre>


</div>