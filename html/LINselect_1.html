<div class="container">

<table style="width: 100%;"><tr>
<td>penalty</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>penalty</h2>

<h3>Description</h3>

<p>Calculate the penalty function for estimators selection.</p>


<h3>Usage</h3>

<pre><code class="language-R">penalty(Delta, n, p, K)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>vector with <code>Dmax</code>+1 components : weights in the penalty function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer : number of observatons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer : number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>scalar : constant in the penalty function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector with the same length as Delta: for each <code>d</code>=0, ..., <code>Dmax</code>, let
<code>N</code>=<code>n</code>-<code>d</code>, <code>D</code>=<code>d+1</code> and <br><code>pen(d) = x K N/(N-1)</code> where  <code>x</code> satisfies
<br><br><code class="reqn">\phi</code><code>(x) = exp(-Delta(d))</code>, when <code>Delta(d)&lt;50</code>, 
<br>
where  <code class="reqn">\phi</code><code>(x)=pf(q=x/(D+2),df1=D+2,df2=N-1,lower.tail=F)-(x/D)pf(q=(N+1)x/D(N-1),df1=D,df2=N+1,lower.tail=F)</code>
<br><br><code class="reqn">\psi</code><code>(x) = Delta(d)</code>, when
<code>Delta(d)</code><code class="reqn">\ge</code><code>50</code>, <br>
where  <code class="reqn">\psi</code><code>(x)=lbeta(1+D/2,(N-1)/2)-log(2(2x+(N-1)D)/((N-1)(N+2)x))-(N-1)/2log((N-1)/(N-1+x))-(D/2)log(x/(N-1+x))
</code></p>


<h3>Note</h3>

<p>The values of the penalty function greater than
1e+08 are set to 1e+08.
</p>
<p>If for some <code>Delta(d)</code> the
equation <code class="reqn">\phi</code><code>(x) = exp(-Delta(d)/(d+1))</code>  has no
solution, then the execution is stopped.</p>


<h3>Author(s)</h3>

<p>Yannick Baraud, Christophe Giraud, Sylvie Huet</p>


</div>