<div class="container">

<table style="width: 100%;"><tr>
<td>logLikNB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Log-Likelihood for a Right-Truncated Negative Binomial Model</h2>

<h3>Description</h3>

<p>This function calculates the log-likelihood of observing the given data under a 
right-truncated negative binomial distribution. It is used to assess the fit of 
a model involving delay times in reporting cases, where each case has a 
delay modeled by a negative binomial distribution that is truncated at a specified maximum delay.
</p>


<h3>Usage</h3>

<pre><code class="language-R">logLikNB(delay_vec, x12, disp, betaplus, maxdelay)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>delay_vec</code></td>
<td>
<p>NumericVector representing the observed delay times for each case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x12</code></td>
<td>
<p>NumericMatrix of covariates used to model the mean of the negative binomial distribution.
Each row corresponds to a case and columns correspond to covariates including time since onset and others.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp</code></td>
<td>
<p>NumericVector indicating the dispersion parameter for each case. This can affect the distribution 
of counts and is used to model heterogeneity in reporting delays.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaplus</code></td>
<td>
<p>NumericVector containing current estimates of the model parameters, which may include 
coefficients for covariates and additional parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdelay</code></td>
<td>
<p>Integer specifying the maximum reporting delay, truncating the distribution at this value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes the log-likelihood by calculating the likelihood of each observed 
delay under the specified model parameters, considering the truncation at 'maxdelay'. 
The parameters 'disp' and 'betaplus' allow for flexibility in modeling different types of 
heterogeneity and covariate effects.
</p>


<h3>Value</h3>

<p>Double representing the log-likelihood of the data given the model parameters. This value 
measures how well the model with the current parameter estimates fits the observed data.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example usage with arbitrary data:
delay_vec &lt;- rnorm(100, mean=10, sd=3)  # Simulated delay times
x12 &lt;- matrix(rnorm(300), ncol=3)       # Simulated covariates
disp &lt;- rep(1, 100)                     # Dispersion parameter, constant for simplicity
betaplus &lt;- runif(4)                    # Simulated parameter estimates
maxdelay &lt;- 15                          # Maximum delay for truncation
loglik_value &lt;- logLikNB(delay_vec, x12, disp, betaplus, maxdelay)
</code></pre>


</div>