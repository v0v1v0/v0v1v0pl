<div class="container">

<table style="width: 100%;"><tr>
<td>corplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot local correlation maps</h2>

<h3>Description</h3>

<p>Plot the estimated local correlation map (or local <em>partial</em> correlation
map) for a pair of variables
</p>


<h3>Usage</h3>

<pre><code class="language-R">corplot(dlg_object, pair = 1, gaussian_scale = FALSE,
  plot_colormap = TRUE, plot_obs = FALSE, plot_labels = TRUE,
  plot_legend = FALSE, plot_thres = 0, alpha_tile = 0.8,
  alpha_point = 0.8, low_color = "blue", high_color = "red",
  break_int = 0.2, label_size = 3, font_family = "sans",
  point_size = NULL, xlim = NULL, ylim = NULL, xlab = NULL,
  ylab = NULL, rholab = NULL, main = NULL, subtitle = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dlg_object</code></td>
<td>
<p>The density estimation object produced by the dlg-function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pair</code></td>
<td>
<p>Integer indicating which pair of variables you want to plot. The
function looks up the corresponding variables in the bandwidth object used
to calculate the dlg object, and you can inspect this in
<code>dlg_object$bw$joint</code>. Defaults to 1 (the first pair, usually variable
1 against variable 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gaussian_scale</code></td>
<td>
<p>Logical, if <code>TRUE</code> the plot is produced on the
marginal standard Gaussian scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_colormap</code></td>
<td>
<p>Logical, if <code>TRUE</code> the plot includes a colormap to
visualize the value of the local correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_obs</code></td>
<td>
<p>Logical, if <code>TRUE</code> the observations are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_labels</code></td>
<td>
<p>Logical, if <code>TRUE</code> character labels with local
correlation values are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_legend</code></td>
<td>
<p>Logical, if <code>TRUE</code> a color legend is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_thres</code></td>
<td>
<p>A number between 0 and 1 indicating the threshold value to
be used for not plotting the estimated local correlation in areas with no
data. Uses a quick bivariate kernel density estimate a criterion, and skips
plotting in areas with kernel density estimate less than the fraction
plot_thres of the maximum density estimate. If 0 (default), everything is
plotted, if 1 nothing is plotted. Typical values may be in the
0.001-0.01-range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_tile</code></td>
<td>
<p>The alpha-value indicating the transparency of the color
tiles. Number between 0 (transparent) and 1 (not transparent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_point</code></td>
<td>
<p>he alpha-value indicating the transparency of the
observations. Number between 0 (transparent) and 1 (not transparent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low_color</code></td>
<td>
<p>The color corresponding to correlation equal to -1 (default:
blue).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high_color</code></td>
<td>
<p>The color corresponding to correlation equal to 1 (default:
red).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>break_int</code></td>
<td>
<p>Break interval in the color gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_size</code></td>
<td>
<p>Size of text labels, if plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_family</code></td>
<td>
<p>Font family used for text labels, if plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point_size</code></td>
<td>
<p>Size of points used for plotting the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>x-limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rholab</code></td>
<td>
<p>Label for the legend, if plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Title of plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>
<p>Subtitle of plot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function plots a map of estimated local Gaussian correlations of a
specified pair (defaults to the first pair) of variables as produced by the
dlg-function. This plot is heavily inspired by the local correlation plots
produced by the 'localgauss'-package by Berentsen et. al (2014), but it is
here more easily customized and specially adapted to the ecosystem within the
<code>lg</code>-package. The plotting is carried out using the ggplot2-package
(Wickham, 2009). This function now also accepts objects created by the
<code>partial_cor()</code>-function, in order to create local <em>partial</em>
correlation maps.
</p>


<h3>References</h3>

<p>Berentsen, G. D., Kleppe, T. S., &amp; Tj√∏stheim, D. (2014). Introducing
localgauss, an R package for estimating and visualizing local Gaussian
correlation. Journal of Statistical Software, 56(1), 1-18.
</p>
<p>H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New
York, 2009.
</p>


</div>