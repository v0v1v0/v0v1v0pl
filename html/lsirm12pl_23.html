<div class="container">

<table style="width: 100%;"><tr>
<td>lsirm1pl_normal_ss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>1PL LSIRM with normal likelihood and model selection approach.</h2>

<h3>Description</h3>

<p>lsirm1pl_normal_ss is used to fit LSIRM with model selection approach based on spike-and-slab priors for continuous variable with 1pl.
LSIRM factorizes continuous item response matrix into column-wise item effect, row-wise respondent effect and further embeds interaction effect in a latent space. The resulting latent space provides an interaction map that represents interactions between respondents and items.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lsirm1pl_normal_ss(
  data,
  ndim = 2,
  niter = 15000,
  nburn = 2500,
  nthin = 5,
  nprint = 500,
  jump_beta = 0.4,
  jump_theta = 1,
  jump_gamma = 1,
  jump_z = 0.5,
  jump_w = 0.5,
  pr_mean_beta = 0,
  pr_sd_beta = 1,
  pr_mean_theta = 0,
  pr_spike_mean = -3,
  pr_spike_sd = 1,
  pr_slab_mean = 0.5,
  pr_slab_sd = 1,
  pr_a_theta = 0.001,
  pr_b_theta = 0.001,
  pr_a_eps = 0.001,
  pr_b_eps = 0.001,
  pr_xi_a = 0.001,
  pr_xi_b = 0.001,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Matrix; a binary or continuous item response matrix for analysis. Each row represents a respondent, and each column contains responses to the corresponding item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndim</code></td>
<td>
<p>Integer; the dimension of the latent space. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Integer; the total number of MCMC iterations to run. Default is 15000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>Integer; the number of initial MCMC iterations to discard as burn-in. Default is 2500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthin</code></td>
<td>
<p>Integer; the number of MCMC iterations to thin. Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nprint</code></td>
<td>
<p>Integer; the interval at which MCMC samples are displayed during execution. Default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_beta</code></td>
<td>
<p>Numeric; the jumping rule for the beta proposal density. Default is 0.4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_theta</code></td>
<td>
<p>Numeric; the jumping rule for the theta proposal density. Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_gamma</code></td>
<td>
<p>Numeric; the jumping rule for the theta proposal density. Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_z</code></td>
<td>
<p>Numeric; the jumping rule for the z proposal density. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_w</code></td>
<td>
<p>Numeric; the jumping rule for the w proposal density. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_mean_beta</code></td>
<td>
<p>Numeric; the mean of the normal prior for beta. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_sd_beta</code></td>
<td>
<p>Numeric; the standard deviation of the normal prior for beta. Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_mean_theta</code></td>
<td>
<p>Numeric; the mean of the normal prior for theta. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_spike_mean</code></td>
<td>
<p>Numeric; mean of spike prior for log gamma default value is -3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_spike_sd</code></td>
<td>
<p>Numeric; standard deviation of spike prior for log gamma default value is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_slab_mean</code></td>
<td>
<p>Numeric; mean of spike prior for log gamma default value is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_slab_sd</code></td>
<td>
<p>Numeric; standard deviation of spike prior for log gamma default value is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_a_theta</code></td>
<td>
<p>Numeric; the shape parameter of the inverse gamma prior for the variance of theta. Default is 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_b_theta</code></td>
<td>
<p>Numeric; the scale parameter of the inverse gamma prior for the variance of theta. Default is 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_a_eps</code></td>
<td>
<p>Numeric; shape parameter of inverse gamma prior for variance of data likelihood. Default is 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_b_eps</code></td>
<td>
<p>Numeric; scale parameter of inverse gamma prior for variance of data likelihood. Default is 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_xi_a</code></td>
<td>
<p>Numeric; first shape parameter of beta prior for latent variable xi. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_xi_b</code></td>
<td>
<p>Numeric; second shape parameter of beta prior for latent variable xi. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical; If TRUE, MCMC samples are printed for each <code>nprint</code>. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lsirm1pl_normal_ss</code> models the continuous value of response by respondent <code class="reqn">j</code> to item <code class="reqn">i</code> with item effect <code class="reqn">\beta_i</code>, respondent effect <code class="reqn">\theta_j</code> and the distance between latent position <code class="reqn">w_i</code> of item <code class="reqn">i</code> and latent position <code class="reqn">z_j</code> of respondent <code class="reqn">j</code> in the shared metric space, with <code class="reqn">\gamma</code> represents the weight of the distance term: </p>
<p style="text-align: center;"><code class="reqn">Y_{j,i} = \theta_j+\beta_i-\gamma||z_j-w_i|| + e_{j,i}</code>
</p>
<p> where the error <code class="reqn">e_{j,i} \sim N(0,\sigma^2)</code>. <code>lsrm1pl_noraml_ss</code> model include model selection approach based on spike-and-slab priors for log gamma. For detail of spike-and-slab priors, see References.
</p>


<h3>Value</h3>

<p><code>lsirm1pl_normal_ss</code> returns an object of  list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame or matrix containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>Numeric value with the corresponding BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc_inf</code></td>
<td>
<p>number of mcmc iteration, burn-in periods, and thinning intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_inf</code></td>
<td>
<p>value of log maximum a posterior and iteration number which have log maximum a posterior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_estimate</code></td>
<td>
<p>posterior estimation of beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_estimate</code></td>
<td>
<p>posterior estimation of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_theta_estimate</code></td>
<td>
<p>posterior estimation of standard deviation of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_estimate</code></td>
<td>
<p>posterior estimation of standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_estimate</code></td>
<td>
<p>posterior estimation of gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_estimate</code></td>
<td>
<p>posterior estimation of z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_estimate</code></td>
<td>
<p>posterior estimation of w.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_estimate</code></td>
<td>
<p>posterior estimation of phi. inclusion probability of gamma. if estimation of phi is less than 0.5, choose Rasch model with gamma = 0, otherwise latent space model with gamma &gt; 0. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>posterior samples of beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>posterior samples of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_sd</code></td>
<td>
<p>posterior samples of standard deviation of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>posterior samples of standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>posterior samples of gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>posterior samples of z. The output is 3-dimensional matrix with last axis represent the dimension of latent space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>posterior samples of w. The output is 3-dimensional matrix with last axis represent the dimension of latent space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>posterior samples of phi which is indicator of spike and slab prior. If phi is 1, log gamma follows the slab prior, otherwise follows the spike prior. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_beta</code></td>
<td>
<p>accept ratio of beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_theta</code></td>
<td>
<p>accept ratio of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_w</code></td>
<td>
<p>accept ratio of w.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_z</code></td>
<td>
<p>accept ratio of z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_gamma</code></td>
<td>
<p>accept ratio of gamma.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ishwaran, H., &amp; Rao, J. S. (2005). Spike and slab variable selection: Frequentist and Bayesian strategies (Vol. 33). The Annals of Statistics
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate example (continuous) item response matrix
data     &lt;- matrix(rnorm(500, mean = 0, sd = 1),ncol=10,nrow=50)

lsirm_result &lt;- lsirm1pl_normal_ss(data)

# The code following can achieve the same result.
lsirm_result &lt;- lsirm(data ~ lsirm1pl(spikenslab = TRUE, fixed_gamma = FALSE))

</code></pre>


</div>