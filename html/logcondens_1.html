<div class="container">

<table style="width: 100%;"><tr>
<td>logcon-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate a Log-Concave Probability Density from iid Observations</h2>

<h3>Description</h3>

<p>The main function of this package is <code>logConDens</code>: compute the maximum likelihood estimator (MLE) of a log-concave density from one-dimensional i.i.d. observations as well as the kernel smoothed version derived from it. A list of additional functions that can be used to compute quantities relevant in that context can be found below.
</p>
<p>Two algorithms are offered to compute the estimate: An active set (<code>logConDens</code>) and an iterative algorithm based on the pool-adjacent-violaters algorithm (<code>icmaLogCon</code>). The latter of these functions is only part of this package for historical reasons: it was the first method that was proposed to estimate a log-concave density, see Rufibach (2007). The more efficient way of computing the estimate is via an active set algorithm. The smoothed versions of the log-concave density and distribution function estimates discussed in Section 3 of Duembgen and Rufibach (2009) are available in the function <code>evaluateLogConDens</code>.
</p>
<p>To compute a log-concave density, CDF, and survival function from interval- or right-censored observations use the package <span class="pkg">logconcens</span>. A log-concave probability mass function can be computed using the package <span class="pkg">logcondiscr</span>, see Balabdaoui et al (2012) for details. For the computation of a log-concave estimate in any dimension the package <span class="pkg">LogConDEAD</span> can be used.</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> logcondens</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 2.1.8 </td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2023-08-21 </td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;=2) </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The following additional functions and datasets are provided in the package:
</p>
<p><code>evaluateLogConDens</code> Computes the value of the estimated log-density, density, and distribution function
of the MLE and the smoothed estimator at a given <code>x0</code>.
</p>
<p><code>quantilesLogConDens</code> Computes quantiles of the estimated distribution function at a given <code>x0</code>.
</p>
<p><code>intECDF</code> Compute the integrated empirical distribution function of the observations at a given <code>x0</code>.
</p>
<p><code>intF</code> Compute the integral of the distribution function corresponding to the log-concave density
estimator at a given <code>x0</code>.
</p>
<p><code>logconTwoSample</code> Compute a permutation test for the difference between two distribution functions.
</p>
<p><code>logConROC</code> Compute ROC curve based on log-concave density estimates within cases and controls.
</p>
<p><code>confIntBootLogConROC_t0</code> Compute bootstrap confidence intervals at given false positive fractions (= 1 - specificity) for the ROC curve based on log-concave density estimates.
</p>
<p><code>logConCI</code> Compute a confidence interval for the value of the true density at a fixed point, based on the theory developed in Balabdaoui et al (2009). This function was contributed by Mahdis Azadbakhsh and Hanna Jankowski, see Azadbakhsh et al (2012).
</p>
<p><code>isoMean</code> Compute the weighted least squares regression under a monotonicity constraint (the Grenander estimator).
This function is used as part of <code>icmaLogCon</code> but is also of independent interest.
</p>
<p>The following datasets have been used in several publications to illustrate log-concave density estimation and are
therefore included in this package:
</p>
<p><code>reliability</code> Dataset that contains the data analyzed in Duembgen and Rufibach (2009, Figure 2).
See the help file for <code>logConDens</code> for the analysis of this data.
</p>
<p><code>brightstar</code> Dataset that contains the data analyzed in Mizera and Koenker (2009, Section 5). The
sample consists of measurements of radial and rotational velocities for the stars from the Bright Star Catalog, see
Hoffleit and Warren (1991).
</p>
<p><code>pancreas</code> Data from pancreatic cancer serum biomarker study, first published by Wieand et al (1989).
Contains data on serum measurements for a cancer antigen (CA-125) and
a carbohydrate antigen (CA19.9) both of which are measured on a continuous non-negative scale. The measurements were taken within a case-control
study on 90 cases with pancreatic cancer and 51 controls who did not have cancer but pancreatitis.
</p>
<p>A <code>print</code> and <code>summary</code> for objects of class <code>dlc</code>, generated by  <code>logConDens</code>, are available as well.
</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Lutz Duembgen, <a href="mailto:duembgen@stat.unibe.ch">duembgen@stat.unibe.ch</a>, <br><a href="https://www.imsv.unibe.ch/about_us/staff/prof_dr_duembgen_lutz/index_eng.html">https://www.imsv.unibe.ch/about_us/staff/prof_dr_duembgen_lutz/index_eng.html</a>
</p>
<p>Kaspar Rufibach gratefully acknowledges support by the Swiss National Science Foundation SNF, <a href="http://www.snf.ch">http://www.snf.ch</a>.
</p>
<p>MatLab code with an implementation of the active set algorithm is available on request from Lutz Duembgen.</p>


<h3>References</h3>

<p>Azadbakhsh, M., Jankowski, H. and Gao, X. (2014).
Computing confidence intervals for log-concave densities.
<em>Comput. Statist. Data Anal.</em>, <b>75</b>, 248–264.
</p>
<p>Balabdaoui, F., Jankowski, H., Rufibach, K. and Pavlides, M. (2012).
Asymptotics of the discrete log-concave maximum likelihood estimator and related applications.
<em>J. R. Stat. Soc. Ser. B Stat. Methodol.</em>, <b>75(4)</b>, 769–790.
</p>
<p>Baladbaoui, F., Rufibach, K. and Wellner, J. (2009).
Limit distribution theory for maximum likelihood estimation of a log-concave density.
<em>Ann. Statist.</em>, <b>37(3)</b>, 1299–1331.
</p>
<p>Duembgen, L., Huesler, A. and Rufibach, K. (2010).
Active set and EM algorithms for log-concave densities based on complete and censored data.
Technical report 61, IMSV, Univ. of Bern, available at <a href="https://arxiv.org/abs/0707.4643">https://arxiv.org/abs/0707.4643</a>.
</p>
<p>Duembgen, L. and Rufibach, K. (2009).
Maximum likelihood estimation of a log–concave density and its distribution function: basic properties and uniform consistency.
<em>Bernoulli</em>, <b>15(1)</b>, 40–68.
</p>
<p>Duembgen, L. and Rufibach, K. (2011).
logcondens: Computations Related to Univariate Log-Concave Density Estimation.
<em>Journal of Statistical Software</em>, <b>39(6)</b>, 1–28. <a href="https://doi.org/10.18637/jss.v039.i06">doi:10.18637/jss.v039.i06</a>
</p>
<p>Hoffleit, D., Warren, W.H. (1991).
<em>The Bright Star Catalog.</em>
Yale University Observatory, New Heaven.
</p>
<p>Mizera, I., Koenker, R. (2010).
Quasi-concave density estimation.
<em>Ann. Statist.</em>, <b>38(5)</b>, 2998–3027.
</p>
<p>Rufibach K. (2006).
<em>Log-concave Density Estimation and Bump Hunting for i.i.d. Observations.</em>
PhD Thesis, University of Bern, Switzerland and Georg-August University of Goettingen, Germany, 2006.
<br> Available at <a href="https://slsp-ube.primo.exlibrisgroup.com/permalink/41SLSP_UBE/17e6d97/alma99116730175505511">https://slsp-ube.primo.exlibrisgroup.com/permalink/41SLSP_UBE/17e6d97/alma99116730175505511</a>.
</p>
<p>Rufibach, K. (2007).
Computing maximum likelihood estimators of a log-concave density function.
<em>J. Stat. Comput. Simul.</em> <b>77</b>, 561–574.
</p>
<p>Rufibach, K. (2012).
A smooth ROC curve estimator based on log-concave density estimates.
<em>Int. J. Biostat.</em>, <b>8</b>(1), 1–29.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## estimate gamma density
set.seed(1977)
x &lt;- rgamma(100, 2, 1)
res &lt;- logConDens(x, smoothed = FALSE, print = TRUE)
summary(res)

## compare performance to ICMA
res2 &lt;- icmaLogCon(x, T1 = 2000, robustif = TRUE, print = TRUE)

res$L
res2$L

## plot resulting functions
par(mfrow = c(2, 2), mar = c(3, 2, 1, 2))
plot(res, which = "density")
plot(res, which = "log-density")
plot(res, which = "CDF")
xli &lt;- range(res$x) + 0.1 * c(-1, 1) * diff(range(res$x))
plot(res$x, res$H, type = 'l', xlim = xli, yli = c(min(res$H) * 1.1, 0))
segments(res$knots, 0, res$knots, min(res$H) * 1.1, lty = 2)
rug(res$x); abline(h = 0, lty = 2)

## compute function values at an arbitrary point
x0 &lt;- (res$x[50] + res$x[51]) / 2
evaluateLogConDens(x0, res)

## compute 0.5 quantile of Fhat
quantilesLogConDens(0.5, res)
</code></pre>


</div>