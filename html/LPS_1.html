<div class="container">

<table style="width: 100%;"><tr>
<td>clusterize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Hierarchical clustering heat maps
</h2>

<h3>Description</h3>

<p>This function draws a heat map ordered according to hierarchical clusterings, similarly to <code>heatmap</code>. It offers more control on layout and allows multiple row annotations.
</p>
<p><code>hclust.ward</code> is derivated from 'stats' package <code>hclust</code>, with an alternative default (as arguments can not be passed to it).
</p>
<p><code>dist.COR</code> mimics 'stats' package <code>dist</code>, computing distances as 1 - Pearson's correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  clusterize(expr, side = NULL, cex.col = NA, cex.row = NA, mai.left = NA,
    mai.bottom = NA, mai.right = 0.1, mai.top = 0.1, side.height = 1, side.col = NULL,
    side.srt = 0, side.cex = 1, col.heatmap = heat(), zlim = "0 centered",
	zlim.trim = 0.02, norm = c("rows", "columns", "none"), norm.clust = TRUE,
	norm.robust = FALSE, customLayout = FALSE, getLayout = FALSE, plot = TRUE,
	widths = c(1, 4), heights = c(1, 4), order.genes = NULL, order.samples = NULL,
	fun.dist = dist.COR, fun.hclust = hclust.ward, clust.genes = NULL,
	clust.samples = NULL)
  dist.COR(input)
  hclust.ward(input)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>

<p>A numeric matrix, holding features (genes) in columns and observations (samples) in rows. Rows and columns will be ordered according to hierarchical clustering results.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.col</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.row</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mai.left</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mai.bottom</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mai.right</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mai.top</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side.height</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side.col</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side.srt</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side.cex</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.heatmap</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim.trim</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm.clust</code></td>
<td>

<p>Single logical value, whether to apply normalization before clustering or after. Normalization applied depends on <code>norm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm.robust</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>customLayout</code></td>
<td>

<p>Single logical value, as <code>layout</code> does not allow nested calls, set this to TRUE to make your own call to layout and embed this plot in a wider one.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>getLayout</code></td>
<td>

<p>Single logical value, whether to only return the <code>layout</code> arguments that would be used with the set of arguments provided or not. It can prove useful to build custom layouts, e.g. merging this plot to an other. See also <code>customLayout</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>To be passed to <code>heat.map</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>widths</code></td>
<td>

<p>To be passed to <code>layout</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heights</code></td>
<td>

<p>To be passed to <code>layout</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.genes</code></td>
<td>

<p>A function taking the gene dendrogram and <code>expr</code> as arguments, and returning the same dendrogram ordered in a custom way.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.samples</code></td>
<td>

<p>A function taking the sample dendrogram and <code>expr</code> as arguments, and returning the same dendrogram ordered in a custom way.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun.dist</code></td>
<td>

<p>A function to be used for distance computation in clustering. Default value uses 1 - Pearson's correlation as distance. See <code>dist</code> for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun.hclust</code></td>
<td>

<p>A function to be used for agglomeration in clustering. See <code>hclust</code> for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust.genes</code></td>
<td>

<p>If not <code>NULL</code>, an object coercible to the <code>dendrogram</code> class (typically the output from <code>hclust()</code>) to use instead of a fresh hierarchical clustering of genes. The <code>FALSE</code> value can also be used to disable computation and/or plotting of the dendrogram.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust.samples</code></td>
<td>

<p>If not <code>NULL</code>, an object coercible to the <code>dendrogram</code> class (typically the output from <code>hclust()</code>) to use instead of a fresh hierarchical clustering of samples. The <code>FALSE</code> value can also be used to disable computation and/or plotting of the dendrogram.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>

<p>See <code>hclust</code> and <code>dist</code> respectively for further details.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>clusterize</code> invisibly returns the same list as <code>heat.map</code>, plus :
</p>
<table>
<tr style="vertical-align: top;">
<td><code>genes</code></td>
<td>
<p>The gene dendrogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>The sample dendrogram.</p>
</td>
</tr>
</table>
<p>See <code>hclust</code> and <code>dist</code> respectively for the other functions.
</p>


<h3>Author(s)</h3>

<p>Sylvain Mareschal
</p>


<h3>See Also</h3>

<p><code>heat.map</code>, <code>heatmap</code>, <code>hclust</code>, <code>dist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Data with features in columns
  data(rosenwald)
  group &lt;- rosenwald.cli$group
  expr &lt;- t(rosenwald.expr)[,1:100]
  
  # NA imputation (feature's mean to minimize impact)
  f &lt;- function(x) { x[ is.na(x) ] &lt;- round(mean(x, na.rm=TRUE), 3); x }
  expr &lt;- apply(expr, 2, f)
  
  # Simple heat map
  clusterize(expr)
  
  # With annotation (row named data.frame)
  side &lt;- data.frame(group, row.names=rownames(expr))
  clusterize(expr, side=side)
</code></pre>


</div>