<div class="container">

<table style="width: 100%;"><tr>
<td>plot.dsvord</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting Routines For LabDSV Ordinations</h2>

<h3>Description</h3>

<p>A set of routines for plotting, highlighting points,
or adding fitted surfaces to ordinations.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'dsvord'
plot(x, ax = 1, ay = 2, col = 1, title = "", pch = 1,
                     xlab = paste(x$type, ax), ylab = paste(x$type, ay), ...)
## S3 method for class 'dsvord'
points(x, which, ax = 1, ay = 2, col = 2, pch = 1, cex = 1, 
                      breaks=FALSE, ...)
## S3 method for class 'dsvord'
plotid(ord, ids = seq(1:nrow(ord$points)), ax = 1, ay = 2,
       col = 1, ...)
## S3 method for class 'dsvord'
hilight(ord, overlay, ax = 1, ay = 2, title="", 
        cols=c(2,3,4,5,6,7), glyph=c(1,3,5), ...)
## S3 method for class 'dsvord'
chullord(ord, overlay, ax = 1, ay = 2, cols=c(2,3,4,5,6,7), 
        ltys = c(1,2,3), ...)
## S3 method for class 'dsvord'
ellip(ord, overlay, ax = 1, ay = 2, cols=c(2,3,4,5,6,7),
        ltys = c(1,2,3), ...)
## S3 method for class 'dsvord'
surf(ord, var, ax = 1, ay = 2, thinplate = TRUE, col = 2, 
        labcex = 0.8, lty = 1, family = gaussian, gamma=1, grid=50, ...)
## S3 method for class 'dsvord'
thull(ord,var,grain,ax=1,ay=2,col=2,grid=51,nlevels=5,
        levels=NULL,lty=1,
     numitr=100,...)
## S3 method for class 'dsvord'
density(ord, overlay, ax = 1, ay = 2, cols = c(2, 3, 4, 5,
    6, 7), ltys = c(1, 2, 3), numitr, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class ‘dsvord’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ax</code></td>
<td>
<p>the dimension to use for the X axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ay</code></td>
<td>
<p>the dimension to use for the Y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a title for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label for X axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label for Y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>a logical variable to specify points to be highlighted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>a logical switch to control using variable glyph sizes in ‘points’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>an object of class ‘dsvord’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlay</code></td>
<td>
<p>a factor or integer vector to hilight or distinguish</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>the sequence of color indices to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glyph</code></td>
<td>
<p>the sequence of glyphs (pch) to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>the line type to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltys</code></td>
<td>
<p>the sequence of line types to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>a variable to be surfaced or tension hulled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinplate</code></td>
<td>
<p>a logical variable to control the fitting routine: thinplate=TRUE
(the default) fits a thinplate spline, thinplate=FALSE fits
independent smooth splines.  If you have too few data points you may 
have to specify thinplate=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>controls the link function passed to ‘gam’:
one of ‘gaussian’, ‘binomial’, ‘poisson’ or ‘nb’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>controls the smoothness of the fit from <code>gam</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>the number of X and Y values to use in establishing a grid for
use in surf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grain</code></td>
<td>
<p>the size of cell to use in calculating the tensioned hull</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>the number of contours to draw in representing the tensioned hull</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>identifier labels for samples.  Defaults to 1:n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color index for points or contours</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labcex</code></td>
<td>
<p>size of contour interval labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>plot character: glyph to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>character expansion factor: size of plotted characters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numitr</code></td>
<td>
<p>the number of iterations to use in estimating the probability of the observed density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>specific levels for contours in thull</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to pass to the plot function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function ‘plot’ produces a scatter plot of sample
scores for the specified axes, erasing or over-plotting
on the current graphic device.  Axes dimensions are controlled to produce
a graph with the correct aspect ratio.
Functions ‘points’, ‘plotid’, and ‘surf’
add detail to an existing plot.  The axes specified must
match the underlying plot exactly.
</p>
<p>Function ‘plotid’ identifies
and labels samples (optionally with values from a third vector)
in the ordination, and requires interaction with the mouse:
left button identifies, right button exits.
</p>
<p>Function ‘points’ is passed a logical
vector to identify a set of samples by color of glyph.  It can be used
to identify a single set meeting almost any criterion that can be
stated as a logical expression.
</p>
<p>Function ‘hilight’ is passed a factor vector or integer vector,
and identifies factor values by color and glyph.
</p>
<p>Function ‘chullord’ is passed a factor vector or integer vector,
and plots a convex hull around all points in each factor class.
By specifying values for arguments ‘cols’ and ‘ltys’
it is possible to control the sequence of colors and linetypes of the convex
hulls.
</p>
<p>Function ‘ellip’ is passed a factor vector or integer vector,
and plots minimal volume ellipses containingg all points within a class.
By specifying values for arguments ‘cols’ and ‘ltys’
it is possible to control the sequence of colors and linetypes of the ellipses.
</p>
<p>Function ‘density’ calculates the fraction of points within the convex
hull that belong to the specified type.
</p>
<p>Function ‘surf’ calculates and plots fitted surfaces for logical or
quantitative variables.  The function employs the <code>gam</code>
function to fit a variable to the ordination coordinates, and to predict the
values at all grid points.  The grid is established with the
‘expand.grid’ function, and the grid is then specified in a call to
‘predict.gam’.  The predicted values are trimmed to the the convex hull
of the data, and the contours are fit by ‘contour’.  The default link
function for fitting the GAMs is ‘gaussian’, suitable for unbounded
continuous variables.  For logical variables you should specify ‘family
= binomial’ to get a logistic GAM, and for integer counts you should specify
‘family = poisson’ to get a Poisson GAM or ‘family='nb'’ to get a negative binomial fit.
</p>
<p>Function ‘thull’ calculates a tensioned hull for a specific variable
on the ordination.  A tensioned hull is a minimum volume container.  The grain size
must be specified as a fraction of the units of the NMDS, with larger values
generating smoother representations, and smaller numbers a more resolved 
container.  ‘thull’ returns an invisible object of class ‘thull’
which has an associated plot function.  Plotting the thull object produces a 
colored surface representation of the thull with optional contour lines.
</p>


<h3>Value</h3>

<p>Function ‘plotid’ returns a vector of row numbers of
identified plots</p>


<h3>Note</h3>

<p>The contouring routine using
<code>predict.gam</code> follows <code>ordisurf</code> as 
suggested by Jari Oksanen.
</p>


<h3>Author(s)</h3>

<p>David W. Roberts
<a href="mailto:droberts@montana.edu">droberts@montana.edu</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bryceveg)
data(brycesite)
dis.bc &lt;- dsvdis(bryceveg,'bray/curtis')
nmds.1 &lt;- nmds(dis.bc,5)
plot(nmds.1)
points(nmds.1,brycesite$elev&gt;8000)
surf(nmds.1,brycesite$elev)
## Not run: plotid(nmds.1,ids=row.names(bryceveg))
</code></pre>


</div>