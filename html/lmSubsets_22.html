<div class="container">

<table style="width: 100%;"><tr>
<td>lmSelect_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Best-subset regression</h2>

<h3>Description</h3>

<p>Low-level interface to best-variable-subset selection in ordinary
linear regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmSelect_fit(x, y, weights = NULL, offset = NULL, include = NULL,
             exclude = NULL, penalty = "BIC", tolerance = 0,
             nbest = 1, ..., pradius = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>double[,]</code>—the model matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>double[]</code>—the model response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p><code>double[]</code>—the model weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p><code>double[]</code>—the model offset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p><code>logical[]</code>, <code>integer[]</code>,
<code>character[]</code>—the regressors to force in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p><code>logical[]</code>, <code>integer[]</code>,
<code>character[]</code>—the regressors to force out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p><code>double</code>, <code>character</code>,
<code>"function"</code>—the penalty per model parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p><code>double</code>—the approximation tolerance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbest</code></td>
<td>
<p><code>integer</code>—the number of best subsets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pradius</code></td>
<td>
<p><code>integer</code>—the preordering radius</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The best variable-subset model is determined, where the "best" model
is the one with the lowest information criterion value.  The
information criterion belongs to the AIC family.
</p>
<p>The regression data is specified with the <code>x</code>, <code>y</code>,
<code>weights</code>, and <code>offset</code> parameters.  See
<code>lm.fit()</code> for further details.
</p>
<p>To force regressors into or out of the regression, a list of
regressors can be passed as an argument to the <code>include</code> or
<code>exclude</code> parameters, respectively.
</p>
<p>The information criterion is specified with the <code>penalty</code>
parameter.  Accepted values are <code>"AIC"</code>, <code>"BIC"</code>, or a
<code>"numeric"</code> value representing the penalty-per-model-parameter.
A custom selection criterion may be specified by passing an <code>R</code>
function as an argument.  The expected signature is <code>function
  (size, rss)</code>, where <code>size</code> is the number of predictors (including
the intercept, if any), and <code>rss</code> is the residual sum of squares.
The function must be non-decreasing in both parameters.
</p>
<p>An approximation <code>tolerance</code> can be specified to speed up the
search.
</p>
<p>The number of returned submodels is determined by the <code>nbest</code>
parameter.
</p>
<p>The preordering radius is given with the <code>pradius</code> parameter.
</p>


<h3>Value</h3>

<p>A <code>list</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>NOBS</code></td>
<td>
<p><code>integer</code>—number of observations in model (before
<code>weights</code> processing)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p><code>integer</code>—number of observations in model (after
<code>weights</code> processing)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar</code></td>
<td>
<p><code>integer</code>—number of regressors in model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p><code>double[]</code>—model weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p><code>logical</code>—is <code>TRUE</code> if model contains an
intercept term, <code>FALSE</code> otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p><code>logical[]</code>—regressors forced into the
regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p><code>logical[]</code>—regressors forced out of the
regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p><code>integer[]</code>—subset sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>information criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p><code>double</code>—approximation tolerance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbest</code></td>
<td>
<p><code>integer</code>—number of best subsets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>submodel</code></td>
<td>
<p><code>"data.frame"</code>—submodel information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p><code>"data.frame"</code>—selected subsets</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Hofmann M, Gatu C, Kontoghiorghes EJ, Colubi A, Zeileis A (2020).
lmSubsets: Exact variable-subset selection in linear regression for R.
<em>Journal of Statistical Software</em>, <strong>93</strong>, 1–21.
doi: <a href="https://doi.org/10.18637/jss.v093.i03">10.18637/jss.v093.i03</a>.
</p>


<h3>See Also</h3>


<ul>
<li>
<p><code>lmSelect()</code> for the high-level
interface
</p>
</li>
<li>
<p><code>lmSubsets_fit()</code> for all-subsets
regression
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data("AirPollution", package = "lmSubsets")

x &lt;- as.matrix(AirPollution[, names(AirPollution) != "mortality"])
y &lt;-           AirPollution[, names(AirPollution) == "mortality"]

f &lt;- lmSelect_fit(x, y)
f
</code></pre>


</div>