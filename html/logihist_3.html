<div class="container">

<table style="width: 100%;"><tr>
<td>logihist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Combined Graphs for Logistic Regression
</h2>

<h3>Description</h3>

<p>Plot combined graphs for logistic regressions in the ggplot2 system.
</p>


<h3>Usage</h3>

<pre><code class="language-R">logihist(x, y, scale.hist = 5, breaks = "Sturges", counts = TRUE, intervalo = 0,
   ylab2 = "Frequency", fillb = 1, colob = 1, sizeb = 1, pglm = FALSE, se = FALSE,
   sizeglm = 1, colglm = 1)
logibox(x, y, boxwd = 0.1, wiswd = 0.05, displac = 0, sizepat = 1, fillb = NA, colob = 1,
   colpat = 1, colbig = 1, colmed = 1, sizeb = 1, sizebig = 1, sizemed = 2, colout = 1,
   sizeout = 1, shapeout = 1, pglm = FALSE, se = FALSE, sizeglm = 1, colglm = 1)
logidot(x, y, incre = NULL, sizedot = NULL, coldot = 1, shapedot = 1, pglm = FALSE,
   se = FALSE, sizeglm = 1, colglm = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Either the predictor variable or a glm object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>If <code>x</code> is a predictor variable, <code>y</code> is the response variable, i.e., either a logic (FALSE and TRUE) vector or a vector of 1's and 0's.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.hist</code></td>
<td>

<p>Value to scale the maximum vertical size of histograms.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>How to compute the breakpoints for the histograms. See <code>hist</code> in package <span class="pkg">graphics</span>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>

<p>Add counts above histogram bars (not implemented in  this version).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervalo</code></td>
<td>

<p>Width of histogram bins.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab2</code></td>
<td>

<p>Label for the y-axis of the histograms.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fillb</code></td>
<td>

<p>Color to fill the histogram bars or the boxes of the boxplots. Either a single value or a vector witth different values for the 0 and 1 cases.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colob</code></td>
<td>

<p>Color to delineate the histogram bars or the boxes of the boxplots. Either a single or double value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colpat</code></td>
<td>

<p>Color of  the line representing the whiskers in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colbig</code></td>
<td>

<p>Color of  the line representing the end of whiskers in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colmed</code></td>
<td>

<p>Color of  the line representing the median in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colout</code></td>
<td>

<p>Color of  the line representing the outliers in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeb</code></td>
<td>

<p>Width of the lines that delineate the histogram bars or the boxes of the boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxwd</code></td>
<td>

<p>Width of the boxes in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wiswd</code></td>
<td>

<p>Size of the end of whiskers in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizebig</code></td>
<td>

<p>Width of  the line representing the end of whiskers in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizepat</code></td>
<td>

<p>Width of  the line representing the whiskers in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizemed</code></td>
<td>

<p>Width of  the line representing the median in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeout</code></td>
<td>

<p>Size of the points representing the outliers in boxplots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapeout</code></td>
<td>

<p>Shape of the points representing the outliers.  See the entry for <code>pch</code> in  <code>points</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displac</code></td>
<td>

<p>Vertical displacement of boxplots along the y-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incre</code></td>
<td>

<p>Separation among points in the dotplot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizedot</code></td>
<td>

<p>Size of points in the dotplot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coldot</code></td>
<td>

<p>Color of points in the dotplot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapedot</code></td>
<td>

<p>Shape of the points in the dotplot.  See the entry for <code>pch</code> in  <code>points</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pglm</code></td>
<td>

<p>Draw the fitted logistic curve? (TRUE or FALSE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>

<p>Draw the standard error around the fitted logistic curve?(TRUE or FALSE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeglm</code></td>
<td>

<p>Width of the line for the fitted fitted logistic curve.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colglm</code></td>
<td>

<p>Color of the line for the fitted fitted logistic curve.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The use of functions <code>logihist</code>, <code>logibox</code> or  <code>logidot</code> will  render a combined graph for logistic regression. Either a double histogram, a double boxplot or a double dotplot, which could be modified or integrated with other graphical elements of <code>ggplot2</code>.
</p>


<h3>Value</h3>

<p>A combined graph for logistic regression.
</p>


<h3>Note</h3>

<p><code>logidot</code> would try to find the optimal size of dots to avoid overlaping. The default computed sizes and separation could be fine-tunned by the arguments <code>sizedot</code> and <code>incre</code>.
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz
</p>


<h3>References</h3>

<p><a href="http://esapubs.org/bulletin/backissues/086-1/bulletinjan2005.htm#et">De la Cruz Rot, M. 2005. Improving the Presentation of Results of Logistic Regression with R. ESA Bulletin 86:41-48.</a> 
</p>


<h3>See Also</h3>

<p>The original implementation of the <code>logi.hist.plot</code> function for the R graphic sytem in the package <span class="pkg">popbio</span>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Get some data from package popbio
data(aq.trans, package="popbio")
aq.trans$survived&lt;-aq.trans$fate!="dead"
a&lt;-subset(aq.trans, leaf&lt;50 &amp; stage!="recruit", c(leaf,survived))


# Transform the "survived" variable in numeric
# This is necesary to correctly plot the combined graph.
 
a$survived &lt;-a$survived*1

# Fit a logistic regression
glm.a&lt;- glm(survived~leaf, data=a, family=binomial)


# Histograms
# From individual variables
# Modifying the appearence of histogram bins
logihist(a$leaf,a$survived)
logihist(a$leaf,a$survived, fillb="blue")
logihist(a$leaf,a$survived, fillb="blue", colob="blue")
logihist(a$leaf,a$survived, fillb=c("orange","blue"), colob=c("orange","blue"))
logihist(a$leaf,a$survived, fillb=c("orange","blue"), colob=c("orange","blue"),
scale.hist=2)
logihist(a$leaf,a$survived, fillb=c("orange","blue"), colob=c("orange","blue"),
  breaks=seq(0,50, by=2))

# Modifying the combined plot using functions from ggpplot2

logihist(a$leaf,a$survived, fillb=NA, sizeb=0.5, ylab2="Number of plants", )+
   ylab("survived")+xlab("leaf")+ stat_smooth(method = "glm", method.args =
   list(family = "binomial"), se=TRUE, size=1, colour="black")+theme_light()


# The same fromm a glm object

logihist(glm.a, fillb=NA, sizeb=0.5, ylab2="Number of plants", se=TRUE)+ 
           theme_light()



# Dotplots
# Double dotplot from the individual variables, with different symbols for
#  0 and 1 categories (black and void, redand solid respectively).

logidot(a$leaf,a$survived,coldot=c(1,2),shapedot=c(1,19))

# Try with a larger dot.
logidot(a$leaf,a$survived,coldot=c(1,2),shapedot=c(1,19), sizedot=1)

# Add the fitted logistic curve and change the presentation using
# respectively an stat and a theme from ggplot2 

logidot(a$leaf,a$survived, coldot=c(1,2),shapedot=c(1,19),  sizedot=1)+
    stat_smooth(method = "glm", method.args = list(family = "binomial"),
           se=FALSE, size=2)+theme_light()+ylab("leaf")+xlab("survived")

# Get the same graphic directly form the fitted glm object
logidot(glm.a, coldot=c(1,2),shapedot=c(1,19),  sizedot=1, sizeglm=2,
           colglm="blue")+theme_light()



# Boxplots
logibox(a$leaf,a$survived)+theme_light()+ stat_smooth(method = "glm",
           method.args = list(family = "binomial"),se=FALSE )+
	   geom_jitter(height=0.02, size=0.5, colour="pink", alpha=0.5)



</code></pre>


</div>