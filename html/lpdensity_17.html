<div class="container">

<table style="width: 100%;"><tr>
<td>plot.lpdensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Method for Local Polynomial Density Estimation and Inference</h2>

<h3>Description</h3>

<p>The plot method for local polynomial density objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lpdensity'
plot(
  ...,
  alpha = NULL,
  type = NULL,
  lty = NULL,
  lwd = NULL,
  lcol = NULL,
  pty = NULL,
  pwd = NULL,
  pcol = NULL,
  grid = NULL,
  CItype = NULL,
  CIuniform = FALSE,
  CIsimul = 2000,
  CIshade = NULL,
  CIcol = NULL,
  hist = FALSE,
  histData = NULL,
  histBreaks = NULL,
  histFillCol = 3,
  histFillShade = 0.2,
  histLineCol = "white",
  title = NULL,
  xlabel = NULL,
  ylabel = NULL,
  legendTitle = NULL,
  legendGroups = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Class "lpdensity" object, obtained from calling <code>lpdensity</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric scalar between 0 and 1, specifies the significance level for plotting
confidence intervals/bands. If more than one is provided, they will be applied to each data series
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>String, one of <code>"line"</code> (default), <code>"points"</code> and <code>"both"</code>, specifies how
the point estimates are plotted. If more than one is provided, they will be applied to each data series
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Line type for point estimates, only effective if <code>type</code> is <code>"line"</code> or
<code>"both"</code>. <code>1</code> for solid line, <code>2</code> for dashed line, <code>3</code> for dotted line.
For other options, see the instructions for <code>ggplot2</code> or <code>par</code>. If
more than one is provided, they will be applied to each data series accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Line width for point estimates, only effective if <code>type</code> is <code>"line"</code> or
<code>"both"</code>. Should be strictly positive. For other options, see the instructions for
<code>ggplot2</code> or <code>par</code>. If more than one is provided, they will be applied
to each data series accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p>Line color for point estimates, only effective if <code>type</code> is <code>"line"</code> or
<code>"both"</code>. <code>1</code> for black, <code>2</code> for red, <code>3</code> for green, <code>4</code> for blue.
For other options, see the instructions for <code>ggplot2</code> or <code>par</code>. If
more than one is provided, they will be applied to each data series
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pty</code></td>
<td>
<p>Scatter plot type for point estimates, only effective if <code>type</code> is <code>"points"</code> or
<code>"both"</code>. For options, see the instructions for <code>ggplot2</code> or <code>par</code>. If
more than one is provided, they will be applied to each data series
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pwd</code></td>
<td>
<p>Scatter plot size for point estimates, only effective if <code>type</code> is <code>"points"</code> or
<code>"both"</code>. Should be strictly positive. If more than one is provided, they will be applied to each data series
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcol</code></td>
<td>
<p>Scatter plot color for point estimates, only effective if <code>type</code> is <code>"points"</code> or
<code>"both"</code>. <code>1</code> for black, <code>2</code> for red, <code>3</code>
for green, <code>4</code> for blue.
For other options, see the instructions for <code>ggplot2</code> or <code>par</code>. If
more than one is provided, they will be applied to each data series
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Numeric vector, specifies a subset of grid points
to plot point estimates. This option is effective only if <code>type</code> is <code>"points"</code> or
<code>"both"</code>; or if <code>CItype</code> is <code>"ebar"</code> or
<code>"all"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CItype</code></td>
<td>
<p>String, one of <code>"region"</code> (shaded region, default), <code>"line"</code> (dashed lines),
<code>"ebar"</code> (error bars), <code>"all"</code> (all of the previous) or <code>"none"</code> (no confidence region),
how the confidence region should be plotted. If more than one is provided, they will be applied to each data series
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIuniform</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default), plotting either pointwise confidence intervals (<code>FALSE</code>) or
uniform confidence bands (<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIsimul</code></td>
<td>
<p>Positive integer, specifies the number of simulations used to construct critical values (default is <code>2000</code>). This
option is ignored if <code>CIuniform=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIshade</code></td>
<td>
<p>Numeric, specifies the opaqueness of the confidence region, should be between 0 (transparent) and
1. Default is 0.2. If more than one is provided, they will be applied to each data series
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIcol</code></td>
<td>
<p>Color of the confidence region. <code>1</code> for black, <code>2</code> for red, <code>3</code>
for green, <code>4</code> for blue.
For other options, see the instructions for <code>ggplot2</code> or <code>par</code>. If
more than one is provided, they will be applied to each data series
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default), specifies whether a histogram should be added to the background.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histData</code></td>
<td>
<p>Numeric vector, specifies the data used to construct the histogram plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histBreaks</code></td>
<td>
<p>Numeric vector, specifies the breakpoints between histogram cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histFillCol</code></td>
<td>
<p>Color of the histogram cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histFillShade</code></td>
<td>
<p>Opaqueness of the histogram cells, should be between 0 (transparent) and
1. Default is 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histLineCol</code></td>
<td>
<p>Color of the histogram lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title, xlabel, ylabel</code></td>
<td>
<p>Strings, specifies the title of the plot and labels for the x- and y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendTitle</code></td>
<td>
<p>String, specifies the legend title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendGroups</code></td>
<td>
<p>String vector, specifies the group names used in legend.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A stadnard <code>ggplot</code> object is returned, hence can be used for further customization.
</p>


<h3>Author(s)</h3>

<p>Matias D. Cattaneo, Princeton University. <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Michael Jansson, University of California Berkeley. <a href="mailto:mjansson@econ.berkeley.edu">mjansson@econ.berkeley.edu</a>.
</p>
<p>Xinwei Ma (maintainer), University of California San Diego. <a href="mailto:x1ma@ucsd.edu">x1ma@ucsd.edu</a>.
</p>


<h3>See Also</h3>

<p><code>lpdensity</code> for local polynomial density estimation.
</p>
<p>Supported methods: <code>coef.lpdensity</code>, <code>confint.lpdensity</code>,
<code>plot.lpdensity</code>, <code>print.lpdensity</code>, <code>summary.lpdensity</code>,
<code>vcov.lpdensity</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a random sample
set.seed(42); X &lt;- rnorm(2000)

# Generate a density discontinuity at 0
X &lt;- X - 0.5; X[X&gt;0] &lt;- X[X&gt;0] * 2

# Density estimation, left of 0 (scaled by the relative sample size)
est1 &lt;- lpdensity(data = X[X&lt;=0], grid = seq(-2.5, 0, 0.05), bwselect = "imse-dpi",
  scale = sum(X&lt;=0)/length(X))
# Density estimation, right of 0 (scaled by the relative sample size)
est2 &lt;- lpdensity(data = X[X&gt;0],  grid = seq(0, 2, 0.05), bwselect = "imse-dpi",
  scale = sum(X&gt;0)/length(X))

# Plot
plot(est1, est2, legendTitle="My Plot", legendGroups=c("Left", "Right"))

# Plot uniform confidence bands
set.seed(42) # fix the seed for simulating critical values
plot(est1, est2, legendTitle="My Plot", legendGroups=c("Left", "Right"), CIuniform=TRUE)

# Adding a histogram to the background
plot(est1, est2, legendTitle="My Plot", legendGroups=c("Left", "Right"),
  hist=TRUE, histBreaks=seq(-2.4, 2, 0.2), histData=X)

# Plot point estimates for a subset of evaluation points
plot(est1, est2, legendTitle="My Plot", legendGroups=c("Left", "Right"),
  type="both", CItype="all", grid=seq(-2, 2, 0.5))
</code></pre>


</div>