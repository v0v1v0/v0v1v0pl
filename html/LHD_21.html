<div class="container">

<table style="width: 100%;"><tr>
<td>SLHD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sliced Latin Hypercube Design (SLHD)</h2>

<h3>Description</h3>

<p><code>SLHD</code> returns a <code>n</code> by <code>k</code> LHD matrix generated by improved two-stage algorithm
</p>


<h3>Usage</h3>

<pre><code class="language-R">SLHD(
  n,
  k,
  t = 1,
  N = 10,
  T0 = 10,
  rate = 0.1,
  Tmin = 1,
  Imax = 3,
  OC = "phi_p",
  p = 15,
  q = 1,
  stage2 = FALSE,
  maxtime = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A positive integer, which stands for the number of rows (or run size).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A positive integer, which stands for the number of columns (or factor size).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A positive integer, which stands for the number of slices. <code>n</code>/<code>t</code> must be a positive integer, that is, n is divisible by t. <code>t</code> must be smaller or equal to <code>k</code> when <code>n</code> is 9 or larger. <code>t</code> must be smaller than <code>k</code> when <code>n</code> is smaller than 9. Otherwise, the funtion will never stop. The default is set to be 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>A positive integer, which stands for the number of iterations. The default is set to be 10. A large value of <code>N</code> will result a high CPU time, and it is recommended to be no greater than 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T0</code></td>
<td>
<p>A positive number, which stands for the user-defined initial temperature. The default is set to be 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>A positive percentage, which stands for temperature decrease rate, and it should be in (0,1). For example, rate=0.25 means the temperature decreases by 25% each time. The default is set to be 10%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmin</code></td>
<td>
<p>A positive number, which stands for the minimium temperature allowed. When current temperature becomes smaller or equal to <code>Tmin</code>, the stopping criterion for current loop is met. The default is set to be 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Imax</code></td>
<td>
<p>A positive integer, which stands for the maximum perturbations the algorithm will try without improvements before temperature is reduced. The default is set to be 5. For the computation complexity consideration, <code>Imax</code> is recommended to be smaller or equal to 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OC</code></td>
<td>
<p>An optimality criterion. The default setting is "phi_p", and it could be one of the following: "phi_p", "AvgAbsCor", "MaxAbsCor", "MaxProCriterion".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A positive integer, which is the parameter in the phi_p formula, and <code>p</code> is prefered to be large. The default is set to be 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The default is set to be 1, and it could be either 1 or 2. If <code>q</code> is 1, <code>dij</code> is the Manhattan (rectangular) distance. If <code>q</code> is 2, <code>dij</code> is the Euclidean distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage2</code></td>
<td>
<p>A logic input argument, and it could be either FALSE or TRUE. If <code>stage2</code> is FALSE (the default setting), <code>SLHD</code> will only implement the first stage of the algorithm. If <code>stage2</code> is TRUE, <code>SLHD</code> will implement the whole algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>A positive number, which indicates the expected maximum CPU time given by user, and it is measured by minutes. For example, maxtime=3.5 indicates the CPU time will be no greater than three and half minutes. The default is set to be 5.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If all inputs are logical, then the output will be a <code>n</code> by <code>k</code> LHD. As mentioned from the original paper, the first stage plays a much more important role since it optimizes the slice level. More resources should be given to the first stage if computational budgets are limited. Let m=n/t, where m is the number of rows for each slice, if (m)^k &gt;&gt; n, the second stage becomes optional. That is the reason why we add a <code>stage2</code> parameter to let users decide if the second stage is needed.
</p>


<h3>References</h3>

<p>Ba, S., Myers, W.R., and Brenneman, W.A. (2015) Optimal Sliced Latin Hypercube Designs. <em>Technometrics</em>, <strong>57</strong>, 479-487.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#generate a 5 by 3 maximin distance LHD with the default setting
try=SLHD(n=5,k=3)
try
phi_p(try)   #calculate the phi_p of "try".

#generate a 5 by 3 maximin distance LHD with stage II
#let stage2=TRUE and other input are the same as above
try2=SLHD(n=5,k=3,stage2=TRUE)
try2
phi_p(try2)   #calculate the phi_p of "try2".

#Another example
#generate a 8 by 4 nearly orthogonal LHD
try3=SLHD(n=8,k=4,OC="AvgAbsCor",stage2=TRUE)
try3
AvgAbsCor(try3)  #calculate the average absolute correlation.
</code></pre>


</div>