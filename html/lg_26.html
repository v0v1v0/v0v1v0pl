<div class="container">

<table style="width: 100%;"><tr>
<td>dlg_trivariate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Trivariate density estimation</h2>

<h3>Description</h3>

<p><code>dlg_trivariate</code> returns the locally Gaussian density estimate of a
trivariate distribution on a given grid.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dlg_trivariate(x, eval_points = NULL, grid_size = 15, bw = c(1, 1,
  1), est_method = "trivariate", run_checks = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The data matrix (or data frame). Must have exactly 2 columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval_points</code></td>
<td>
<p>The grid where the density should be estimated. Must have
exactly 2 columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_size</code></td>
<td>
<p>If <code>eval_points</code> is not supplied, then the function
will create a suitable grid diagonally through the data, with this many
grid points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>The two bandwidths, a numeric vector of length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_method</code></td>
<td>
<p>The estimation method, must either be "1par" for estimation
with just the local correlation, or "5par"  for a full locally Gaussian fit
with all 5 parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_checks</code></td>
<td>
<p>Logical. Should sanity checks be run on the arguments?
Useful to disable this when doing cross-validation for example.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In some applications it may be desired to produce a full locally Gaussian fit
of a trivariate density function without having to resort to bivariate
approximations. This function takes a trivariate data set, <code>x</code>, and a
trivariate set of grid points <code>eval_points</code>, and returns the trivariate,
locally Gaussian density estimate in these points. We also need a vector of
bandwidths, <code>bw</code>, with three elements, and an estimation method
<code>est_method</code>, which in this case is fixed at "trivariate", and
included only to be fully compatible with the other methods in this package.
</p>
<p>This function will only work on the marginally standard normal scale! Please
use the wrapper function <code>dlg()</code> for density estimation. This will
ensure that all parameters have proper values.
</p>


<h3>Value</h3>

<p>A list including the data set <code>$x</code>, the grid
<code>$eval_points</code>, the bandwidths <code>$bw</code>, as well as a matrix of the
estimated parameter estimates <code>$par_est</code> and the estimated bivariate
density <code>$f_est</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  x &lt;- cbind(rnorm(100), rnorm(100), rnorm(100))
  bw &lt;- c(1, 1, 1)
  eval_points &lt;- cbind(seq(-4, 4, 1), seq(-4, 4, 1), seq(-4, 4, 1))

  estimate &lt;- dlg_trivariate(x, eval_points = eval_points, bw = bw)

</code></pre>


</div>