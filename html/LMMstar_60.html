<div class="container">

<table style="width: 100%;"><tr>
<td>autoplot.lmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical Display For Linear Mixed Models</h2>

<h3>Description</h3>

<p>Display fitted values or residual plot for the mean, variance, and correlation structure.
Can also display quantile-quantile plot relative to the normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lmm'
autoplot(
  object,
  type = "fit",
  type.residual = NULL,
  obs.alpha = 0,
  obs.size = NULL,
  facet = NULL,
  facet_nrow = NULL,
  facet_ncol = NULL,
  scales = "fixed",
  labeller = "label_value",
  at = NULL,
  time.var = NULL,
  color = NULL,
  position = NULL,
  ci = TRUE,
  ci.alpha = NULL,
  ylim = NULL,
  mean.size = c(3, 1),
  size.text = 16,
  position.errorbar = "identity",
  ...
)

## S3 method for class 'lmm'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object, x</code></td>
<td>
<p>a <code>lmm</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>[character] the type of plot </p>

<ul>
<li> <p><code>"fit"</code>: fitted values over repetitions.
</p>
</li>
<li> <p><code>"qqplot"</code>: quantile quantile plot of the normalized residuals
</p>
</li>
<li> <p><code>"correlation"</code>: residual correlation over repetitions
</p>
</li>
<li> <p><code>"scatterplot"</code>: normalized residuals vs. fitted values (diagnostic for missing non-linear effects),
</p>
</li>
<li> <p><code>"scatterplot2"</code>: square root of the normalized residuals vs. fitted values (diagnostic for heteroschedasticity),
</p>
</li>
<li> <p><code>"partial"</code>: partial residual plot.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.residual</code></td>
<td>
<p>[character] the type of residual to be used. Not relevant for <code>type="fit"</code>.
By default, normalized residuals are used except when requesting a partial residual plot
where this argument specify the variable relative to which the partial residuals are computed (argument <code>variable</code> in <code>residuals.lmm</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.alpha</code></td>
<td>
<p>[numeric, 0-1] When not NA, transparency parameter used to display the original data by cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.size</code></td>
<td>
<p>[numeric vector of length 2] size of the point and line for the original data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet</code></td>
<td>
<p>[formula] split the plot into a matrix of panels defined by the variables in the formula.
Internally it calls <code>ggplot2::facet_wrap</code> or <code>ggplot2::facet_grid</code> depending on whether the formula contains a variable on the left hand side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_nrow</code></td>
<td>
<p>[integer] number of rows of panels in the graphical display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_ncol</code></td>
<td>
<p>[integer] number of columns of panels  in the graphical display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales, labeller</code></td>
<td>
<p>[character] Passed to <code>ggplot2::facet_wrap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>[data.frame] values for the covariates at which to evaluate the fitted values or partial residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.var</code></td>
<td>
<p>[character] x-axis variable for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>[character] name of the variable in the dataset used to color the curve. No color is used when set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>position</code></td>
<td>
<p>[character] relative position of the points when colored according to a variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>[logical] should confidence intervals be displayed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.alpha</code></td>
<td>
<p>[numeric, 0-1] When not NA, transparency parameter used to display the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>[numeric vector of length 2] the lower and higher value of the vertical axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.size</code></td>
<td>
<p>[numeric vector of length 2] size of the point and line for the mean trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.text</code></td>
<td>
<p>[numeric, &gt;0] size of the font used to display text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>position.errorbar</code></td>
<td>
<p>[character] relative position of the errorbars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to the <code>predict.lmm</code> or <code>autoplot.residual_lmm</code> functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two elements </p>

<ul>
<li> <p><code>data</code>: data used to create the graphical display.
</p>
</li>
<li> <p><code>plot</code>: ggplot object.
</p>
</li>
</ul>
<h3>Functions</h3>


<ul><li> <p><code>plot(lmm)</code>: Graphical Display For Linear Mixed Models
</p>
</li></ul>
<h3>See Also</h3>

<p><code>plot.lmm</code> for other graphical display (residual plots, partial residual plots).
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(require(ggplot2)){

#### simulate data in the long format ####
set.seed(10)
dL &lt;- sampleRem(100, n.times = 3, format = "long")
dL$X1 &lt;- as.factor(dL$X1)

#### fit Linear Mixed Model ####
eCS.lmm &lt;- lmm(Y ~ visit + X1 + X6,
               repetition = ~visit|id, structure = "CS", data = dL, df = FALSE)

#### model fit ####
plot(eCS.lmm, type = "fit", facet =~X1)
## customize display
gg &lt;- autoplot(eCS.lmm, type = "fit", facet =~X1)$plot
gg + coord_cartesian(ylim = c(0,6))
## restrict to specific covariate value
plot(eCS.lmm, type = "fit", at = data.frame(X6=1), color = "X1")

#### qqplot ####
plot(eCS.lmm, type = "qqplot")
plot(eCS.lmm, type = "qqplot", engine.qqplot = "qqtest")

#### residual correlation ####
plot(eCS.lmm, type = "correlation")

#### residual trend ####
plot(eCS.lmm, type = "scatterplot")

#### residual heteroschedasticity ####
plot(eCS.lmm, type = "scatterplot2")

#### partial residuals ####
plot(eCS.lmm, type = "partial", type.residual = "visit") 
plot(eCS.lmm, type = "partial", type.residual = c("(Intercept)","X1","visit"))
plot(eCS.lmm, type = "partial", type.residual = c("(Intercept)","X1","visit"),
facet = ~X1)
}
</code></pre>


</div>