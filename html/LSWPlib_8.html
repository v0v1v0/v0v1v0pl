<div class="container">

<table style="width: 100%;"><tr>
<td>LSWPspec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Locally Stationary Wavelet Packet Spectral Estimation</h2>

<h3>Description</h3>

<p><code>LSWPspec</code> returns the spectral estimate of a locally stationary time series
characterized by a wavelet packet basis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LSWPspec(x, lev, bb, wavelet, smooth, spa, correct = TRUE, AA = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a real valued numeric vector containing a time series of dyadic length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lev</code></td>
<td>
<p>the maximum level for which the spectra should be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bb</code></td>
<td>
<p>a wavelet packet basis for which the spectra is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wavelet</code></td>
<td>
<p>wavelet used to estimate the wavelet packet spectra. Possible values are <code>"haar"</code>, <code>"d4"</code> and <code>"la8"</code>. See also Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>logical. If <code>FALSE</code> the returned spectral estimate is not smoothed. Default value is <code>FALSE</code>. See also Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spa</code></td>
<td>
<p>window length for spectral smoothing. Increasing values increase the smoothing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>logical. Should the returned spectral estimate be unbiased? Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AA</code></td>
<td>
<p>this argument is for internal use only and should be left alone. See also Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The current implementation allow the use of these three well known Daubechies discrete wavelets for spectral estimation. Default choice is the
<code>"la8"</code> wavelet which has decent control over frequency leakage characterizing compactly supported filters. In this initial implementation
smoothing is provided by local polynomials through the <code>lowess</code> function and the smoothing parameter <code>spa</code> is passed to <code>lowess</code>.
Future package versions will allow for different smoothing methods. The argument <code>AA</code> is tipically used by other functions to provide the
inner product matrix when running simulations. For a direct usage on a single time series the matrix is calculated internally usig the default settings.
</p>


<h3>Value</h3>

<p>A matrix containing the time-frequency spectral estimate where each column corresponds to a different time point and ech row
corresponds to a different packet from the given basis.
</p>


<h3>Author(s)</h3>

<p>Alessandro Cardinali
</p>


<h3>References</h3>

<p>A. Cardinali and G.P. Nason (2017). Locally Stationary Wavelet Packet Processes:
Basis Selection and Model Fitting. Journal of Time Series Analysis, 38:2, 151-174.
</p>


<h3>See Also</h3>

<p><code>get.wavelet.basis</code>, <code>LSWPsim</code>, <code>best.basis</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 wb &lt;- get.wavelet.basis(4)
wpp &lt;- LSWPspec(x = sp500, lev = 4, bb = wb, wavelet = 'la8', smooth = TRUE, spa = 0.35)

</code></pre>


</div>