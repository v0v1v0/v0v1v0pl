<div class="container">

<table style="width: 100%;"><tr>
<td>plot.lacfCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot confidence intervals for localized autocovariance for
locally stationary time series.
</h2>

<h3>Description</h3>

<p>Plot the localized autocovariance and
approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lacfCI'
plot(x, plotcor = TRUE, type = "line",
    lags = 0:as.integer(10 * log10(nrow(x$lacf))), tcex = 1,
    lcol = 1, llty = 1, ylim = NULL, segwid = 1,
    segandcross = TRUE, conf.level = 0.95, plot.it = TRUE,
    xlab, ylab, sub, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The <code>lacfCI</code> object you wish to plot, e.g. produced
by the <code>Rvarlacf</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotcor</code></td>
<td>
<p>If <code>TRUE</code> then autocorrelations are plotted,
if <code>FALSE</code> then autocovariances are. Note: not all combinations
of types of plot and <code>plotcor</code> are valid, but many are.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>This can be one of three values <code>"line"</code>,
<code>"persp"</code> or <code>"acf"</code>. The value
<code>"acf"</code> produces a plot like the regular <code>acf</code>
function, but note, the values plotted are from a localized
autocovariance function centred at the time location
contained in the <code>object</code> object (and that time appears in
the subtitle). This is the only plot that also plots the
confidence intervals. The <code>"line"</code> plot plots 
autocorrelations (only) for the specified <code>lags</code>
and does this over all time for the whole extent of the
series. This plot is useful to see if the autocorrelations
are changing over time. The final option,
<code>"persp"</code> produces a perspective plot of the autocovariance
or autocorrelations. Arguments can be supplied (<code>theta</code>,
<code>phi</code>) to rotate the perspective plot, as it can be
sometimes hard to visualize the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p>The lags that you wish to display. This
should be a list of non-negative integers, but not necessarily
consecutive.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tcex</code></td>
<td>
<p>On the <code>"line"</code> plot this argument controls
the expansion of the font for the labels on the lines.
So, setting <code>tcex=2</code>, for example, will double the size
of these. These labels visually indicate which line corresponds
to which lag.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p>On the <code>"line"</code> plot, this argument
controls the colour of the lines that are used to show
the acfs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llty</code></td>
<td>
<p>As <code>lcol</code> but for line types.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>The vertical limits of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segwid</code></td>
<td>
<p>On the <code>"acf"</code> plot, this argument controls
the widths of the little acf segments that connect the x-axis
with the acf values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segandcross</code></td>
<td>
<p>If <code>TRUE</code> then a small diamond is plotted
at the location of the acf, to make it clearer.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>The confidence level of the confidence intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>If <code>FALSE</code> then no plot is produced. This
can be used if you merely want to extract the relevant
acf values (which are returned).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X-axis label, constructed internally if not supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y-axis label, constructed internally if not supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>A subtitle for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to the main <code>plot</code> command.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function can plot the localized autocovariance in
three ways. Like a regular acf plot (but obviously a slice
out of a time-varying autocovariance, not the regular acf),
a line plot which shows the acfs over time and a perspective
plot which can plot the estimate of <code class="reqn">c(z, \tau)</code> as a
2D function. Currently, the confidence intervals can only
be displayed on the <code>"acf"</code> type plot.
</p>


<h3>Value</h3>

<p>A vector of the extracted acfvals invisibly returned.
Note: what is returned depends on the arguments, what is
returned is what would have been plotted if <code>plot.it</code>
were <code>TRUE</code>
</p>


<h3>Author(s)</h3>

<p>Guy Nason.
</p>


<h3>References</h3>

<p>Nason, G.P. (2013) A test for second-order stationarity and
approximate confidence intervals for localized autocovariances
for locally stationary time series. <em>J. R. Statist. Soc.</em> B,
<b>75</b>, 879-904.
<a href="https://doi.org/10.1111/rssb.12015">doi:10.1111/rssb.12015</a></p>


<h3>See Also</h3>

<p><code>Rvarlacf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Simulate a TVAR(1) process
#
x &lt;- tvar1sim()
#
# Computes its time-localized autocovariance and confidence intervals
# Note: smoothing is done automatically!
#
x.lacf &lt;- Rvarlacf(x=x, nz=50, var.lag.max=20)
#
# Now plot this, plot covariances as an acf plot, with the CIs
#
## Not run: plot(x.lacf, type="acf", plotcor=FALSE)
#
# Now plot it as a line plot, as correlations and can't do CIs
#
## Not run: plot(x.lacf)
</code></pre>


</div>