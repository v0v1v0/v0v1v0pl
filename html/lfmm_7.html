<div class="container">

<table style="width: 100%;"><tr>
<td>lfmm_sampler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>LFMM generative data sampler</h2>

<h3>Description</h3>

<p>Simulate data from the latent factor model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lfmm_sampler(
  n,
  p,
  K,
  outlier.prop,
  cs,
  sigma = 0.2,
  B.sd = 1,
  B.mean = 0,
  U.sd = 1,
  V.sd = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of latent variables (factors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.prop</code></td>
<td>
<p>proportion of outlier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cs</code></td>
<td>
<p>correlation between X and U.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>standard deviation of residual errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.sd</code></td>
<td>
<p>standard deviation for the effect size (B).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.mean</code></td>
<td>
<p>mean of B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U.sd</code></td>
<td>
<p>standard deviations for K factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.sd</code></td>
<td>
<p>standard deviations for loadings.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lfmm_sampler()</code> sample a response matrix Y and a primary variable X such that</p>
<pre>     Y = U t(V) + X t(B) + Epsilon.
</pre>
<p>U,V, B and Epsilon are simulated according to normal multivariate distributions.
Moreover U and X are such that <code>cor(U[,i], X) = cs[i]</code>.
</p>


<h3>Value</h3>

<p>A list with simulated data.
</p>


<h3>Author(s)</h3>

<p>kevin caye, olivier francois
</p>


<h3>Examples</h3>

<pre><code class="language-R">
dat &lt;- lfmm_sampler(n = 100, 
                    p = 1000, 
                    K = 3,
                    outlier.prop = 0.1,
                    cs = c(0.8),
                    sigma = 0.2,
                    B.sd = 1.0, 
                    B.mean = 0.0,
                    U.sd = 1.0, 
                    V.sd = 1.0)
</code></pre>


</div>