<div class="container">

<table style="width: 100%;"><tr>
<td>nnls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Nonnegative Least Squares
</h2>

<h3>Description</h3>

<p>Solves the following inverse problem:
</p>
<p style="text-align: center;"><code class="reqn">\min(||Ax-b||^2)</code>
</p>
<p> subject to
</p>
<p style="text-align: center;"><code class="reqn">x&gt;=0</code>
</p>

<p>Uses subroutine nnls (FORTRAN) from Linpack
</p>


<h3>Usage</h3>

<pre><code class="language-R">nnls(A, B, tol = sqrt(.Machine$double.eps), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A </code></td>
<td>
<p>numeric matrix containing the coefficients of the equality
constraints <code class="reqn">Ax~=B</code>; if the columns of <code>A</code> have a <code>names</code> 
attribute, the names will be used to label the output.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B </code></td>
<td>
<p>numeric vector containing the right-hand side of the
equality constraints.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol </code></td>
<td>
<p>tolerance (for singular value decomposition and for the
"equality" constraints).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose </code></td>
<td>
<p>logical to print <code>nnls</code> error messages.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X </code></td>
<td>
<p>vector containing the solution of the nonnegative least
squares problem.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residualNorm </code></td>
<td>
<p>scalar, the sum of absolute values of residuals of
violated inequalities (i.e. sumof x[&lt;0]); should be zero or very small
if the problem is feasible.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solutionNorm </code></td>
<td>
<p>scalar, the value of the quadratic function at the
solution, i.e. the value of <code class="reqn">\min(||Ax-b||^2)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IsError </code></td>
<td>
<p>logical, <code>TRUE</code> if an error occurred.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>the string "nnls", such that how the solution was obtained
can be traced.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numiter </code></td>
<td>
<p>the number of iterations.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Lawson C.L.and Hanson R.J. 1974. Solving Least Squares Problems,
Prentice-Hall
</p>
<p>Lawson C.L.and Hanson R.J. 1995. Solving Least Squares Problems.
SIAM classics in applied mathematics, Philadelphia.  (reprint of book)
</p>


<h3>See Also</h3>

<p><code>ldei</code>, which includes equalities
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- matrix(nrow = 2, ncol = 3, data = c(3, 2, 2, 4, 2, 1))
B &lt;- c(-4, 3)
nnls(A, B)
</code></pre>


</div>