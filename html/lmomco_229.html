<div class="container">

<table style="width: 100%;"><tr>
<td>pargld</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the Parameters of the Generalized Lambda Distribution</h2>

<h3>Description</h3>

<p>This function estimates the parameters of the Generalized Lambda distribution given the L-moments of the data in an ordinary L-moment object (<code>lmoms</code>) or a trimmed L-moment object (<code>TLmoms</code> for <code>t=1</code>). The relations between distribution parameters and L-moments are seen under <code>lmomgld</code>. There are no simple expressions for the parameters in terms of the L-moments. Consider that multiple parameter solutions are possible with the Generalized Lambda so some expertise in the distribution and other aspects are needed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pargld(lmom, verbose=FALSE, initkh=NULL, eps=1e-3,
       aux=c("tau5", "tau6"), checklmom=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lmom</code></td>
<td>
<p>An L-moment object created by <code>lmoms</code>, <code>vec2lmom</code>, or <code>TLmoms</code> with <code>trim=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical switch on the verbosity of output.  Default is <code>verbose=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initkh</code></td>
<td>
<p>A vector of the initial guess of the <code class="reqn">\kappa</code> and <code class="reqn">h</code> parameters. No other regions of parameter space are consulted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>A small term or threshold for which the square root of the sum of square errors in <code class="reqn">\tau_3</code> and <code class="reqn">\tau_4</code> is compared to to judge “good enough” for the alogrithm to order solutions based on smallest error as explained in next argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux</code></td>
<td>
<p>Control the algorithm to order solutions based on smallest error in <code class="reqn">\Delta \tau_5</code> or <code class="reqn">\Delta \tau_6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checklmom</code></td>
<td>
<p>Should the <code>lmom</code> be checked for validity using the <code>are.lmom.valid</code> function. Normally this should be left as the default and it is very unlikely that the L-moments will not be viable (particularly in the <code class="reqn">\tau_4</code> and <code class="reqn">\tau_3</code> inequality). However, for some circumstances or large simulation exercises then one might want to bypass this check.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to pass.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Karian and Dudewicz (2000) summarize six regions of the <code class="reqn">\kappa</code> and <code class="reqn">h</code> space in which the Generalized Lambda distribution is valid for suitably choosen <code class="reqn">\alpha</code>. Numerical experimentation suggestions that the L-moments are not valid in Regions 1 and 2. However, initial guesses of the parameters within each region are used with numerous separate <code>optim</code> (the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function) efforts to perform a least sum-of-square errors on the following objective function
</p>
<p style="text-align: center;"><code class="reqn">(\hat{\tau}_3 - \tilde{\tau}_3)^2 + (\hat{\tau}_4 - \tilde{\tau}_4)^2 \mbox{, }</code>
</p>

<p>where <code class="reqn">\hat{\tau}_r</code> is the L-moment ratio of the data, <code class="reqn">\tilde{\tau}_r</code> is the estimated value of the L-moment ratio for the fitted distribution <code class="reqn">\kappa</code> and <code class="reqn">h</code> and <code class="reqn">\tau_r</code> is the actual value of the L-moment ratio.
</p>
<p>For each optimization, a check on the validity of the parameters so produced is made—are the parameters consistent with the Generalized Lambda distribution? A second check is made on the validity of <code class="reqn">\tau_3</code> and <code class="reqn">\tau_4</code>. If both validity checks return <code>TRUE</code> then the optimization is retained if its sum-of-square error is less than the previous optimum value. It is possible for a given solution to be found outside the starting region of the initial guesses. The surface generated by the <code class="reqn">\tau_3</code> and <code class="reqn">\tau_4</code> equations seen in <code>lmomgld</code> is complex–different initial guesses within a given region can yield what appear to be radically different <code class="reqn">\kappa</code> and <code class="reqn">h</code>. Users are encouraged to “play” with alternative solutions (see the <code>verbose</code> argument). A quick double check on the L-moments from the solved parameters using <code>lmomgld</code> is encouraged as well. Karvanen and others (2002, eq. 25) provide an equation expressing <code class="reqn">\kappa</code> and <code class="reqn">h</code> as equal (a symmetrical Generalized Lambda distribution) in terms of <code class="reqn">\tau_4</code> and suggest that the equation be used to determine initial values for the parameters. The Karvanen equation is used on a semi-experimental basis for the final optimization attempt by <code>pargld</code>.
</p>


<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned if <code>result='best'</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of distribution: <code>gld</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>The parameters of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delTau5</code></td>
<td>
<p>Difference between the <code class="reqn">\tilde{\tau}_5</code> of the fitted distribution and true <code class="reqn">\hat{\tau}_5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>Smallest sum of square error found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>The source of the parameters: “pargld”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rest</code></td>
<td>
<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> of other solutions if found.</p>
</td>
</tr>
</table>
<p>The rest of the solutions have the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>The location parameter of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The scale parameter of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>The 1st shape parameter of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>The 2nd shape parameter of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attempt</code></td>
<td>
<p>The attempt number that found valid TL-moments and parameters of GLD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delTau5</code></td>
<td>
<p>The absolute difference between <code class="reqn">\hat{\tau}^{(1)}_5</code> of data to <code class="reqn">\tilde{\tau}^{(1)}_5</code> of the fitted distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>The sum of square error found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_k</code></td>
<td>
<p>The starting point of the <code class="reqn">\kappa</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_h</code></td>
<td>
<p>The starting point of the <code class="reqn">h</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valid.gld</code></td>
<td>
<p>Logical on validity of the GLD—<code>TRUE</code> by this point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valid.lmr</code></td>
<td>
<p>Logical on validity of the L-moments—<code>TRUE</code> by this point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerror</code></td>
<td>
<p>Logical on whether error was less than <code>eps</code>—<code>TRUE</code> by this point.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is a cumbersome method of parameter solution, but years of testing suggest that with supervision and the available options regarding the optimization that reliable parameter estimations result. The Tukey Lambda distribution is a special form of the GLD, see <b>Tukey Lambda Notes</b> section in <b>Details</b> of <code>lmrdia46</code> for more details.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>Source</h3>

<p>W.H. Asquith in Feb. 2006 with a copy of Karian and Dudewicz (2000) and again Feb. 2011.
</p>


<h3>References</h3>

<p>Asquith, W.H., 2007, L-moments and TL-moments of the generalized lambda distribution: Computational Statistics and Data Analysis, v. 51, no. 9, pp. 4484–4496.
</p>
<p>Karvanen, J., Eriksson, J., and Koivunen, V., 2002, Adaptive score functions for maximum likelihood ICA: Journal of VLSI Signal Processing, v. 32, pp. 82–92.
</p>
<p>Karian, Z.A., and Dudewicz, E.J., 2000, Fitting statistical distributions—The generalized lambda distribution and generalized bootstrap methods: CRC Press, Boca Raton, FL, 438 p.
</p>


<h3>See Also</h3>

<p><code>lmomgld</code>, <code>cdfgld</code>, <code>pdfgld</code>,  <code>quagld</code>, <code>parTLgld</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
  X      &lt;- sort( rgamma(202, 2) ) # simulate a skewed distribution
  lmr    &lt;- lmoms(X)               # compute trimmed L-moments
  PARgld &lt;- pargld(lmr)            # fit the GLD
  FF     &lt;- pp(X)
  plot( FF,    X, col=8, cex=0.25)
  lines(FF, qlmomco(FF, PARgld)) # show the best estimate
  if(! is.null(PARgld$rest)) { #$
    n &lt;- length(PARgld$rest$xi)
    other &lt;- unlist(PARgld$rest[n, 1:4]) #$ # show alternative
    lines(FF, qlmomco(FF, vec2par(other, type="gld")), col="red")
  }
  # Note in the extraction of other solutions that no testing for whether
  # additional solutions were found is made. Also, it is quite possible
  # that the other solutions "[n,1:4]" is effectively another numerical
  # convergence on the primary solution. Some users of this example thus
  # might not see two separate lines. Users are encouraged to inspect the
  # rest of the solutions: print(PARgld$rest) # 
## End(Not run)

## Not run: 
  FF &lt;- seq(0.01, 0.99, 0.01)
  plot(FF,  qlmomco(FF, vec2par(c(3.1446434, 2.943469, 7.4211316, 1.050537),
                                type="gld")), col="blue", type="l")
  lines(FF, qlmomco(FF, vec2par(c(0.4962471, 8.794038, 0.0082958, 0.228352),
                                type="gld")), col="red"           ) # 
## End(Not run)
</code></pre>


</div>