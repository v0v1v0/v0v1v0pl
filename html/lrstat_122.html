<div class="container">

<table style="width: 100%;"><tr>
<td>nbstat1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Negative binomial rate ratio by stratum</h2>

<h3>Description</h3>

<p>Obtains the number of subjects accrued, number of events,
number of dropouts, number of subjects reaching the maximum
follow-up, total exposure, rate and variance for log rate in each group,
rate ratio and variance for log rate ratio by stratum at a given
calendar time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nbstat1(
  time = NA_real_,
  rateRatioH0 = 1,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  kappa1 = NA_real_,
  kappa2 = NA_real_,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  nullVariance = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The calendar time for data cut.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rateRatioH0</code></td>
<td>
<p>Rate ratio under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa1</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the active treatment
group by stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa2</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the control group by
stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the active treatment group by stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the control group by stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nullVariance</code></td>
<td>
<p>Whether to calculate the variance for log rate ratio
under the null hypothesis.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The calendar time since trial start.
</p>
</li>
<li> <p><code>subjects</code>: The number of enrolled subjects.
</p>
</li>
<li> <p><code>nevents</code>: The total number of events.
</p>
</li>
<li> <p><code>nevents1</code>: The number of events in the active treatment
group.
</p>
</li>
<li> <p><code>nevents2</code>: The number of events in the control group.
</p>
</li>
<li> <p><code>ndropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>ndropouts1</code>: The number of dropouts in the active treatment
group.
</p>
</li>
<li> <p><code>ndropouts2</code>: The number of dropouts in the control group.
</p>
</li>
<li> <p><code>nfmax</code>: The total number of subjects reaching maximum
follow-up.
</p>
</li>
<li> <p><code>nfmax1</code>: The number of subjects reaching maximum follow-up
in the active treatment group.
</p>
</li>
<li> <p><code>nfmax2</code>: The number of subjects reaching maximum follow-up
in the control group.
</p>
</li>
<li> <p><code>exposure</code>: The total exposure time.
</p>
</li>
<li> <p><code>exposure1</code>: The exposure time for the active treatment group.
</p>
</li>
<li> <p><code>exposure2</code>: The exposure time for the control group.
</p>
</li>
<li> <p><code>rateRatio</code>: The rate ratio of the active treatment group
versus the control group.
</p>
</li>
<li> <p><code>vlogRate1</code>: The variance for the log rate parameter for the
active treatment group.
</p>
</li>
<li> <p><code>vlogRate2</code>: The variance for the log rate parameter for the
control group.
</p>
</li>
<li> <p><code>vlogRR</code>: The variance of log rate ratio.
</p>
</li>
</ul>
</li>
<li> <p><code>resultsUnderH0</code> when <code>nullVariance = TRUE</code>: A data frame
with the following variables:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The analysis time since trial start.
</p>
</li>
<li> <p><code>lambda1H0</code>: The restricted maximum likelihood estimate
of the event rate for the active treatment group.
</p>
</li>
<li> <p><code>lambda2H0</code>: The restricted maximum likelihood estimate
of the event rate for the control group.
</p>
</li>
<li> <p><code>rateRatioH0</code>: The rate ratio under H0.
</p>
</li>
<li> <p><code>vlogRate1H0</code>: The variance for the log rate parameter for
the active treatment group under H0.
</p>
</li>
<li> <p><code>vlogRate2H0</code>: The variance for the log rate parameter for
the control group under H0.
</p>
</li>
<li> <p><code>vlogRRH0</code>: The variance of log rate ratio under H0.
</p>
</li>
<li> <p><code>lambda1</code>: The true event rate for the active treatment group.
</p>
</li>
<li> <p><code>lambda2</code>: The true event rate for the control group.
</p>
</li>
<li> <p><code>rateRatio</code>: The true rate ratio.
</p>
</li>
</ul>
</li>
<li> <p><code>resultsUnderH0</code> when <code>nullVariance = FALSE</code>: A data frame
with the following variables:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The analysis time since trial start.
</p>
</li>
<li> <p><code>rateRatioH0</code>: The rate ratio under H0.
</p>
</li>
<li> <p><code>lambda1</code>: The true event rate for the active treatment group.
</p>
</li>
<li> <p><code>lambda2</code>: The true event rate for the control group.
</p>
</li>
<li> <p><code>rateRatio</code>: The true rate ratio.
</p>
</li>
</ul>
</li>
</ul>
<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1: Variable follow-up design

nbstat1(time = 2,
       accrualIntensity = 1956/1.25,
       kappa1 = 5,
       kappa2 = 5,
       lambda1 = 0.7*0.125,
       lambda2 = 0.125,
       gamma1 = 0,
       gamma2 = 0,
       accrualDuration = 1.25,
       followupTime = 2.75)

# Example 2: Fixed follow-up design

nbstat1(time = 1.8,
       accrualIntensity = 220/1.5,
       stratumFraction = c(0.2, 0.8),
       kappa1 = 3,
       kappa2 = 3,
       lambda1 = c(0.5*8.4, 0.7*10.2),
       lambda2 = c(8.4, 10.2),
       gamma1 = 0.05,
       gamma2 = 0.05,
       accrualDuration = 1.5,
       followupTime = 0.5,
       fixedFollowup = 1,
       nullVariance = 1)

</code></pre>


</div>