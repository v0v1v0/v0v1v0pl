<div class="container">

<table style="width: 100%;"><tr>
<td>adaptDesign</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adaptive design at an interim look</h2>

<h3>Description</h3>

<p>Obtains the conditional power for specified incremental
information given the interim results, parameter value, and
data-dependent changes in the error spending function, and the number
and spacing of interim looks. Conversely, obtains the incremental
information needed to attain a specified conditional power given
the interim results, parameter value, and data-dependent changes
in the error spending function, and the number and spacing of
interim looks.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adaptDesign(
  betaNew = NA_real_,
  INew = NA_real_,
  L = NA_integer_,
  zL = NA_real_,
  theta = NA_real_,
  IMax = NA_real_,
  kMax = NA_integer_,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  spendingTime = NA_real_,
  MullerSchafer = 0L,
  kNew = NA_integer_,
  informationRatesNew = NA_real_,
  efficacyStoppingNew = NA_integer_,
  futilityStoppingNew = NA_integer_,
  typeAlphaSpendingNew = "sfOF",
  parameterAlphaSpendingNew = NA_real_,
  typeBetaSpendingNew = "none",
  parameterBetaSpendingNew = NA_real_,
  userBetaSpendingNew = NA_real_,
  spendingTimeNew = NA_real_,
  varianceRatio = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>betaNew</code></td>
<td>
<p>The type II error for the secondary trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>INew</code></td>
<td>
<p>The maximum information of the secondary trial. Either
<code>betaNew</code> or <code>INew</code> should be provided while the other one
should be missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>The interim adaptation look of the primary trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zL</code></td>
<td>
<p>The z-test statistic at the interim adaptation look of
the primary trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The parameter value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IMax</code></td>
<td>
<p>The maximum information of the primary trial. Must be
provided if <code>futilityBounds</code> is missing and
<code>typeBetaSpending</code> is not equal to "none", or
if conditional power calculation is desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kMax</code></td>
<td>
<p>The maximum number of stages of the primary trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>informationRates</code></td>
<td>
<p>The information rates of the primary trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is
allowed at each stage of the primary trial. Defaults to true
if left unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is
allowed at each stage of the primary trial. Defaults to true
if left unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criticalValues</code></td>
<td>
<p>The upper boundaries on the z-test statistic scale
for efficacy stopping for the primary trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level of the primary trial.
Defaults to 0.025.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending for the primary
trial. One of the following:
"OF" for O'Brien-Fleming boundaries,
"P" for Pocock boundaries,
"WT" for Wang &amp; Tsiatis boundaries,
"sfOF" for O'Brien-Fleming type spending function,
"sfP" for Pocock type spending function,
"sfKD" for Kim &amp; DeMets spending function,
"sfHSD" for Hwang, Shi &amp; DeCani spending function,
"user" for user defined spending, and
"none" for no early efficacy stopping.
Defaults to "sfOF".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterAlphaSpending</code></td>
<td>
<p>The parameter value of alpha spending
for the primary trial. Corresponds to Delta for "WT", rho for "sfKD",
and gamma for "sfHSD".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending for the primary
trial. Cumulative alpha spent up to each stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>futilityBounds</code></td>
<td>
<p>The lower boundaries on the z-test statistic scale
for futility stopping for the primary trial. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typeBetaSpending</code></td>
<td>
<p>The type of beta spending for the primary trial.
One of the following:
"sfOF" for O'Brien-Fleming type spending function,
"sfP" for Pocock type spending function,
"sfKD" for Kim &amp; DeMets spending function,
"sfHSD" for Hwang, Shi &amp; DeCani spending function, and
"none" for no early futility stopping.
Defaults to "none".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterBetaSpending</code></td>
<td>
<p>The parameter value of beta spending
for the primary trial. Corresponds to rho for "sfKD",
and gamma for "sfHSD".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spendingTime</code></td>
<td>
<p>The error spending time of the primary trial.
Defaults to missing, in which case, it is the same as
<code>informationRates</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MullerSchafer</code></td>
<td>
<p>Whether to use the Muller and Schafer (2001) method
for trial adaptation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kNew</code></td>
<td>
<p>The number of looks of the secondary trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>informationRatesNew</code></td>
<td>
<p>The spacing of looks of the secondary trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efficacyStoppingNew</code></td>
<td>
<p>The indicators of whether efficacy stopping is
allowed at each look of the secondary trial. Defaults to true
if left unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>futilityStoppingNew</code></td>
<td>
<p>The indicators of whether futility stopping is
allowed at each look of the secondary trial. Defaults to true
if left unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typeAlphaSpendingNew</code></td>
<td>
<p>The type of alpha spending for the secondary
trial. One of the following:
"OF" for O'Brien-Fleming boundaries,
"P" for Pocock boundaries,
"WT" for Wang &amp; Tsiatis boundaries,
"sfOF" for O'Brien-Fleming type spending function,
"sfP" for Pocock type spending function,
"sfKD" for Kim &amp; DeMets spending function,
"sfHSD" for Hwang, Shi &amp; DeCani spending function, and
"none" for no early efficacy stopping.
Defaults to "sfOF".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterAlphaSpendingNew</code></td>
<td>
<p>The parameter value of alpha spending
for the secondary trial. Corresponds to Delta for "WT", rho for "sfKD",
and gamma for "sfHSD".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typeBetaSpendingNew</code></td>
<td>
<p>The type of beta spending for the secondary
trial. One of the following:
"sfOF" for O'Brien-Fleming type spending function,
"sfP" for Pocock type spending function,
"sfKD" for Kim &amp; DeMets spending function,
"sfHSD" for Hwang, Shi &amp; DeCani spending function,
"user" for user defined spending, and
"none" for no early futility stopping.
Defaults to "none".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterBetaSpendingNew</code></td>
<td>
<p>The parameter value of beta spending
for the secondary trial. Corresponds to rho for "sfKD",
and gamma for "sfHSD".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>userBetaSpendingNew</code></td>
<td>
<p>The user defined cumulative beta spending.
Cumulative beta spent up to each stage of the secondary trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spendingTimeNew</code></td>
<td>
<p>The error spending time of the secondary trial.
Defaults to missing, in which case, it is the same as
<code>informationRatesNew</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varianceRatio</code></td>
<td>
<p>The ratio of the variance under H0 to the
variance under H1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>adaptDesign</code> object with two list components:
</p>

<ul>
<li> <p><code>primaryTrial</code>: A list of selected information for the primary
trial, including <code>L</code>, <code>zL</code>, <code>theta</code>, <code>kMax</code>,
<code>informationRates</code>, <code>efficacyBounds</code>, <code>futilityBounds</code>,
and <code>MullerSchafer</code>.
</p>
</li>
<li> <p><code>secondaryTrial</code>: A <code>design</code> object for the secondary trial.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Lu Chi, H. M. James Hung, and Sue-Jane Wang.
Modification of sample size in group sequential clinical trials.
Biometrics 1999;55:853-857.
</p>
<p>Hans-Helge Muller and Helmut Schafer.
Adaptive group sequential designs for clinical trials:
Combining the advantages of adaptive and of
classical group sequential approaches.
Biometrics 2001;57:886-891.
</p>


<h3>See Also</h3>

<p><code>getDesign</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# original group sequential design with 90% power to detect delta = 6
delta = 6
sigma = 17
n = 282
(des1 = getDesign(IMax = n/(4*sigma^2), theta = delta, kMax = 3,
                  alpha = 0.05, typeAlphaSpending = "sfHSD",
                  parameterAlphaSpending = -4))

# interim look results
L = 1
n1 = n/3
delta1 = 4.5
sigma1 = 20
zL = delta1/sqrt(4/n1*sigma1^2)

t = des1$byStageResults$informationRates

# conditional power with sample size increase
(des2 = adaptDesign(
  betaNew = NA, INew = 420/(4*sigma1^2),
  L, zL, theta = delta1,
  IMax = n/(4*sigma1^2), kMax = 3, informationRates = t,
  alpha = 0.05, typeAlphaSpending = "sfHSD",
  parameterAlphaSpending = -4))

# Muller &amp; Schafer (2001) method to design the secondary trial:
# 3-look gamma(-2) spending with 84% power at delta = 4.5 and sigma = 20
(des2 = adaptDesign(
  betaNew = 0.16, INew = NA,
  L, zL, theta = delta1,
  IMax = n/(4*sigma1^2), kMax = 3, informationRates = t,
  alpha = 0.05, typeAlphaSpending = "sfHSD",
  parameterAlphaSpending = -4,
  MullerSchafer = TRUE,
  kNew = 3, typeAlphaSpendingNew = "sfHSD",
  parameterAlphaSpendingNew = -2))

# incremental sample size for sigma = 20
(nNew = 4*sigma1^2*des2$secondaryTrial$overallResults$information)

</code></pre>


</div>