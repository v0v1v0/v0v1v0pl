<div class="container">

<table style="width: 100%;"><tr>
<td>margins</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit of the model on the margins
</h2>

<h3>Description</h3>

<p>Checks the fit on the two- and three-way margins for <code>grm</code>, <code>ltm</code>, <code>rasch</code> and <code>tpm</code> objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
margins(object, ...)

## S3 method for class 'gpcm'
margins(object, type = c("two-way", "three-way"), rule = 3.5, ...)

## S3 method for class 'grm'
margins(object, type = c("two-way", "three-way"), rule = 3.5, ...)

## S3 method for class 'ltm'
margins(object, type = c("two-way", "three-way"), rule = 3.5, 
        nprint = 3, ...)

## S3 method for class 'rasch'
margins(object, type = c("two-way", "three-way"), rule = 3.5, 
        nprint = 3, ...)

## S3 method for class 'tpm'
margins(object, type = c("two-way", "three-way"), rule = 3.5, 
        nprint = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> an object inheriting either from class <code>gpcm</code>, class <code>grm</code>, class <code>ltm</code> or class <code>rasch</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> the type of margins to be used. See <b>Details</b> for more info. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p> the rule of thumb used in determining the indicative goodness-of-fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nprint</code></td>
<td>
<p> a numeric value determining the number of margins with the largest Chi-squared residuals 
to be printed; only for <code>ltm</code> and <code>rasch</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rather than looking at the whole set of response patterns, we can look at the two- and three-way margins. 
For the former, we construct the <code class="reqn">2 \times 2</code> contingency tables obtained by taking 
the variables two at a time. Comparing the observed and expected two-way margins is analogous to comparing 
the observed and expected correlations when judging the fit of a factor analysis model. For Bernoulli and
Ordinal variates, the comparison is made using the so called Chi-squared residuals. As a rule of thumb residuals 
greater than 3.5 are indicative of poor fit. For a more strict rule of thumb use the <code>rule</code> argument. 
The analogous procedure is followed for the three-way margins.
</p>


<h3>Value</h3>

<p>An object of either class <code>margins.ltm</code> if <code>object</code> inherits from class <code>ltm</code>, class <code>rasch</code> or class <code>tpm</code>, 
or an object of class <code>margins.grm</code> if <code>object</code> inherits from class <code>grm</code>, with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>for <code>margins.ltm</code> is an array containing the values of chi-squared residuals; 
for <code>margins.gpcm</code> and <code>margins.grm</code> is a list of length either the number of all possible pairs or all possible 
triplets of items, containing the observed and expected frequencies, the values of chi-squared 
residuals, the value of the total residual and the value of the rule of thumb times the product of
the number of categories of the items under consideration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of margins that were calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nprint</code></td>
<td>
<p>the value of the <code>nprint</code> argument; returned only from <code>margins.ltm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combs</code></td>
<td>
<p>all possible two- or three-way combinations of the items; returned only from <code>margins.ltm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>the value of the <code>rule</code> argument; returned only from <code>margins.ltm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitems</code></td>
<td>
<p>the number of items in <code>object</code>; returned only from <code>margins.grm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>the names of items in <code>object</code>; returned only from <code>margins.grm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a copy of the matched call of <code>object</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dimitris Rizopoulos <a href="mailto:d.rizopoulos@erasmusmc.nl">d.rizopoulos@erasmusmc.nl</a>
</p>


<h3>References</h3>

<p>Bartholomew, D. (1998) Scaling unobservable constructs in social science. 
<em>Applied Statistics</em>, <b>47</b>, 1–13.
</p>
<p>Bartholomew, D. and Knott, M. (1999) <em>Latent Variable Models
and Factor Analysis</em>, 2nd ed. London: Arnold.
</p>
<p>Bartholomew, D., Steel, F., Moustaki, I. and Galbraith, J. (2002)
<em>The Analysis and Interpretation of Multivariate Data for
Social Scientists</em>. London: Chapman and Hall.
</p>
<p>Rizopoulos, D. (2006) <b>ltm</b>: An R package for latent variable modelling and item response theory analyses. 
<em>Journal of Statistical Software</em>, <b>17(5)</b>, 1–25. URL doi: <a href="https://doi.org/10.18637/jss.v017.i05">10.18637/jss.v017.i05</a>
</p>


<h3>See Also</h3>

<p><code>person.fit</code>,
<code>item.fit</code>,
<code>GoF.rasch</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Two- and Three-way residuals for the Rasch model
fit &lt;- rasch(LSAT)
margins(fit)
margins(fit, "three")


## Two- and Three-way residuals for the one-factor model
fit &lt;- ltm(WIRS ~ z1)
margins(fit)
margins(fit, "three")


## Two- and Three-way residuals for the graded response model
fit &lt;- grm(Science[c(1,3,4,7)])
margins(fit)
margins(fit, "three")

</code></pre>


</div>