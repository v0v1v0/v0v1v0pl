<div class="container">

<table style="width: 100%;"><tr>
<td>lsirm2pl_ss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>2PL LSIRM with model selection approach.</h2>

<h3>Description</h3>

<p>lsirm2pl_ss is used to fit 2PL LSIRM with model selection approach based on spike-and-slab priors.
lsirm2pl_ss factorizes item response matrix into column-wise item effect, row-wise respondent effect and further embeds interaction effect in a latent space. Unlike 1PL model, 2PL model assumes the item effect can vary according to respondent, allowing additional parameter multiplied with respondent effect. The resulting latent space provides an interaction map that represents interactions between respondents and items.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lsirm2pl_ss(
  data,
  ndim = 2,
  niter = 15000,
  nburn = 2500,
  nthin = 5,
  nprint = 500,
  jump_beta = 0.4,
  jump_theta = 1,
  jump_alpha = 1,
  jump_gamma = 1,
  jump_z = 0.5,
  jump_w = 0.5,
  pr_mean_beta = 0,
  pr_sd_beta = 1,
  pr_mean_theta = 0,
  pr_spike_mean = -3,
  pr_spike_sd = 1,
  pr_slab_mean = 0.5,
  pr_slab_sd = 1,
  pr_mean_alpha = 0.5,
  pr_sd_alpha = 1,
  pr_a_theta = 0.001,
  pr_b_theta = 0.001,
  pr_xi_a = 1,
  pr_xi_b = 1,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Matrix; a binary or continuous item response matrix for analysis. Each row represents a respondent, and each column contains responses to the corresponding item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndim</code></td>
<td>
<p>Integer; the dimension of the latent space. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Integer; the total number of MCMC iterations to run. Default is 15000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>Integer; the number of initial MCMC iterations to discard as burn-in. Default is 2500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthin</code></td>
<td>
<p>Integer; the number of MCMC iterations to thin. Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nprint</code></td>
<td>
<p>Integer; the interval at which MCMC samples are displayed during execution. Default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_beta</code></td>
<td>
<p>Numeric; the jumping rule for the beta proposal density. Default is 0.4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_theta</code></td>
<td>
<p>Numeric; the jumping rule for the theta proposal density. Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_alpha</code></td>
<td>
<p>Numeric; the jumping rule for the alpha proposal density. Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_gamma</code></td>
<td>
<p>Numeric; the jumping rule for the theta proposal density. Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_z</code></td>
<td>
<p>Numeric; the jumping rule for the z proposal density. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump_w</code></td>
<td>
<p>Numeric; the jumping rule for the w proposal density. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_mean_beta</code></td>
<td>
<p>Numeric; the mean of the normal prior for beta. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_sd_beta</code></td>
<td>
<p>Numeric; the standard deviation of the normal prior for beta. Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_mean_theta</code></td>
<td>
<p>Numeric; the mean of the normal prior for theta. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_spike_mean</code></td>
<td>
<p>Numeric; the mean of spike prior for log gamma. Default is -3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_spike_sd</code></td>
<td>
<p>Numeric; the standard deviation of spike prior for log gamma. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_slab_mean</code></td>
<td>
<p>Numeric; the mean of spike prior for log gamma. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_slab_sd</code></td>
<td>
<p>Numeric; the standard deviation of spike prior for log gamma. Default is is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_mean_alpha</code></td>
<td>
<p>Numeric; the mean of the log normal prior for alpha. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_sd_alpha</code></td>
<td>
<p>Numeric; the standard deviation of the log normal prior for alpha. Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_a_theta</code></td>
<td>
<p>Numeric; the shape parameter of the inverse gamma prior for the variance of theta. Default is 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_b_theta</code></td>
<td>
<p>Numeric; the scale parameter of the inverse gamma prior for the variance of theta. Default is 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_xi_a</code></td>
<td>
<p>Numeric; the first shape parameter of beta prior for latent variable xi. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_xi_b</code></td>
<td>
<p>Numeric; the second shape parameter of beta prior for latent variable xi. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical; If TRUE, MCMC samples are printed for each <code>nprint</code>. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lsirm2pl_ss</code> models the probability of correct response by respondent <code class="reqn">j</code> to item <code class="reqn">i</code> with item effect <code class="reqn">\beta_i</code>, respondent effect <code class="reqn">\theta_j</code> and the distance between latent position <code class="reqn">w_i</code> of item <code class="reqn">i</code> and latent position <code class="reqn">z_j</code> of respondent <code class="reqn">j</code> in the shared metric space, with <code class="reqn">\gamma</code> represents the weight of the distance term. For 2pl model, the the item effect is assumed to have additional discrimination parameter <code class="reqn">\alpha_i</code> multiplied by <code class="reqn">\theta_j</code>: </p>
<p style="text-align: center;"><code class="reqn">logit(P(Y_{j,i} = 1|\theta_j,\alpha_i,\beta_i,z_j,w_i))=\theta_j*\alpha_i+\beta_i-\gamma||z_j-w_i||</code>
</p>
 <p><code>lsirm2pl_ss</code> model include model selection approach based on spike-and-slab priors for log gamma. For detail of spike-and-slab priors, see References.
</p>


<h3>Value</h3>

<p><code>lsirm2pl_ss</code> returns an object of  list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame or matrix containing the variables used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>A numeric value representing the Bayesian Information Criterion (BIC).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc_inf</code></td>
<td>
<p>Details about the number of MCMC iterations, burn-in periods, and thinning intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_inf</code></td>
<td>
<p>The log maximum a posteriori (MAP) value and the iteration number at which this MAP value occurs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_estimate</code></td>
<td>
<p>Posterior estimates of the beta parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_estimate</code></td>
<td>
<p>Posterior estimates of the theta parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_theta_estimate</code></td>
<td>
<p>Posterior estimates of the standard deviation of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_estimate</code></td>
<td>
<p>Posterior estimates of gamma parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_estimate</code></td>
<td>
<p>Posterior estimates of the z parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_estimate</code></td>
<td>
<p>Posterior estimates of the w parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Posterior samples of the beta parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Posterior samples of the theta parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_sd</code></td>
<td>
<p>Posterior samples of the standard deviation of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Posterior samples of the gamma parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Posterior samples of the z parameter, represented as a 3-dimensional matrix where the last axis denotes the dimension of the latent space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Posterior samples of the w parameter, represented as a 3-dimensional matrix where the last axis denotes the dimension of the latent space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_beta</code></td>
<td>
<p>Acceptance ratio for the beta parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_theta</code></td>
<td>
<p>Acceptance ratio for the theta parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_z</code></td>
<td>
<p>Acceptance ratio for the z parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_w</code></td>
<td>
<p>Acceptance ratio for the w parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_gamma</code></td>
<td>
<p>Acceptance ratio for the gamma parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_estimate</code></td>
<td>
<p>Posterior estimation of phi. inclusion probability of gamma. if estimation of phi is less than 0.5, choose Rasch model with gamma = 0, otherwise latent space model with gamma &gt; 0. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>Posterior samples of phi which is indicator of spike and slab prior. If phi is 1, log gamma follows the slab prior, otherwise follows the spike prior. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_estimate</code></td>
<td>
<p>Posterior estimates of the alpha parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Posterior estimates of the alpha parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_alpha</code></td>
<td>
<p>Acceptance ratio for the alpha parameter.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ishwaran, H., &amp; Rao, J. S. (2005). Spike and slab variable selection: Frequentist and Bayesian strategies. The Annals of Statistics, 33(2), 730-773.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# generate example item response matrix
data     &lt;- matrix(rbinom(500, size = 1, prob = 0.5),ncol=10,nrow=50)

lsirm_result &lt;- lsirm2pl_ss(data)

# The code following can achieve the same result.
lsirm_result &lt;- lsirm(data ~ lsirm2pl(spikenslab = TRUE, fixed_gamma = FALSE))

</code></pre>


</div>