<div class="container">

<table style="width: 100%;"><tr>
<td>est_lm_cov_manifest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate LM model with covariates in the measurement model</h2>

<h3>Description</h3>

<p>Main function for estimating LM model with covariates in the measurement model based on a global logit parameterization.  <br><br><b>The function is no longer maintained. Please look at</b> <code>lmest</code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class="language-R">est_lm_cov_manifest(S, X, yv = rep(1,nrow(S)), k, q = NULL, mod = c("LM", "FM"),
                    tol = 10^-8, maxit = 1000, start = 0, mu = NULL, al = NULL,
                    be = NULL, si = NULL, rho = NULL, la = NULL, PI = NULL,
                    output = FALSE, out_se = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>array of available configurations (n x TT) with categories starting from 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>array (n x TT x nc) of covariates with eventually includes lagged response (nc = number of covariates)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of latent states</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>number of support points for the AR(1) process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>model ("LM" = Latent Markov with stationary transition, "FM" = finite mixture)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for the convergence (optional) and tolerance of conditional probability if tol&gt;1 then return</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>starting value for mu (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>al</code></td>
<td>
<p>starting value for al (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>be</code></td>
<td>
<p>starting value for be (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>si</code></td>
<td>
<p>starting value for si when mod="FM" (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>starting value for rho when mod="FM" (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>la</code></td>
<td>
<p>starting value for la (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PI</code></td>
<td>
<p>starting value for PI (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>to return additional output (PRED0, PRED1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_se</code></td>
<td>
<p>TRUE for computing information matrix and standard errors</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu </code></td>
<td>
<p>vector of cutpoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>al </code></td>
<td>
<p>support points for the latent states</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>be </code></td>
<td>
<p>estimate of the vector of regression parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>si </code></td>
<td>
<p>sigma of the AR(1) process (mod = "FM")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho </code></td>
<td>
<p>parameter vector for AR(1) process (mod = "FM")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>la </code></td>
<td>
<p>vector of initial probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PI </code></td>
<td>
<p>transition matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lk </code></td>
<td>
<p>maximum log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np </code></td>
<td>
<p>number of parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic </code></td>
<td>
<p>value of AIC index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic </code></td>
<td>
<p>value of BIC index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRED0 </code></td>
<td>
<p>prediction of latent state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRED1 </code></td>
<td>
<p>prediction of the overall latent effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sebe </code></td>
<td>
<p>standard errors for the regression parameters be</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selrho </code></td>
<td>
<p>standard errors for logit type transformation of rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J1 </code></td>
<td>
<p>information matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.
</p>
<p>Bartolucci, F., Bacci, S. and Pennoni, F. (2014) Longitudinal analysis of the 	self-reported health status by mixture latent autoregressive models, <em>Journal of the Royal Statistical Society - series C</em>, <b>63</b>, pp. 267-288</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# Example based on self-rated health status (SRHS) data

# load SRHS data
data(data_SRHS_long)
dataSRHS &lt;- data_SRHS_long
head(dataSRHS)

res &lt;- long2matrices(dataSRHS$id, X = cbind(dataSRHS$gender-1,
 dataSRHS$race == 2 | dataSRHS$race == 3, dataSRHS$education == 4,
dataSRHS$education == 5, dataSRHS$age-50, (dataSRHS$age-50)^2/100),
Y = dataSRHS$srhs)

X &lt;- res$XX
S &lt;- 5-res$YY

# *** fit stationary LM model
res0 &lt;- vector("list", 10)
tol &lt;- 10^-6;
for(k in 1:10){
  res0[[k]] &lt;- est_lm_cov_manifest(S, X, k, 1, mod = "LM", tol)
   save.image("example_SRHS.RData")
}

# *** fit the mixture latent auto-regressive model
tol &lt;- 0.005
res &lt;- vector("list",4)
k &lt;- 1
q &lt;- 51
res[[k]] &lt;- est_lm_cov_manifest(S, X, k, q, mod = "FM", tol, output = TRUE)
for(k in 2:4) res[[k]] &lt;- est_lm_cov_manifest(S, X, k, q = 61, mod = "FM", tol, output = TRUE)

## End(Not run)
</code></pre>


</div>