<div class="container">

<table style="width: 100%;"><tr>
<td>lmomtri</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>L-moments of the Asymmetric Triangular Distribution</h2>

<h3>Description</h3>

<p>This function estimates the L-moments of the Asymmetric Triangular distribution given the parameters (<code class="reqn">\nu</code>, <code class="reqn">\omega</code>, and <code class="reqn">\psi</code>) from <code>partri</code>. The first three L-moments in terms of the parameters are
</p>
<p style="text-align: center;"><code class="reqn">\lambda_1 = \frac{(\nu+\omega+\psi)}{3}\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_2 = \frac{1}{15}\biggl[\frac{(\nu-\omega)^2}{(\psi-\nu)^{\phantom{1}}} - (\nu+\omega) + 2\psi\biggr] \mbox{, and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_3 = G + H_1 + H_2 + J \mbox{,}</code>
</p>

<p>where <code class="reqn">G</code> is dependent on the integral definining the L-moments in terms of the quantile function (Asquith, 2011, p. 92) with limits of integration of <code class="reqn">[0,P]</code>, <code class="reqn">H_1</code> and <code class="reqn">H_2</code> are dependent on the integral defining the L-moment in terms of the quantile function with limits of integration of <code class="reqn">[P,1]</code>, and <code class="reqn">J</code> is dependent on the <code class="reqn">\lambda_2</code> and <code class="reqn">\lambda_1</code>. Finally, the variables <code class="reqn">G</code>, <code class="reqn">H_1</code>, <code class="reqn">H_2</code>, and <code class="reqn">J</code> are
</p>
<p style="text-align: center;"><code class="reqn">G = \frac{2}{7}\frac{(\nu+6\omega)(\omega-\nu)^3}{(\psi-\nu)^3}\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">H_1 = \frac{12}{7}\frac{(\omega-\psi)^4}{(\nu-\psi)^3} - 2\psi\frac{(\nu-\omega)^3}{(\nu-\psi)^3} + 2\psi\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">H_2 = \frac{4}{5}\frac{(5\nu-6\omega+\psi)(\omega-\psi)^2}{(\nu-\psi)^2}\mbox{, and}</code>
</p>

<p style="text-align: center;"><code class="reqn">J = -\frac{1}{15}\biggl[\frac{3(\nu-\omega)^2}{(\psi-\nu)} + 7(\nu+\omega) + 16\psi\biggl]\mbox{.}</code>
</p>

<p>The higher L-moments are even more ponderous and simpler expressions for the L-moment ratios appear elusive. Bounds for <code class="reqn">\tau_3</code> and <code class="reqn">\tau_4</code> are <code class="reqn">|\tau_3| \le 0.14285710</code> and <code class="reqn">0.04757138 &lt; \tau_4 &lt; 0.09013605</code>. An approximation for <code class="reqn">\tau_4</code> is
</p>
<p style="text-align: center;"><code class="reqn">\tau_4 = 0.09012180 - 1.777361\tau_3^2 - 17.89864\tau_3^4 + 920.4924\tau_3^6 - 37793.50\tau_3^8 \mbox{,}</code>
</p>

<p>where the residual standard error is <code class="reqn">{&lt;}1.750\times 10^{-5}</code> and the absolute value of the maximum residual is <code class="reqn">&lt;9.338\times 10^{-5}</code>. The L-moments of the Symmetrical Triangular distribution for <code class="reqn">\tau_3 = 0</code> are considered by Nagaraja (2013) and therein for a symmetric triangular distribution having <code class="reqn">\lambda_1 = 0.5</code> then <code class="reqn">\lambda_4 = 0.0105</code> and <code class="reqn">\tau_4 = 0.09</code>. These L-kurtosis values agree with results of this function that are based on the <code>theoLmoms.max.ostat</code> function. The 4th and 5th L-moments <code class="reqn">\lambda_4</code> and <code class="reqn">\lambda_5</code>, respectively, are computed using expectations of order statistic maxima (<code>expect.max.ostat</code>) and are defined (Asquith, 2011, p. 95) as
</p>
<p style="text-align: center;"><code class="reqn">\lambda_4 = 5\mathrm{E}[X_{4:4}] - 10\mathrm{E}[X_{3:3}] +  6\mathrm{E}[X_{2:2}] - \mathrm{E}[X_{1:1}]</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\lambda_5 = 14\mathrm{E}[X_{5:5}] - 35\mathrm{E}[X_{4:4}] + 30\mathrm{E}[X_{3:3}] - 10\mathrm{E}[X_{2:2}] + \mathrm{E}[X_{1:1}]\mbox{.}</code>
</p>

<p>These expressions are solved using the <code>expect.max.ostat</code> function to compute the <code class="reqn">\mathrm{E}[X_{r:r}]</code>.
</p>
<p>For the symmetrical case of <code class="reqn">\omega = (\psi + \nu)/2</code>, then 
</p>
<p style="text-align: center;"><code class="reqn">\lambda_1 = \frac{(\nu+\psi)}{2}\mbox{\ and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_2 = \frac{7}{60}\biggl[\psi - \nu\biggr]\mbox{,}</code>
</p>

<p>which might be useful for initial parameter estimation through
</p>
<p style="text-align: center;"><code class="reqn">\psi = \lambda_1 + \frac{30}{7}\lambda_2 \mbox{\ and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\nu  = \lambda_1 - \frac{30}{7}\lambda_2 \mbox{.}</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">lmomtri(para, paracheck=TRUE, nmom=c("3", "5"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>The parameters of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paracheck</code></td>
<td>
<p>A logical controlling whether the parameters and checked for validity. Overriding of this check might help in numerical optimization of parameters for modes near either the minimum or maximum. The argument here makes code base within <code>partri</code> a little shorter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmom</code></td>
<td>
<p>The L-moments greater the <code class="reqn">r &gt; 3</code> require numerical integration using the expectations of the maxima order statistics of the fitted distribution. If this argument is set to <code>"3"</code> then executation of <code>lmomtri</code> is stopped at <code class="reqn">r = 3</code> and the first three L-moments returned, otherwise the 4th and 5th L-moments are computed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lambdas</code></td>
<td>
<p>Vector of the L-moments. First element is
<code class="reqn">\lambda_1</code>, second element is <code class="reqn">\lambda_2</code>, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratios</code></td>
<td>
<p>Vector of the L-moment ratios. Second element is
<code class="reqn">\tau</code>, third element is <code class="reqn">\tau_3</code> and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Level of symmetrical trimming used in the computation, which is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leftrim</code></td>
<td>
<p>Level of left-tail trimming used in the computation, which is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rightrim</code></td>
<td>
<p>Level of right-tail trimming used in the computation, which is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E33err</code></td>
<td>
<p>A percent error between the expectation of the <code class="reqn">X_{3:3}</code> order statistic by analytical expression versus a theoretical by numerical integration using the <br><code>expect.max.ostat</code> function. This will be <code>NA</code> if <code>nmom == "3"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>An attribute identifying the computational
source of the L-moments: “lmomtri”.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The expression for <code class="reqn">\tau_4</code> in terms of <code class="reqn">\tau_3</code> is
</p>
<pre>
  "tau4tri" &lt;- function(t3) {
     t3[t3 &lt; -0.14285710 | t3 &gt;  0.14285710] &lt;- NA
     b &lt;- 0.09012180
     a &lt;- c(0, -1.777361, 0, -17.89864, 0,  920.4924, 0, -37793.50)
     t4 &lt;- b + a[2]*t3^2 + a[4]*t3^4 + a[6]*t3^6 + a[8]*t3^8
     return(t4)
  }
</pre>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Asquith, W.H., 2011, Distributional analysis with L-moment statistics using the R environment for statistical computing: Createspace Independent Publishing Platform, ISBN 978–146350841–8.
</p>
<p>Nagaraja, H.N., 2013, Moments of order statistics and L-moments for the symmetric triangular distribution: Statistics and Probability Letters, v. 83, no. 10, pp. 2357–2363.
</p>


<h3>See Also</h3>

<p><code>partri</code>, <code>cdftri</code>, <code>pdftri</code>, <code>quatri</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">lmr &lt;- lmoms(c(46, 70, 59, 36, 71, 48, 46, 63, 35, 52))
lmr
lmomtri(partri(lmr), nmom="5")

par &lt;- vec2par(c(-405, -390, -102), type="tri")
lmomtri(par, nmom="5")$lambdas
# -299           39.4495050    5.5670228    1.9317914    0.8007511
theoLmoms.max.ostat(para=par, qua=quatri, nmom=5)$lambdas
# -299.0000126   39.4494885    5.5670486    1.9318732    0.8002989
# The -299 is the correct by exact solution as are 39.4495050 and 5.5670228, the 4th and
# 5th L-moments diverge from theoLmoms.max.ostat() because the exact solutions and not
# numerical integration of the quantile function was used for E11, E22, and E33.
# So although E44 and E55 come from expect.max.ostat() within both lmomtri() and
# theoLmoms.max.ostat(), the Lambda4 and Lambda5 are not the same because the E11, E22,
# and E33 values are different.

## Not run: 
# At extreme limit of Tau3 for the triangular distribution, L-moment ratio diagram
# shows convergence to the trajectory of the Generalized Pareto distribution.
"tau4tri" &lt;- function(t3) { t3[t3 &lt; -0.14285710 | t3 &gt;  0.14285710] &lt;- NA
   b &lt;- 0.09012180; a &lt;- c(0, -1.777361, 0, -17.89864, 0,  920.4924, 0, -37793.50)
   t4 &lt;- b + a[2]*t3^2 + a[4]*t3^4 + a[6]*t3^6 + a[8]*t3^8; return(t4)
}
F &lt;- seq(0,1, by=0.001)
lmr  &lt;- vec2lmom(c(10,9,0.142857, tau4tri(0.142857)))
parA &lt;- partri(lmr); parB &lt;- pargpa(lmr)
xA &lt;- qlmomco(F,  parA); xB &lt;- qlmomco(F, parB); x &lt;- sort(unique(c(xA,xB)))
plot(x,  pdftri(x,parA), type="l", col=8, lwd=4) # Compare Asym. Tri. to 
lines(x, pdfgpa(x,parB),           col=2)        # Gen. Pareto

## End(Not run)
</code></pre>


</div>