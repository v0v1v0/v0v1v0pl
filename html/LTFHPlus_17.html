<div class="container">

<table style="width: 100%;"><tr>
<td>get_kinship</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct kinship matrix from graph</h2>

<h3>Description</h3>

<p>construct the kinship matrix from a graph representation of a family, centered on an index person (proband).
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_kinship(fam_graph, h2, index_id = NA, add_ind = TRUE, fix_diag = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fam_graph</code></td>
<td>
<p>graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2</code></td>
<td>
<p>heritability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_id</code></td>
<td>
<p>proband id. Only used in conjuction with add_ind = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_ind</code></td>
<td>
<p>add genetic liability to the kinship matrix. Defaults to true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_diag</code></td>
<td>
<p>Whether to set diagonal to 1 for all entries except for the
genetic liability.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A kinship matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">fam &lt;- data.frame(
i = c(1, 2, 3, 4),
f = c(3, 0, 4, 0),
m = c(2, 0, 0, 0)
)

thresholds &lt;- data.frame(
  i = c(1, 2, 3, 4),
  lower = c(-Inf, -Inf, 0.8, 0.7),
  upper = c(0.8, 0.8, 0.8, 0.7)
)

graph &lt;- prepare_graph(fam, icol = "i", fcol = "f", mcol = "m", thresholds = thresholds)

get_kinship(graph, h2 = 0.5, index_id = "1")

</code></pre>


</div>