<div class="container">

<table style="width: 100%;"><tr>
<td>pitfill_stonge2008</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pits and spikes filling</h2>

<h3>Description</h3>

<p>Pits and spikes filling for raster. Typically used for post-processing CHM. This algorithm
is from St-Onge 2008 (see reference).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pitfill_stonge2008(
  x,
  lap_size = 3L,
  thr_lap = 0.1,
  thr_spk = -0.1,
  med_size = 3L,
  dil_radius = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>raster. SpatRaster, RasterLayer, stars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lap_size</code></td>
<td>
<p>integer. Size of the Laplacian filter kernel (integer value, in pixels).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr_lap</code></td>
<td>
<p>numeric. Threshold Laplacian value for detecting a cavity (all values above this
value will be considered a cavity). A positive value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr_spk</code></td>
<td>
<p>numeric. Threshold Laplacian value for detecting a spike (all values below this
value will be considered a spike). A negative value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>med_size</code></td>
<td>
<p>integer. Size of the median filter kernel (integer value, in pixels).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dil_radius</code></td>
<td>
<p>integer. Dilation radius (integer value, in pixels).</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>St-Onge, B., 2008. Methods for improving the quality of a true orthomosaic of Vexcel UltraCam
images created using alidar digital surface model, Proceedings of the Silvilaser 2008, Edinburgh,
555-562. https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=81365288221f3ac34b51a82e2cfed8d58defb10e
</p>


<h3>Examples</h3>

<pre><code class="language-R">LASfile &lt;- system.file("extdata", "MixedConifer.laz", package="lidR")
las &lt;- readLAS(LASfile)
chm &lt;- rasterize_canopy(las, 0.5, dsmtin())
sto &lt;- pitfill_stonge2008(chm)

#terra::plot(c(chm, sto), col = lidR::height.colors(25))
</code></pre>


</div>