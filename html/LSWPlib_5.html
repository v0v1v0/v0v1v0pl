<div class="container">

<table style="width: 100%;"><tr>
<td>LSWPbasis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate an LSWP basis by penalised least squares</h2>

<h3>Description</h3>

<p><code>LSWPbasis</code> returns a matrix containing the wavelet packet basis indices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LSWPbasis(x, wavelet, lev.max, smooth, spa, penalty = 0.976)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a (locally stationary) time series of dyadic length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wavelet</code></td>
<td>
<p>the wavelet used to estimate the wavelet packet spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lev.max</code></td>
<td>
<p>the maximum scale for which the basis is fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>should the penasised least squares cost functionals be smoothed? Default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spa</code></td>
<td>
<p>parameter for the local polynomial smothing implemented through <code>lowess</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>implemets increasing penalty for increasing scales.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a wavelet packet basis to data using a penalised least square method.
</p>
<p>This function implements a data-driven basis selection of locally stationary time series.
The wavelet argument is specified as in other functions of this package.
Therefore, the current implementation allows for three discrete wavelets: Haar (<code>"haar"</code>),
Daubechies Extremal Phase linear filters of length 4 (<code>"d4"</code>) and Least Asymmetric linear filters of length 8 (<code>"la8"</code>).
Smoothing is controlled through the argument spa.
</p>


<h3>Value</h3>

<p>A matrix of dimensions |b| x 2, where |b| is the number of packets in the basis.
The first column contains the scale indices of each packet in the basis, the second column contains the packet index within each scale.
</p>


<h3>Author(s)</h3>

<p>Alessandro Cardinali
</p>


<h3>References</h3>

<p>A. Cardinali and G.P. Nason (2017). Locally Stationary Wavelet Packet Processes:
Basis Selection and Model Fitting. Journal of Time Series Analysis, 38:2, 151-174.
</p>


<h3>See Also</h3>

<p><code>LSWPspec</code>, <code>LSWPsim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
wpb &lt;- LSWPbasis(x = sp500, wavelet = 'la8', lev.max = 4, smooth = TRUE, spa = 0.35)

</code></pre>


</div>