<div class="container">

<table style="width: 100%;"><tr>
<td>photon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Photons</h2>

<h3>Description</h3>

<p>Various functionality to deal with the 4-momentum of a photon</p>


<h3>Usage</h3>

<pre><code class="language-R">is.consistent.nullvec(N,TOL=1e-10)
as.photon(x,E=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Four-momentum to be tested for nullness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TOL</code></td>
<td>
<p>tolerance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of three-velocities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Energy, a scalar</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Returns the four-momentum of a photon.
</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>See Also</h3>

<p><code>4mom</code>,<code>reflect</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## A bunch of photons all approximately parallel to the x-axis:
as.photon(as.3vel(cbind(0.9,runif(10)/1000,runif(10)/1000)))


## mirror ball:
jj &lt;- matrix(rnorm(30),10,3)
disco &lt;- sweep(matrix(rnorm(30),10,3),1,sqrt(rowSums(jj^2)),`/`)
p &lt;- as.photon(c(1,0,0))
reflect(p,disco)

table(reflect(p,disco)[,2]&gt;0) # should be TRUE with probability sqrt(0.5)

## relativistic  disco; mirror ball moves at 0.5c:

B &lt;- boost(as.3vel(c(0.5,0,0)))
p |&gt; tcrossprod(B) |&gt; reflect(disco) |&gt; tcrossprod(solve(B))


</code></pre>


</div>