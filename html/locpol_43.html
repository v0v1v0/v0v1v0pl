<div class="container">

<table style="width: 100%;"><tr>
<td>locpol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Local Polynomial estimation. </h2>

<h3>Description</h3>

<p>Formula interface for the local polynomial estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">    locpol(formula,data,weig=rep(1,nrow(data)),bw=NULL,kernel=EpaK,deg=1,
            xeval=NULL,xevalLen=100)
    confInterval(x)
    ## S3 method for class 'locpol'
residuals(object,...)
    ## S3 method for class 'locpol'
fitted(object,deg=0,...)
    ## S3 method for class 'locpol'
summary(object,...)
    ## S3 method for class 'locpol'
print(x,...)
    ## S3 method for class 'locpol'
plot(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> formula as in <code>lm</code>, only first covariate is used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> data frame with data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weig</code></td>
<td>
<p> Vector of weights for each observations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p> Smoothing parameter, bandwidth. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p> Kernel used to perform the estimation, see
<code>Kernels</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deg</code></td>
<td>
<p> Local polynomial estimation degree (<code class="reqn">p</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xeval</code></td>
<td>
<p> Vector of evaluation points. By default <code>xevalLen</code> points between the min. and the max. of the regressors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xevalLen</code></td>
<td>
<p> Length of <code>xeval</code> if it is <code>NULL</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A <code>locpol</code> object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> A <code>locpol</code> object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Any other required argument. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an interface to the local polynomial estimation function
that provides basic <code>lm</code> functionality. <code>summary</code> and
<code>print</code> methods shows very basic information about the fit,
<code>fitted</code> return the estimation of the derivatives if <code>deg</code>
is larger than 0, and <code>plot</code> provides a plot of data, local
polynomial estimation and the variance estimation.
</p>
<p>Variance estimation is carried out by means of the local constant
regression estimation of the squared residuals.
</p>
<p><code>confInterval</code> provides confidence intervals for all points
in <code>x$lpFit$[,x$X]</code>, say those in <code>xeval</code>.
</p>


<h3>Value</h3>

<p>A list containing among other components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mf</code></td>
<td>
<p> Model frame for <code>data</code> and <code>formula</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> data frame with data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weig</code></td>
<td>
<p> Vector of weight for each observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xeval</code></td>
<td>
<p> Vector of evaluation points. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p> Smoothing parameter, bandwidth. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p> Kernel used, see <code>Kernels</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KName</code></td>
<td>
<p> Kernel name, a string with the name of kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deg</code></td>
<td>
<p> Local polynomial estimation degree (<code class="reqn">p</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X,Y</code></td>
<td>
<p> Names in <code>data</code> of the response and covariate. They are also used in <code>lpFit</code> to name the fitted data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p> Residuals of the local polynomial fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpFit</code></td>
<td>
<p> Data frame with the local polynomial fit. It contains covariate, response, derivatives estimation, <code class="reqn">X</code> density estimation, and variance estimation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Jorge Luis Ojeda Cabrera.
</p>


<h3>References</h3>

<p>Fan, J. and Gijbels, I.
<em> Local polynomial modelling and its applications\/</em>.
Chapman &amp; Hall, London (1996).
</p>
<p>Wand, M.~P. and Jones, M.~C.
<em> Kernel smoothing\/</em>.
Chapman and Hall Ltd., London (1995).
</p>
<p>Crist'obal, J. A. and Alcal\'a, J. T. (2000).
<em> Nonparametric regression estimators for length biased data\/</em>.
J. Statist. Plann. Inference, 89, pp. 145-168.
</p>
<p>Ahmad, Ibrahim A. (1995)
<em>On multivariate kernel estimation for samples from weighted
distributions\/</em>.
Statistics &amp; Probability Letters, 22, num. 2, pp. 121-129
</p>


<h3>See Also</h3>

 <p><code>locpoly</code> from package <span class="pkg">KernSmooth</span>,
<code>ksmooth</code> and <code>loess</code> in <span class="pkg">stats</span> (but from earlier package <code>modreg</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">    N &lt;- 250
    xeval &lt;- 0:100/100
    ##  ex1
    d &lt;- data.frame(x = runif(N))
    d$y &lt;- d$x^2 - d$x + 1 + rnorm(N, sd = 0.1)
    r &lt;- locpol(y~x,d)
    plot(r)
    ##  ex2
    d &lt;- data.frame(x = runif(N))
    d$y &lt;- d$x^2 - d$x + 1 + (1+d$x)*rnorm(N, sd = 0.1)
    r &lt;- locpol(y~x,d)
    plot(r)
    ## notice:
    rr &lt;- locpol(y~x,d,xeval=runif(50,-1,1))
    ## notice x has null dens. outside (0,1)
    ## plot(rr) raises an error, no conf. bands outside (0,1).
    ## length biased data !!
    d &lt;- data.frame(x = runif(10*N))
    d$y &lt;- d$x^2 - d$x + 1 + (rexp(10*N,rate=4)-.25)
    posy &lt;- d$y[ whichYPos &lt;- which(d$y&gt;0) ];
    d &lt;- d[sample(whichYPos, N,prob=posy,replace=FALSE),]
    rBiased &lt;- locpol(y~x,d)
    r &lt;- locpol(y~x,d,weig=1/d$y)
    plot(d)
    points(r$lpFit[,r$X],r$lpFit[,r$Y],type="l",col="blue")
    points(rBiased$lpFit[,rBiased$X],rBiased$lpFit[,rBiased$Y],type="l")
    curve(x^2 - x + 1,add=TRUE,col="red")

</code></pre>


</div>